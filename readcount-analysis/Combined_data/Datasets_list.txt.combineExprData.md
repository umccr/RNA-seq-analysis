---
title: "Combining expression data from different datasets"
author: "UMCCR"
date: "21 August, 2018"
params:
  projectDir:
  datasetsFile:
output:
  html_document:
    keep_md: yes
    code_folding: hide
#    toc: true
#    toc_float: true
---

Script to combine gene-by-sample expression matrices from different datasets. It requires manually prepared dataset [file](./Combined_data/Datasets_list.txt) with four columns: 

	1. *Dataset_name* - user defined names of datasets
	2. *Expression_matrix* - corresponding expression/count matrices
	3. *Target_file* -  defining the sample names for merged expression matrix 
	4. *Outliers_file* - listing outlier samples to be removed before combining the data. 

Note, only genes intersection across all datasets expression matrices will be reported in the combined expression matrix. The pipeline is based on recommendaitons from *[RNAseq123](https://master.bioconductor.org/packages/release/workflows/vignettes/RNAseq123/inst/doc/limmaWorkflow.html)* package.


### Define functions


```r
##### Create 'not in' operator
"%!in%" <- function(x,table) match(x,table, nomatch = 0) == 0

##### Prepare object to write into a file
prepare2write <- function (x) {
  
  x2write <- cbind(rownames(x), x)
  colnames(x2write) <- c("Gene",colnames(x))
  return(x2write)
}

##### Prepare gene data matrix to write into a file
geneMatrix2write <- function (x) {
  
  x2write <- cbind(rownames(x), x)
  colnames(x2write) <- c("Gene",colnames(x))
  return(x2write)
}

##### Assign colours to different groups
getTargetsColours <- function(targets) {
  
##### Predefined selection of colours for groups
targets.colours <- c("red","blue","green","darkgoldenrod","darkred","deepskyblue", "coral", "cornflowerblue", "chartreuse4", "bisque4", "chocolate3", "cadetblue3", "darkslategrey", "lightgoldenrod4", "mediumpurple4", "orangered3","indianred1","blueviolet","darkolivegreen4","darkgoldenrod4","firebrick3","deepskyblue4", "coral3", "dodgerblue1", "chartreuse3", "bisque3", "chocolate4", "cadetblue", "darkslategray4", "lightgoldenrod3", "mediumpurple3", "orangered1")
  
  f.targets <- factor(targets)
  vec.targets <- targets.colours[1:length(levels(f.targets))]
  targets.colour <- rep(0,length(f.targets))
  for(i in 1:length(f.targets))
    targets.colour[i] <- vec.targets[ f.targets[i]==levels(f.targets)]
  
  return( list(vec.targets, targets.colour) )
}

##### Assign colours to different datasets
getDatasetsColours <- function(datasets) {
  
  ##### Predefined selection of colours for datasets
  datasets.colours <- c("dodgerblue","firebrick","lightslategrey","darkseagreen","orange","darkcyan","bisque")
  
  f.datasets <- factor(datasets)
  vec.datasets <- datasets.colours[1:length(levels(f.datasets))]
  datasets.colour <- rep(0,length(f.datasets))
  for(i in 1:length(f.datasets))
    datasets.colour[i] <- vec.datasets[ f.datasets[i]==levels(f.datasets)]
  
  return( list(vec.datasets, datasets.colour) )
}

##### Assign symbols to different datasets (for scatterplots)
getDatasetsSymbols <- function(datasets) {
  
  ##### Predefined selection of symbols for datasets
  datasets.symbols <- c("circle","square","diamond","cross","circle-open","square-open","diamond-open")
  
  f.datasets <- factor(datasets)
  vec.datasets <- datasets.symbols[1:length(levels(f.datasets))]
  datasets.symbols <- rep(0,length(f.datasets))
  for(i in 1:length(f.datasets))
    datasets.symbols[i] <- vec.datasets[ f.datasets[i]==levels(f.datasets)]
  
  return( list(vec.datasets, datasets.symbols) )
}
```

### Load libraries


```r
suppressMessages(library(preprocessCore))
suppressMessages(library(rapportools))
suppressMessages(library(sva))
suppressMessages(library(RUVSeq))
```

```
## Warning: package 'GenomicRanges' was built under R version 3.5.1
```

```
## Warning: package 'DelayedArray' was built under R version 3.5.1
```

```r
suppressMessages(library(sneer))
suppressMessages(library(FactoMineR))
suppressMessages(library(plotly))
suppressMessages(library(edgeR))
suppressMessages(library(corrplot))
suppressMessages(library(RSkittleBrewer))
trop <- RSkittleBrewer("tropical")
```

## Read in annotation and data files

Read in the ***dataset file*** containing inforamtion about the ***read count matrices*** to be combined along with the corresponding ***target*** and ***outliers*** files. Then merge the read count matrices based on the information in the *dataset file* Note that only genes intersection across all datasets expression matrices will be reported in the combined expression matrix. Genes not present across all datasets will be listed in *`[datasets`].missing_genes.txt* file.


```r
##### Read file with datasets information
DatasetInput=read.table(paste(params$projectDir,params$datasetsFile,sep="/"),sep="\t", as.is=TRUE, header=TRUE, row.names=1)

##### Extract info about target file for the first dataset
fileInfo = strsplit(DatasetInput[,"Target_file"], split='/', fixed=TRUE)
targetFile <- read.table(DatasetInput[1,"Target_file"], sep="\t", as.is=TRUE, header=TRUE)[,c(1:4)]

##### Make sure that there are no duplciated samples in the target file
targetFile <- targetFile[!duplicated(targetFile[,"Sample_name"]),]
rownames(targetFile) <- targetFile[,"Sample_name"]
targetFile <- cbind(targetFile[,2:4],rownames(DatasetInput[1,]))
colnames(targetFile)[ncol(targetFile)] <- "Dataset"

if ( nrow(DatasetInput) > 1 ) {
  for ( i in 2:nrow(DatasetInput) ) {
    
    ##### Create a temporary object to store info from the remaining target files
    targetFileTmp <- read.table(DatasetInput[i,"Target_file"], sep="\t", as.is=TRUE, header=TRUE)[,c(1:4)]
    
    ##### Make sure that there are no duplciated samples in the target file
    targetFileTmp <- targetFileTmp[!duplicated(targetFileTmp[,"Sample_name"]),]
    rownames(targetFileTmp) <- targetFileTmp[,"Sample_name"]
    targetFileTmp <- cbind(targetFileTmp[,2:4],rownames(DatasetInput[i,]))
    colnames(targetFileTmp)[ncol(targetFileTmp)] <- "Dataset"
    
    ##### Deal with replicates
    if ( any(!is.na(targetFile[,"Replicates"])) ) {
      maxRep <- max(targetFile[!is.na(targetFile[,"Replicates"]),"Replicates"])
      targetFileTmp[,"Replicates"] <- targetFileTmp[,"Replicates"] + maxRep
    }
    targetFile <- rbind(targetFile, targetFileTmp)
  }
}

##### Make syntactically valid names
rownames(targetFile) <- make.names(rownames(targetFile))

##### Loop through the gene-by-sample expression matrices from different datasets and merge them into a matrix
for (data_matrix in DatasetInput[ , "Expression_matrix" ] ) {
  
  ##### Create combined dataset variable if it doesn't exist yet
  if (!exists("datasets")) {
    datasets <- as.data.frame( read.table(data_matrix, header=TRUE, sep="\t", row.names=NULL) )
    
    ##### list genes present in individal files
    gene_list <- as.vector(datasets[,1])
    
    ##### Add data for the remaining samples   
  } else if (exists("datasets")) {
    dataset <-as.data.frame( read.table(data_matrix, header=TRUE, sep="\t", row.names=NULL) )
    
    ##### list genes present in individal files
    gene_list <- c( gene_list, as.vector(dataset[,1]) )
    
    ##### Merge the expression data and make sure that the genes order is the same
    datasets <- merge( datasets, dataset, by=1, all = FALSE, sort= TRUE)
    
    ##### Remove per-sample data for merged samples to free some memory
    rm(dataset)
  }
}

##### Use gene IDs as rownames
rownames(datasets) <- datasets[,1]
datasets <- datasets[, -1]

##### Make syntactically valid names
colnames(datasets) <- make.names(colnames(datasets))

##### Make sure that the target file contains info only about samples present in the data matrix
targetFile <- targetFile[ rownames(targetFile) %in% colnames(datasets),  ]

##### Make sure that the samples order in the data matrix is the same as in the target file 
datasets <- datasets[ , rownames(targetFile) ]

##### Save datasets names
datasetIDs <- rownames(DatasetInput)

##### Identify genes that were not present across all per-sampel files and were ommited in the merged matrix
gene_list <- unique(gene_list)
gene_list.missing <- gene_list[ gene_list %!in% rownames(datasets) ]


##### Write list of missing genes into a file
if ( length(gene_list.missing) > 0 ) {
  write.table(prepare2write(gene_list.missing), file = paste0(params$projectDir, "/", paste(datasetIDs, collapse="_"),".missing_genes.txt"), sep="\t", quote=FALSE, row.names=TRUE, append = FALSE )
}
```

## Remove outliers

Remove user-defined outliers from individual datasets listed in outliers files.


```r
outlierList <- NULL
j<-1

##### Read outliers file for each dataset and list them
for ( i in 1:length(datasetIDs) ) {
  
  ##### Check if the outliers file is reported. If not, assume that there are not outliers in the corresponding dataset
  if ( !is.empty(DatasetInput[ i, "Outliers_file"]) ) {
    
    ##### Check if the outliers file is not empty
    FileInfo = file.info(DatasetInput[ i, "Outliers_file"])
    
    ##### If non-empty then read it in
    if ( FileInfo$size != 0 ) {
      
      outliersInfo = read.table(DatasetInput[ i, "Outliers_file"], sep="\t", as.is=TRUE, header=FALSE, row.names=NULL)
      outliers=as.vector(unlist(outliersInfo))
      
      for (k in 1:length(outliers)) {
        
        cat(paste("Removing sample:", outliers[k], "\n", sep=" "))
        outlierList[j] <- outliers[k]
        j<-j+1
      }
    }
  }
}
```

```
Removing sample: TCGA-F2-6880-01A-11R-2156-07 
Removing sample: TCGA-F2-7273-01A-11R-2156-07 
Removing sample: TCGA-F2-7276-01A-11R-2156-07 
Removing sample: TCGA-H8-A6C1-01A-11R-A32O-07 
Removing sample: TCGA-HZ-7918-01A-11R-2156-07 
Removing sample: TCGA-HZ-7920-01A-11R-2204-07 
Removing sample: TCGA-HZ-7923-01A-12R-2156-07 
Removing sample: TCGA-HZ-7924-01A-11R-2156-07 
Removing sample: TCGA-IB-7654-01A-11R-2156-07 
Removing sample: TCGA-IB-AAUV-01A-11R-A38C-07 
Removing sample: TCGA-IB-AAUW-01A-12R-A38C-07 
Removing sample: TCGA-RL-AAAS-01A-32R-A39D-07 
Removing sample: TCGA-US-A77J-01A-11R-A32O-07 
Removing sample: TCGA-2J-AABP-01A-11R-A41B-07 
Removing sample: TCGA-FB-A7DR-01A-21R-A33R-07 
Removing sample: TCGA-HZ-7289-01A-11R-2156-07 
Removing sample: TCGA-HZ-8638-01A-11R-2404-07 
```

```r
##### Make syntactically valid names
outlierList <- make.names(outlierList)


##### Remove outliers from the combined expression matrix and target file
datasets <- datasets[, setdiff(colnames(datasets), outlierList) ]
targetFile <- targetFile[ setdiff(rownames(targetFile) , outlierList) ,]
```

## Datasets library size {.tabset}

### Datasets

Bar-plot illustrating library size for each sample (bar). The colours indicate datasets.


```r
suppressMessages(library(plotly))

##### Assigne colours to targets and datasets
targets.colour <- getTargetsColours(targetFile$Target)
datasets.colour <- getDatasetsColours(targetFile$Dataset)

##### Assign symbopls according to defined datasets
datasets.symbols <- getDatasetsSymbols(targetFile$Dataset)

##### Generate bar-plot for library size
##### Prepare data frame
datasets.df <- data.frame(targetFile$Dataset, colnames(datasets), as.numeric(colSums(datasets)*1e-6))
colnames(datasets.df) <- c("Dataset","Sample", "Library_size")

##### The default order will be alphabetized unless specified as below
datasets.df$Sample <- factor(datasets.df$Sample, levels = datasets.df[["Sample"]])

p <- plot_ly(datasets.df, x = ~Sample, y = ~Library_size, color = ~Dataset, type = 'bar', colors = datasets.colour[[1]], width = 1000, height = 400) %>%
  layout(title = "", xaxis = list( tickfont = list(size = 10), title = ""), yaxis = list(title = "Library size (millions)"), margin = list(l=50, r=50, b=150, t=50, pad=4), autosize = F, legend = list(orientation = 'v', y = 0.5), showlegend=TRUE)

##### Print htmlwidget
p
```

<!--html_preserve--><div id="htmlwidget-d40664c4d794e64074f5" style="width:1000px;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d40664c4d794e64074f5">{"x":{"visdat":{"1c25724c469d":["function () ","plotlyVisDat"]},"cur_data":"1c25724c469d","attrs":{"1c25724c469d":{"x":{},"y":{},"color":{},"colors":["dodgerblue","firebrick"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":1000,"height":400,"margin":{"b":150,"l":50,"t":50,"r":50,"pad":4},"title":"","xaxis":{"domain":[0,1],"automargin":true,"tickfont":{"size":10},"title":"","type":"category","categoryorder":"array","categoryarray":["TCGA.IB.AAUO.01A.12R.A38C.07","TCGA.3A.A9I9.01A.11R.A38C.07","TCGA.HZ.8519.01A.11R.2404.07","TCGA.IB.7885.01A.11R.2156.07","TCGA.US.A774.01A.21R.A32O.07","TCGA.S4.A8RM.01A.11R.A37L.07","TCGA.3A.A9IR.01A.11R.A38C.07","TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA.2J.AABA.01A.21R.A41B.07","TCGA.M8.A5N4.01A.11R.A26U.07","TCGA.2L.AAQL.01A.11R.A38C.07","TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA.IB.7645.01A.22R.2204.07","TCGA.2J.AABU.01A.11R.A41B.07","TCGA.3A.A9IV.01A.11R.A41B.07","TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA.IB.AAUR.01A.21R.A38C.07","TCGA.IB.7887.01A.11R.2156.07","TCGA.IB.7893.01A.11R.2204.07","TCGA.2J.AABF.01A.31R.A41B.07","TCGA.3A.A9IN.01A.11R.A39D.07","TCGA.HV.AA8V.01A.11R.A41B.07","TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA.IB.7888.01A.11R.2156.07","TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA.2J.AAB9.01A.11R.A41B.07","TCGA.IB.A6UF.01A.23R.A33R.07","TCGA.HV.A5A3.01A.11R.A26U.07","TCGA.S4.A8RP.01A.11R.A36G.07","TCGA.F2.A7TX.01A.33R.A38C.07","TCGA.HV.A7OL.01A.11R.A33R.07","TCGA.HZ.A49H.01A.11R.A26U.07","TCGA.XN.A8T5.01A.12R.A36G.07","TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA.LB.A7SX.01A.11R.A33R.07","TCGA.YB.A89D.11A.11R.A36G.07","TCGA.RB.A7B8.01A.12R.A33R.07","TCGA.XD.AAUI.01A.42R.A41B.07","TCGA.2J.AABH.01A.21R.A41B.07","TCGA.3A.A9IO.01A.11R.A38C.07","TCGA.IB.AAUP.01A.11R.A37L.07","TCGA.3A.A9IB.01A.21R.A39D.07","TCGA.IB.AAUT.01A.11R.A37L.07","TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA.2J.AABK.01A.31R.A41B.07","TCGA.IB.AAUM.01A.11R.A37L.07","TCGA.FB.A4P6.01A.12R.A26U.07","TCGA.3A.A9IC.01A.11R.A38C.07","TCGA.FB.AAPU.01A.31R.A41B.07","TCGA.2L.AAQI.01A.12R.A39D.07","TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA.HZ.8317.01A.11R.2404.07","TCGA.IB.7897.01A.21R.2204.07","TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA.2L.AAQE.01A.11R.A39D.07","TCGA.HZ.A77P.01A.11R.A33R.07","TCGA.IB.A7LX.01A.12R.A36G.07","TCGA.2J.AAB4.01A.12R.A41B.07","TCGA.FB.AAPP.01A.12R.A41B.07","TCGA.2J.AABT.01A.11R.A41B.07","TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA.HZ.8315.01A.11R.2404.07","TCGA.XD.AAUG.01A.61R.A41B.07","TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA.IB.7652.01A.11R.2156.07","TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA.HV.A5A4.01A.11R.A26U.07","TCGA.IB.7890.01A.12R.2204.07","TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA.IB.7644.01A.11R.2156.07","TCGA.IB.A5SO.01A.11R.A32O.07","TCGA.2J.AABI.01A.12R.A41B.07","TCGA.2J.AABO.01A.21R.A41B.07","TCGA.US.A779.01A.11R.A32O.07","TCGA.3A.A9IH.01A.12R.A39D.07","TCGA.HZ.7919.01A.11R.2156.07","TCGA.HV.A5A6.01A.11R.A26U.07","TCGA.YH.A8SY.01A.11R.A37L.07","TCGA.F2.6879.01A.11R.2156.07","TCGA.3A.A9IU.01A.11R.A39D.07","TCGA.HV.AA8X.01A.11R.A39D.07","TCGA.IB.8127.01A.11R.2404.07","TCGA.FB.AAPS.01A.12R.A39D.07","TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA.US.A77E.01A.11R.A32O.07","TCGA.F2.A44H.01A.11R.A26U.07","TCGA.3A.A9I5.01A.11R.A38C.07","TCGA.RB.AA9M.01A.11R.A39D.07","TCGA.HV.A7OP.01A.11R.A33R.07","TCGA.FB.A545.01A.11R.A26U.07","TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA.IB.8126.01A.11R.2404.07","TCGA.IB.A5SP.01A.11R.A32O.07","TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA.HZ.8001.01A.11R.2204.07","TCGA.2J.AABE.01A.12R.A41B.07","TCGA.3A.A9IL.01A.11R.A38C.07","TCGA.IB.AAUN.01A.12R.A38C.07","TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA.2J.AABV.01A.12R.A41B.07","TCGA.XN.A8T3.01A.11R.A36G.07","TCGA.OE.A75W.01A.12R.A32O.07","TCGA.LB.A8F3.01A.11R.A36G.07","TCGA.HZ.8636.01A.21R.2404.07","TCGA.XD.AAUL.01A.21R.A39D.07","TCGA.2L.AAQM.01A.11R.A39D.07","TCGA.3A.A9I7.01A.21R.A38C.07","TCGA.US.A776.01A.13R.A33R.07","TCGA.IB.A7M4.01A.11R.A36G.07","TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA.2L.AAQA.01A.21R.A38C.07","TCGA.IB.7889.01A.11R.2156.07","TCGA.F2.A8YN.01A.11R.A37L.07","TCGA.YB.A89D.01A.12R.A36G.07","TCGA.3A.A9IS.01A.21R.A39D.07","TCGA.IB.A6UG.01A.32R.A33R.07","TCGA.FB.AAPY.01A.11R.A41B.07","TCGA.S4.A8RO.01A.12R.A37L.07","TCGA.HZ.8637.01A.11R.2404.07","TCGA.2J.AAB6.01A.11R.A41B.07","TCGA.IB.7886.01A.11R.2156.07","TCGA.H6.8124.01A.11R.2404.07","TCGA.IB.7891.01A.11R.2204.07","TCGA.H6.A45N.11A.12R.A26U.07","TCGA.HZ.7926.01A.11R.2156.07","TCGA.IB.7646.01A.11R.2156.07","TCGA.2J.AABR.01A.11R.A41B.07","TCGA.3A.A9J0.01A.11R.A41B.07","TCGA.IB.7651.01A.11R.2156.07","TCGA.IB.AAUU.01A.11R.A37L.07","TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA.IB.AAUS.01A.12R.A38C.07","TCGA.F2.A44G.01A.11R.A26U.07","TCGA.3A.A9IX.01A.11R.A41B.07","TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA.US.A77G.01A.11R.A32O.07","TCGA.HZ.8005.01A.11R.2204.07","TCGA.2J.AAB8.01A.12R.A41B.07","TCGA.HV.A5A3.11A.11R.A26U.07","TCGA.YY.A8LH.01A.11R.A36G.07","TCGA.HZ.A49G.01A.11R.A26U.07","TCGA.FB.A5VM.01A.11R.A32O.07","TCGA.IB.7649.01A.11R.2156.07","TCGA.HZ.7925.01A.11R.2156.07","TCGA.FB.A78T.01A.12R.A32O.07","TCGA.HZ.7922.01A.11R.2156.07","TCGA.HZ.A77O.01A.11R.A33R.07","TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA.IB.A5ST.01A.11R.A32O.07","TCGA.XD.AAUH.01A.42R.A41B.07","TCGA.HZ.8003.01A.21R.2204.07","TCGA.HV.A5A5.01A.11R.A26U.07","TCGA.IB.A5SS.01A.11R.A32O.07","TCGA.HZ.A49I.01A.12R.A26U.07","TCGA.H6.8124.11A.01R.2404.07","TCGA.HZ.8002.01A.11R.2204.07","TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA.FB.A4P5.01A.11R.A26U.07","TCGA.2J.AAB1.01A.11R.A41B.07","TCGA.3E.AAAY.01A.11R.A38C.07","TCGA.L1.A7W4.01A.12R.A36G.07","TCGA.H6.A45N.01A.11R.A26U.07","TCGA.FB.AAQ0.01A.31R.A41B.07","CCR170093_RNA_WPT_013","CCR170012_MH17T001P013"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Library size (millions)"},"autosize":false,"legend":{"orientation":"v","y":0.5},"showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":["TCGA.IB.AAUO.01A.12R.A38C.07","TCGA.3A.A9I9.01A.11R.A38C.07","TCGA.HZ.8519.01A.11R.2404.07","TCGA.IB.7885.01A.11R.2156.07","TCGA.US.A774.01A.21R.A32O.07","TCGA.S4.A8RM.01A.11R.A37L.07","TCGA.3A.A9IR.01A.11R.A38C.07","TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA.2J.AABA.01A.21R.A41B.07","TCGA.M8.A5N4.01A.11R.A26U.07","TCGA.2L.AAQL.01A.11R.A38C.07","TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA.IB.7645.01A.22R.2204.07","TCGA.2J.AABU.01A.11R.A41B.07","TCGA.3A.A9IV.01A.11R.A41B.07","TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA.IB.AAUR.01A.21R.A38C.07","TCGA.IB.7887.01A.11R.2156.07","TCGA.IB.7893.01A.11R.2204.07","TCGA.2J.AABF.01A.31R.A41B.07","TCGA.3A.A9IN.01A.11R.A39D.07","TCGA.HV.AA8V.01A.11R.A41B.07","TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA.IB.7888.01A.11R.2156.07","TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA.2J.AAB9.01A.11R.A41B.07","TCGA.IB.A6UF.01A.23R.A33R.07","TCGA.HV.A5A3.01A.11R.A26U.07","TCGA.S4.A8RP.01A.11R.A36G.07","TCGA.F2.A7TX.01A.33R.A38C.07","TCGA.HV.A7OL.01A.11R.A33R.07","TCGA.HZ.A49H.01A.11R.A26U.07","TCGA.XN.A8T5.01A.12R.A36G.07","TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA.LB.A7SX.01A.11R.A33R.07","TCGA.YB.A89D.11A.11R.A36G.07","TCGA.RB.A7B8.01A.12R.A33R.07","TCGA.XD.AAUI.01A.42R.A41B.07","TCGA.2J.AABH.01A.21R.A41B.07","TCGA.3A.A9IO.01A.11R.A38C.07","TCGA.IB.AAUP.01A.11R.A37L.07","TCGA.3A.A9IB.01A.21R.A39D.07","TCGA.IB.AAUT.01A.11R.A37L.07","TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA.2J.AABK.01A.31R.A41B.07","TCGA.IB.AAUM.01A.11R.A37L.07","TCGA.FB.A4P6.01A.12R.A26U.07","TCGA.3A.A9IC.01A.11R.A38C.07","TCGA.FB.AAPU.01A.31R.A41B.07","TCGA.2L.AAQI.01A.12R.A39D.07","TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA.HZ.8317.01A.11R.2404.07","TCGA.IB.7897.01A.21R.2204.07","TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA.2L.AAQE.01A.11R.A39D.07","TCGA.HZ.A77P.01A.11R.A33R.07","TCGA.IB.A7LX.01A.12R.A36G.07","TCGA.2J.AAB4.01A.12R.A41B.07","TCGA.FB.AAPP.01A.12R.A41B.07","TCGA.2J.AABT.01A.11R.A41B.07","TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA.HZ.8315.01A.11R.2404.07","TCGA.XD.AAUG.01A.61R.A41B.07","TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA.IB.7652.01A.11R.2156.07","TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA.HV.A5A4.01A.11R.A26U.07","TCGA.IB.7890.01A.12R.2204.07","TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA.IB.7644.01A.11R.2156.07","TCGA.IB.A5SO.01A.11R.A32O.07","TCGA.2J.AABI.01A.12R.A41B.07","TCGA.2J.AABO.01A.21R.A41B.07","TCGA.US.A779.01A.11R.A32O.07","TCGA.3A.A9IH.01A.12R.A39D.07","TCGA.HZ.7919.01A.11R.2156.07","TCGA.HV.A5A6.01A.11R.A26U.07","TCGA.YH.A8SY.01A.11R.A37L.07","TCGA.F2.6879.01A.11R.2156.07","TCGA.3A.A9IU.01A.11R.A39D.07","TCGA.HV.AA8X.01A.11R.A39D.07","TCGA.IB.8127.01A.11R.2404.07","TCGA.FB.AAPS.01A.12R.A39D.07","TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA.US.A77E.01A.11R.A32O.07","TCGA.F2.A44H.01A.11R.A26U.07","TCGA.3A.A9I5.01A.11R.A38C.07","TCGA.RB.AA9M.01A.11R.A39D.07","TCGA.HV.A7OP.01A.11R.A33R.07","TCGA.FB.A545.01A.11R.A26U.07","TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA.IB.8126.01A.11R.2404.07","TCGA.IB.A5SP.01A.11R.A32O.07","TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA.HZ.8001.01A.11R.2204.07","TCGA.2J.AABE.01A.12R.A41B.07","TCGA.3A.A9IL.01A.11R.A38C.07","TCGA.IB.AAUN.01A.12R.A38C.07","TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA.2J.AABV.01A.12R.A41B.07","TCGA.XN.A8T3.01A.11R.A36G.07","TCGA.OE.A75W.01A.12R.A32O.07","TCGA.LB.A8F3.01A.11R.A36G.07","TCGA.HZ.8636.01A.21R.2404.07","TCGA.XD.AAUL.01A.21R.A39D.07","TCGA.2L.AAQM.01A.11R.A39D.07","TCGA.3A.A9I7.01A.21R.A38C.07","TCGA.US.A776.01A.13R.A33R.07","TCGA.IB.A7M4.01A.11R.A36G.07","TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA.2L.AAQA.01A.21R.A38C.07","TCGA.IB.7889.01A.11R.2156.07","TCGA.F2.A8YN.01A.11R.A37L.07","TCGA.YB.A89D.01A.12R.A36G.07","TCGA.3A.A9IS.01A.21R.A39D.07","TCGA.IB.A6UG.01A.32R.A33R.07","TCGA.FB.AAPY.01A.11R.A41B.07","TCGA.S4.A8RO.01A.12R.A37L.07","TCGA.HZ.8637.01A.11R.2404.07","TCGA.2J.AAB6.01A.11R.A41B.07","TCGA.IB.7886.01A.11R.2156.07","TCGA.H6.8124.01A.11R.2404.07","TCGA.IB.7891.01A.11R.2204.07","TCGA.H6.A45N.11A.12R.A26U.07","TCGA.HZ.7926.01A.11R.2156.07","TCGA.IB.7646.01A.11R.2156.07","TCGA.2J.AABR.01A.11R.A41B.07","TCGA.3A.A9J0.01A.11R.A41B.07","TCGA.IB.7651.01A.11R.2156.07","TCGA.IB.AAUU.01A.11R.A37L.07","TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA.IB.AAUS.01A.12R.A38C.07","TCGA.F2.A44G.01A.11R.A26U.07","TCGA.3A.A9IX.01A.11R.A41B.07","TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA.US.A77G.01A.11R.A32O.07","TCGA.HZ.8005.01A.11R.2204.07","TCGA.2J.AAB8.01A.12R.A41B.07","TCGA.HV.A5A3.11A.11R.A26U.07","TCGA.YY.A8LH.01A.11R.A36G.07","TCGA.HZ.A49G.01A.11R.A26U.07","TCGA.FB.A5VM.01A.11R.A32O.07","TCGA.IB.7649.01A.11R.2156.07","TCGA.HZ.7925.01A.11R.2156.07","TCGA.FB.A78T.01A.12R.A32O.07","TCGA.HZ.7922.01A.11R.2156.07","TCGA.HZ.A77O.01A.11R.A33R.07","TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA.IB.A5ST.01A.11R.A32O.07","TCGA.XD.AAUH.01A.42R.A41B.07","TCGA.HZ.8003.01A.21R.2204.07","TCGA.HV.A5A5.01A.11R.A26U.07","TCGA.IB.A5SS.01A.11R.A32O.07","TCGA.HZ.A49I.01A.12R.A26U.07","TCGA.H6.8124.11A.01R.2404.07","TCGA.HZ.8002.01A.11R.2204.07","TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA.FB.A4P5.01A.11R.A26U.07","TCGA.2J.AAB1.01A.11R.A41B.07","TCGA.3E.AAAY.01A.11R.A38C.07","TCGA.L1.A7W4.01A.12R.A36G.07","TCGA.H6.A45N.01A.11R.A26U.07","TCGA.FB.AAQ0.01A.31R.A41B.07"],"y":[49.71709,49.871904,89.735899,72.333279,55.785132,53.15632,57.248857,45.520404,34.767934,41.888616,38.020515,23.953413,53.776162,20.245839,40.436788,27.299439,45.81506,49.984271,65.950777,68.886598,60.676457,46.861122,51.798556,31.336701,41.275362,58.582898,22.725468,49.014981,30.474143,41.158282,52.8434,41.883276,46.275197,37.608052,48.650568,49.489457,50.239097,44.321305,45.875146,57.600007,50.429973,52.174846,59.840559,39.36697,37.672565,55.899282,48.713063,31.060244,51.225138,64.69739,47.452335,45.913311,59.565076,58.721218,39.004995,47.234326,62.467713,50.81768,53.143953,30.642113,37.606251,40.512887,64.686632,37.021154,47.835093,84.140103,40.400133,42.29014,46.091634,47.538056,71.474973,62.809925,64.64856,29.471088,45.709749,60.503631,55.369723,42.619795,46.206961,73.211907,54.774916,51.567393,88.228854,38.867053,35.884763,53.257754,25.794336,42.008422,48.668784,33.472503,29.955362,33.540355,58.230304,46.502731,52.77096,62.417312,36.769016,45.267396,42.3928,49.455822,40.220853,43.640349,49.666696,53.222602,69.034627,55.632903,40.519653,56.131479,50.87558,45.478532,31.501093,57.259817,59.698983,46.436907,45.068874,50.055485,50.817024,46.429419,43.938885,74.944992,41.449837,60.329388,58.235276,57.932988,36.270775,73.425686,48.149376,35.681497,45.743332,82.820778,51.426626,39.572379,50.2093,42.583256,59.002121,62.904824,37.894106,47.58145,56.478293,23.337484,41.854187,50.763706,42.673709,47.583843,35.565217,79.138298,57.807798,55.857645,49.050726,50.625539,52.026291,41.150984,67.147381,40.807003,63.026591,41.532516,61.648736,59.224066,43.363615,30.479071,46.885604,46.204476,52.330565,28.333706,40.022344],"type":"bar","name":"TCGA-PAAD","marker":{"color":"rgba(30,144,255,1)","line":{"color":"rgba(30,144,255,1)"}},"textfont":{"color":"rgba(30,144,255,1)"},"error_y":{"color":"rgba(30,144,255,1)"},"error_x":{"color":"rgba(30,144,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["CCR170093_RNA_WPT_013","CCR170012_MH17T001P013"],"y":[30.992428,39.941856],"type":"bar","name":"Avner","marker":{"color":"rgba(178,34,34,1)","line":{"color":"rgba(178,34,34,1)"}},"textfont":{"color":"rgba(178,34,34,1)"},"error_y":{"color":"rgba(178,34,34,1)"},"error_x":{"color":"rgba(178,34,34,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save the bar-plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_RNAseq_libSize_datasets.html"), selfcontained = TRUE)
```

### Targets

Bar-plot illustrating library size for each sample (bar). The colours indicate sample groups, as provided in *Target* column in the target files.


```r
##### Generate bar-plot for library size
##### Prepare data frame
datasets.df <- data.frame(targetFile$Target, colnames(datasets), as.numeric(colSums(datasets)*1e-6))
colnames(datasets.df) <- c("Group","Sample", "Library_size")

##### The default order will be alphabetized unless specified as below
datasets.df$Sample <- factor(datasets.df$Sample, levels = datasets.df[["Sample"]])

p <- plot_ly(datasets.df, x = ~Sample, y = ~Library_size, color = ~Group, type = 'bar', colors = targets.colour[[1]], width = 1000, height = 400) %>%
  layout(title = "", xaxis = list( tickfont = list(size = 10), title = ""), yaxis = list(title = "Library size (millions)"), margin = list(l=50, r=50, b=150, t=50, pad=4), autosize = F, legend = list(orientation = 'v', y = 0.5), showlegend=TRUE)

##### Print htmlwidget
p
```

<!--html_preserve--><div id="htmlwidget-c4c59e163604eb0be0c4" style="width:1000px;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c4c59e163604eb0be0c4">{"x":{"visdat":{"1c254c32599a":["function () ","plotlyVisDat"]},"cur_data":"1c254c32599a","attrs":{"1c254c32599a":{"x":{},"y":{},"color":{},"colors":["red","blue","green","darkgoldenrod","darkred","deepskyblue"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":1000,"height":400,"margin":{"b":150,"l":50,"t":50,"r":50,"pad":4},"title":"","xaxis":{"domain":[0,1],"automargin":true,"tickfont":{"size":10},"title":"","type":"category","categoryorder":"array","categoryarray":["TCGA.IB.AAUO.01A.12R.A38C.07","TCGA.3A.A9I9.01A.11R.A38C.07","TCGA.HZ.8519.01A.11R.2404.07","TCGA.IB.7885.01A.11R.2156.07","TCGA.US.A774.01A.21R.A32O.07","TCGA.S4.A8RM.01A.11R.A37L.07","TCGA.3A.A9IR.01A.11R.A38C.07","TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA.2J.AABA.01A.21R.A41B.07","TCGA.M8.A5N4.01A.11R.A26U.07","TCGA.2L.AAQL.01A.11R.A38C.07","TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA.IB.7645.01A.22R.2204.07","TCGA.2J.AABU.01A.11R.A41B.07","TCGA.3A.A9IV.01A.11R.A41B.07","TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA.IB.AAUR.01A.21R.A38C.07","TCGA.IB.7887.01A.11R.2156.07","TCGA.IB.7893.01A.11R.2204.07","TCGA.2J.AABF.01A.31R.A41B.07","TCGA.3A.A9IN.01A.11R.A39D.07","TCGA.HV.AA8V.01A.11R.A41B.07","TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA.IB.7888.01A.11R.2156.07","TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA.2J.AAB9.01A.11R.A41B.07","TCGA.IB.A6UF.01A.23R.A33R.07","TCGA.HV.A5A3.01A.11R.A26U.07","TCGA.S4.A8RP.01A.11R.A36G.07","TCGA.F2.A7TX.01A.33R.A38C.07","TCGA.HV.A7OL.01A.11R.A33R.07","TCGA.HZ.A49H.01A.11R.A26U.07","TCGA.XN.A8T5.01A.12R.A36G.07","TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA.LB.A7SX.01A.11R.A33R.07","TCGA.YB.A89D.11A.11R.A36G.07","TCGA.RB.A7B8.01A.12R.A33R.07","TCGA.XD.AAUI.01A.42R.A41B.07","TCGA.2J.AABH.01A.21R.A41B.07","TCGA.3A.A9IO.01A.11R.A38C.07","TCGA.IB.AAUP.01A.11R.A37L.07","TCGA.3A.A9IB.01A.21R.A39D.07","TCGA.IB.AAUT.01A.11R.A37L.07","TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA.2J.AABK.01A.31R.A41B.07","TCGA.IB.AAUM.01A.11R.A37L.07","TCGA.FB.A4P6.01A.12R.A26U.07","TCGA.3A.A9IC.01A.11R.A38C.07","TCGA.FB.AAPU.01A.31R.A41B.07","TCGA.2L.AAQI.01A.12R.A39D.07","TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA.HZ.8317.01A.11R.2404.07","TCGA.IB.7897.01A.21R.2204.07","TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA.2L.AAQE.01A.11R.A39D.07","TCGA.HZ.A77P.01A.11R.A33R.07","TCGA.IB.A7LX.01A.12R.A36G.07","TCGA.2J.AAB4.01A.12R.A41B.07","TCGA.FB.AAPP.01A.12R.A41B.07","TCGA.2J.AABT.01A.11R.A41B.07","TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA.HZ.8315.01A.11R.2404.07","TCGA.XD.AAUG.01A.61R.A41B.07","TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA.IB.7652.01A.11R.2156.07","TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA.HV.A5A4.01A.11R.A26U.07","TCGA.IB.7890.01A.12R.2204.07","TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA.IB.7644.01A.11R.2156.07","TCGA.IB.A5SO.01A.11R.A32O.07","TCGA.2J.AABI.01A.12R.A41B.07","TCGA.2J.AABO.01A.21R.A41B.07","TCGA.US.A779.01A.11R.A32O.07","TCGA.3A.A9IH.01A.12R.A39D.07","TCGA.HZ.7919.01A.11R.2156.07","TCGA.HV.A5A6.01A.11R.A26U.07","TCGA.YH.A8SY.01A.11R.A37L.07","TCGA.F2.6879.01A.11R.2156.07","TCGA.3A.A9IU.01A.11R.A39D.07","TCGA.HV.AA8X.01A.11R.A39D.07","TCGA.IB.8127.01A.11R.2404.07","TCGA.FB.AAPS.01A.12R.A39D.07","TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA.US.A77E.01A.11R.A32O.07","TCGA.F2.A44H.01A.11R.A26U.07","TCGA.3A.A9I5.01A.11R.A38C.07","TCGA.RB.AA9M.01A.11R.A39D.07","TCGA.HV.A7OP.01A.11R.A33R.07","TCGA.FB.A545.01A.11R.A26U.07","TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA.IB.8126.01A.11R.2404.07","TCGA.IB.A5SP.01A.11R.A32O.07","TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA.HZ.8001.01A.11R.2204.07","TCGA.2J.AABE.01A.12R.A41B.07","TCGA.3A.A9IL.01A.11R.A38C.07","TCGA.IB.AAUN.01A.12R.A38C.07","TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA.2J.AABV.01A.12R.A41B.07","TCGA.XN.A8T3.01A.11R.A36G.07","TCGA.OE.A75W.01A.12R.A32O.07","TCGA.LB.A8F3.01A.11R.A36G.07","TCGA.HZ.8636.01A.21R.2404.07","TCGA.XD.AAUL.01A.21R.A39D.07","TCGA.2L.AAQM.01A.11R.A39D.07","TCGA.3A.A9I7.01A.21R.A38C.07","TCGA.US.A776.01A.13R.A33R.07","TCGA.IB.A7M4.01A.11R.A36G.07","TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA.2L.AAQA.01A.21R.A38C.07","TCGA.IB.7889.01A.11R.2156.07","TCGA.F2.A8YN.01A.11R.A37L.07","TCGA.YB.A89D.01A.12R.A36G.07","TCGA.3A.A9IS.01A.21R.A39D.07","TCGA.IB.A6UG.01A.32R.A33R.07","TCGA.FB.AAPY.01A.11R.A41B.07","TCGA.S4.A8RO.01A.12R.A37L.07","TCGA.HZ.8637.01A.11R.2404.07","TCGA.2J.AAB6.01A.11R.A41B.07","TCGA.IB.7886.01A.11R.2156.07","TCGA.H6.8124.01A.11R.2404.07","TCGA.IB.7891.01A.11R.2204.07","TCGA.H6.A45N.11A.12R.A26U.07","TCGA.HZ.7926.01A.11R.2156.07","TCGA.IB.7646.01A.11R.2156.07","TCGA.2J.AABR.01A.11R.A41B.07","TCGA.3A.A9J0.01A.11R.A41B.07","TCGA.IB.7651.01A.11R.2156.07","TCGA.IB.AAUU.01A.11R.A37L.07","TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA.IB.AAUS.01A.12R.A38C.07","TCGA.F2.A44G.01A.11R.A26U.07","TCGA.3A.A9IX.01A.11R.A41B.07","TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA.US.A77G.01A.11R.A32O.07","TCGA.HZ.8005.01A.11R.2204.07","TCGA.2J.AAB8.01A.12R.A41B.07","TCGA.HV.A5A3.11A.11R.A26U.07","TCGA.YY.A8LH.01A.11R.A36G.07","TCGA.HZ.A49G.01A.11R.A26U.07","TCGA.FB.A5VM.01A.11R.A32O.07","TCGA.IB.7649.01A.11R.2156.07","TCGA.HZ.7925.01A.11R.2156.07","TCGA.FB.A78T.01A.12R.A32O.07","TCGA.HZ.7922.01A.11R.2156.07","TCGA.HZ.A77O.01A.11R.A33R.07","TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA.IB.A5ST.01A.11R.A32O.07","TCGA.XD.AAUH.01A.42R.A41B.07","TCGA.HZ.8003.01A.21R.2204.07","TCGA.HV.A5A5.01A.11R.A26U.07","TCGA.IB.A5SS.01A.11R.A32O.07","TCGA.HZ.A49I.01A.12R.A26U.07","TCGA.H6.8124.11A.01R.2404.07","TCGA.HZ.8002.01A.11R.2204.07","TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA.FB.A4P5.01A.11R.A26U.07","TCGA.2J.AAB1.01A.11R.A41B.07","TCGA.3E.AAAY.01A.11R.A38C.07","TCGA.L1.A7W4.01A.12R.A36G.07","TCGA.H6.A45N.01A.11R.A26U.07","TCGA.FB.AAQ0.01A.31R.A41B.07","CCR170093_RNA_WPT_013","CCR170012_MH17T001P013"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Library size (millions)"},"autosize":false,"legend":{"orientation":"v","y":0.5},"showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":["TCGA.FB.AAPP.01A.12R.A41B.07","TCGA.HV.A7OP.01A.11R.A33R.07"],"y":[30.642113,33.472503],"type":"bar","name":"IPMN","marker":{"color":"rgba(255,0,0,1)","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["TCGA.HZ.A9TJ.06A.11R.A41B.07"],"y":[52.77096],"type":"bar","name":"Metastatic","marker":{"color":"rgba(0,0,255,1)","line":{"color":"rgba(0,0,255,1)"}},"textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["TCGA.YB.A89D.11A.11R.A36G.07","TCGA.H6.A45N.11A.12R.A26U.07","TCGA.HV.A5A3.11A.11R.A26U.07","TCGA.H6.8124.11A.01R.2404.07"],"y":[50.239097,36.270775,41.854187,61.648736],"type":"bar","name":"Normal","marker":{"color":"rgba(0,255,0,1)","line":{"color":"rgba(0,255,0,1)"}},"textfont":{"color":"rgba(0,255,0,1)"},"error_y":{"color":"rgba(0,255,0,1)"},"error_x":{"color":"rgba(0,255,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["CCR170093_RNA_WPT_013"],"y":[30.992428],"type":"bar","name":"Organoid","marker":{"color":"rgba(184,134,11,1)","line":{"color":"rgba(184,134,11,1)"}},"textfont":{"color":"rgba(184,134,11,1)"},"error_y":{"color":"rgba(184,134,11,1)"},"error_x":{"color":"rgba(184,134,11,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["TCGA.3A.A9IR.01A.11R.A38C.07","TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA.3A.A9IV.01A.11R.A41B.07","TCGA.3A.A9IN.01A.11R.A39D.07","TCGA.3A.A9IO.01A.11R.A38C.07","TCGA.3A.A9IL.01A.11R.A38C.07","TCGA.2L.AAQM.01A.11R.A39D.07","TCGA.3A.A9IS.01A.21R.A39D.07"],"y":[57.248857,45.520404,40.436788,46.861122,50.429973,45.267396,40.519653,50.055485],"type":"bar","name":"PanNET","marker":{"color":"rgba(139,0,0,1)","line":{"color":"rgba(139,0,0,1)"}},"textfont":{"color":"rgba(139,0,0,1)"},"error_y":{"color":"rgba(139,0,0,1)"},"error_x":{"color":"rgba(139,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["TCGA.IB.AAUO.01A.12R.A38C.07","TCGA.3A.A9I9.01A.11R.A38C.07","TCGA.HZ.8519.01A.11R.2404.07","TCGA.IB.7885.01A.11R.2156.07","TCGA.US.A774.01A.21R.A32O.07","TCGA.S4.A8RM.01A.11R.A37L.07","TCGA.2J.AABA.01A.21R.A41B.07","TCGA.M8.A5N4.01A.11R.A26U.07","TCGA.2L.AAQL.01A.11R.A38C.07","TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA.IB.7645.01A.22R.2204.07","TCGA.2J.AABU.01A.11R.A41B.07","TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA.IB.AAUR.01A.21R.A38C.07","TCGA.IB.7887.01A.11R.2156.07","TCGA.IB.7893.01A.11R.2204.07","TCGA.2J.AABF.01A.31R.A41B.07","TCGA.HV.AA8V.01A.11R.A41B.07","TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA.IB.7888.01A.11R.2156.07","TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA.2J.AAB9.01A.11R.A41B.07","TCGA.IB.A6UF.01A.23R.A33R.07","TCGA.HV.A5A3.01A.11R.A26U.07","TCGA.S4.A8RP.01A.11R.A36G.07","TCGA.F2.A7TX.01A.33R.A38C.07","TCGA.HV.A7OL.01A.11R.A33R.07","TCGA.HZ.A49H.01A.11R.A26U.07","TCGA.XN.A8T5.01A.12R.A36G.07","TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA.LB.A7SX.01A.11R.A33R.07","TCGA.RB.A7B8.01A.12R.A33R.07","TCGA.XD.AAUI.01A.42R.A41B.07","TCGA.2J.AABH.01A.21R.A41B.07","TCGA.IB.AAUP.01A.11R.A37L.07","TCGA.3A.A9IB.01A.21R.A39D.07","TCGA.IB.AAUT.01A.11R.A37L.07","TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA.2J.AABK.01A.31R.A41B.07","TCGA.IB.AAUM.01A.11R.A37L.07","TCGA.FB.A4P6.01A.12R.A26U.07","TCGA.3A.A9IC.01A.11R.A38C.07","TCGA.FB.AAPU.01A.31R.A41B.07","TCGA.2L.AAQI.01A.12R.A39D.07","TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA.HZ.8317.01A.11R.2404.07","TCGA.IB.7897.01A.21R.2204.07","TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA.2L.AAQE.01A.11R.A39D.07","TCGA.HZ.A77P.01A.11R.A33R.07","TCGA.IB.A7LX.01A.12R.A36G.07","TCGA.2J.AAB4.01A.12R.A41B.07","TCGA.2J.AABT.01A.11R.A41B.07","TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA.HZ.8315.01A.11R.2404.07","TCGA.XD.AAUG.01A.61R.A41B.07","TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA.IB.7652.01A.11R.2156.07","TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA.HV.A5A4.01A.11R.A26U.07","TCGA.IB.7890.01A.12R.2204.07","TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA.IB.7644.01A.11R.2156.07","TCGA.IB.A5SO.01A.11R.A32O.07","TCGA.2J.AABI.01A.12R.A41B.07","TCGA.2J.AABO.01A.21R.A41B.07","TCGA.US.A779.01A.11R.A32O.07","TCGA.3A.A9IH.01A.12R.A39D.07","TCGA.HZ.7919.01A.11R.2156.07","TCGA.HV.A5A6.01A.11R.A26U.07","TCGA.YH.A8SY.01A.11R.A37L.07","TCGA.F2.6879.01A.11R.2156.07","TCGA.3A.A9IU.01A.11R.A39D.07","TCGA.HV.AA8X.01A.11R.A39D.07","TCGA.IB.8127.01A.11R.2404.07","TCGA.FB.AAPS.01A.12R.A39D.07","TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA.US.A77E.01A.11R.A32O.07","TCGA.F2.A44H.01A.11R.A26U.07","TCGA.3A.A9I5.01A.11R.A38C.07","TCGA.RB.AA9M.01A.11R.A39D.07","TCGA.FB.A545.01A.11R.A26U.07","TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA.IB.8126.01A.11R.2404.07","TCGA.IB.A5SP.01A.11R.A32O.07","TCGA.HZ.8001.01A.11R.2204.07","TCGA.2J.AABE.01A.12R.A41B.07","TCGA.IB.AAUN.01A.12R.A38C.07","TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA.2J.AABV.01A.12R.A41B.07","TCGA.XN.A8T3.01A.11R.A36G.07","TCGA.OE.A75W.01A.12R.A32O.07","TCGA.LB.A8F3.01A.11R.A36G.07","TCGA.HZ.8636.01A.21R.2404.07","TCGA.XD.AAUL.01A.21R.A39D.07","TCGA.3A.A9I7.01A.21R.A38C.07","TCGA.US.A776.01A.13R.A33R.07","TCGA.IB.A7M4.01A.11R.A36G.07","TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA.2L.AAQA.01A.21R.A38C.07","TCGA.IB.7889.01A.11R.2156.07","TCGA.F2.A8YN.01A.11R.A37L.07","TCGA.YB.A89D.01A.12R.A36G.07","TCGA.IB.A6UG.01A.32R.A33R.07","TCGA.FB.AAPY.01A.11R.A41B.07","TCGA.S4.A8RO.01A.12R.A37L.07","TCGA.HZ.8637.01A.11R.2404.07","TCGA.2J.AAB6.01A.11R.A41B.07","TCGA.IB.7886.01A.11R.2156.07","TCGA.H6.8124.01A.11R.2404.07","TCGA.IB.7891.01A.11R.2204.07","TCGA.HZ.7926.01A.11R.2156.07","TCGA.IB.7646.01A.11R.2156.07","TCGA.2J.AABR.01A.11R.A41B.07","TCGA.3A.A9J0.01A.11R.A41B.07","TCGA.IB.7651.01A.11R.2156.07","TCGA.IB.AAUU.01A.11R.A37L.07","TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA.IB.AAUS.01A.12R.A38C.07","TCGA.F2.A44G.01A.11R.A26U.07","TCGA.3A.A9IX.01A.11R.A41B.07","TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA.US.A77G.01A.11R.A32O.07","TCGA.HZ.8005.01A.11R.2204.07","TCGA.2J.AAB8.01A.12R.A41B.07","TCGA.YY.A8LH.01A.11R.A36G.07","TCGA.HZ.A49G.01A.11R.A26U.07","TCGA.FB.A5VM.01A.11R.A32O.07","TCGA.IB.7649.01A.11R.2156.07","TCGA.HZ.7925.01A.11R.2156.07","TCGA.FB.A78T.01A.12R.A32O.07","TCGA.HZ.7922.01A.11R.2156.07","TCGA.HZ.A77O.01A.11R.A33R.07","TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA.IB.A5ST.01A.11R.A32O.07","TCGA.XD.AAUH.01A.42R.A41B.07","TCGA.HZ.8003.01A.21R.2204.07","TCGA.HV.A5A5.01A.11R.A26U.07","TCGA.IB.A5SS.01A.11R.A32O.07","TCGA.HZ.A49I.01A.12R.A26U.07","TCGA.HZ.8002.01A.11R.2204.07","TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA.FB.A4P5.01A.11R.A26U.07","TCGA.2J.AAB1.01A.11R.A41B.07","TCGA.3E.AAAY.01A.11R.A38C.07","TCGA.L1.A7W4.01A.12R.A36G.07","TCGA.H6.A45N.01A.11R.A26U.07","TCGA.FB.AAQ0.01A.31R.A41B.07","CCR170012_MH17T001P013"],"y":[49.71709,49.871904,89.735899,72.333279,55.785132,53.15632,34.767934,41.888616,38.020515,23.953413,53.776162,20.245839,27.299439,45.81506,49.984271,65.950777,68.886598,60.676457,51.798556,31.336701,41.275362,58.582898,22.725468,49.014981,30.474143,41.158282,52.8434,41.883276,46.275197,37.608052,48.650568,49.489457,44.321305,45.875146,57.600007,52.174846,59.840559,39.36697,37.672565,55.899282,48.713063,31.060244,51.225138,64.69739,47.452335,45.913311,59.565076,58.721218,39.004995,47.234326,62.467713,50.81768,53.143953,37.606251,40.512887,64.686632,37.021154,47.835093,84.140103,40.400133,42.29014,46.091634,47.538056,71.474973,62.809925,64.64856,29.471088,45.709749,60.503631,55.369723,42.619795,46.206961,73.211907,54.774916,51.567393,88.228854,38.867053,35.884763,53.257754,25.794336,42.008422,48.668784,29.955362,33.540355,58.230304,46.502731,62.417312,36.769016,42.3928,49.455822,40.220853,43.640349,49.666696,53.222602,69.034627,55.632903,56.131479,50.87558,45.478532,31.501093,57.259817,59.698983,46.436907,45.068874,50.817024,46.429419,43.938885,74.944992,41.449837,60.329388,58.235276,57.932988,73.425686,48.149376,35.681497,45.743332,82.820778,51.426626,39.572379,50.2093,42.583256,59.002121,62.904824,37.894106,47.58145,56.478293,23.337484,50.763706,42.673709,47.583843,35.565217,79.138298,57.807798,55.857645,49.050726,50.625539,52.026291,41.150984,67.147381,40.807003,63.026591,41.532516,59.224066,43.363615,30.479071,46.885604,46.204476,52.330565,28.333706,40.022344,39.941856],"type":"bar","name":"PDAC","marker":{"color":"rgba(0,191,255,1)","line":{"color":"rgba(0,191,255,1)"}},"textfont":{"color":"rgba(0,191,255,1)"},"error_y":{"color":"rgba(0,191,255,1)"},"error_x":{"color":"rgba(0,191,255,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save the bar-plot as html (PLOTLY)
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_RNAseq_libSize_targets.html"), selfcontained = TRUE)

##### Detach plotly package. Otherwise it clashes with other graphics devices
detach("package:plotly", unload=FALSE)
```

## Data transformation and filtering

For differential expression and related analyses, gene expression is rarely considered at the level of raw counts since libraries sequenced at a greater depth will result in higher counts. Rather, it is common practice to transform raw counts onto a scale that accounts for such library size differences. Here we convert the read count data into log2-counts per million (***log-CPM***) using function from *[edgeR](https://bioconductor.org/packages/release/bioc/html/edgeR.html)* package. Genes with very low counts across all libraries provide little evidence for differential expression. In the biological point of view, a gene must be expressed at some minimal level before it is likely to be translated into a protein or to be biologically important. In addition, the pronounced discretenes of these counts interferes with some of the statistical approximations that are used later in the pipeline. These genes should be filtered out prior to further analysis.


```r
##### Create EdgeR DGEList object
y <- DGEList(counts=datasets,  group=targetFile$Target)

##### Add datasets name for each sample
y$samples$dataset <- targetFile$Dataset

##### Filtering to remove low expressed genes. Users should filter with CPM rather than filtering on the counts directly, as the latter does not account for differences in library sizes between samples. Here we keep only genes that have CPM of 1
cat("The CPM of 1 (cut-off for removing low expressed genes) corresponds to", round(min(as.numeric(colSums(datasets)*1e-6)), digits=0), "reads in sample with the lowest sequencing depth, and", round(max(as.numeric(colSums(datasets)*1e-6)), digits=0), "reads in sample with the greatest sequencing depth\n")
```

```
The CPM of 1 (cut-off for removing low expressed genes) corresponds to 20 reads in sample with the lowest sequencing depth, and 90 reads in sample with the greatest sequencing depth
```

```r
keep <- rowSums(cpm(y)>1) >= ncol(datasets)/10
y.filtered <- y[keep, , keep.lib.sizes=FALSE]

cat(nrow(y.filtered$counts), "genes remained after filtering out of the", nrow(datasets), "genes in the input read count matrix\n\n")
```

```
18146 genes remained after filtering out of the 54516 genes in the input read count matrix
```

```r
##### Transformations from the raw-scale to CPM. Add small offset to each observation to avoid taking log of zero
y.cpm <- cpm(y, normalized.lib.sizes=TRUE, log=TRUE, prior.count=0.25)
y.filtered.cpm <- cpm(y.filtered, normalized.lib.sizes=TRUE, log=TRUE, prior.count=0.25)
```

Show the data distribution before and after low expressed genes filtering.


```r
par(mfrow=c(1,2))

##### Before filtering
plot(density(y.cpm[,1]), lwd=2, ylim=c(0,0.25), las=2, main="", xlab="", col=datasets.colour[[2]][1])
title(main="Raw data", xlab="Log-cpm")
abline(v=0, lty=3)

for (i in 2:ncol(y.cpm)){
  den <- density(y.cpm[,i])
  lines(den$x, den$y, lwd=2, col=datasets.colour[[2]][i])
}
legend("topright", levels(targetFile$Dataset), fill=datasets.colour[[1]], bty="n")

##### After filtering
plot(density(y.filtered.cpm[,1]), lwd=2, ylim=c(0,0.25), las=2, main="", xlab="", col=datasets.colour[[2]][1])
title(main="Filtered data", xlab="Log-cpm")
abline(v=0, lty=3)

for (i in 2:ncol(y.filtered.cpm)){
  den <- density(y.filtered.cpm[,i])
  lines(den$x, den$y, lwd=2, col=datasets.colour[[2]][i])
}
legend("topright", levels(targetFile$Dataset), fill=datasets.colour[[1]], bty="n")
```

![](/Users/jmarzec/Documents/GitHub/UMCCR/RNA-seq-analysis/readcount-analysis/Combined_data/Datasets_list.txt.combineExprData_files/figure-html/data_transformation_plot-1.png)<!-- -->

```r
invisible(dev.off())

##### Save the plot as pdf file
pdf(paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_filtering.pdf"), width=8, height=5)
par(mfrow=c(1,2))

##### Before filtering
plot(density(y.cpm[,1]), lwd=2, ylim=c(0,0.25), las=2, main="", xlab="", col=datasets.colour[[2]][1])
title(main="Raw data", xlab="Log-cpm")
abline(v=0, lty=3)

for (i in 2:ncol(y.cpm)){
  den <- density(y.cpm[,i])
  lines(den$x, den$y, lwd=2, col=datasets.colour[[2]][i])
}
legend("topright", levels(targetFile$Dataset), fill=datasets.colour[[1]], bty="n")

##### After filtering
plot(density(y.filtered.cpm[,1]), lwd=2, ylim=c(0,0.25), las=2, main="", xlab="", col=datasets.colour[[2]][1])
title(main="Filtered data", xlab="Log-cpm")
abline(v=0, lty=3)

for (i in 2:ncol(y.filtered.cpm)){
  den <- density(y.filtered.cpm[,i])
  lines(den$x, den$y, lwd=2, col=datasets.colour[[2]][i])
}
legend("topright", levels(targetFile$Dataset), fill=datasets.colour[[1]], bty="n")
invisible(dev.off())
```

## Data normalisation {.tabset}

During the sample preparation or sequencing process, external factors that are not of biological interest can affect the expression of individual samples. For example, samples processed in the first batch of an experiment can have higher expression overall when compared to samples processed in a second batch. It is assumed that all samples should have a similar range and distribution of expression values. Normalisation for sample-specific effectss is required to ensure that the expression distributions of each sample are similar across the entire experiment. Normalisation by the method of *[trimmed mean of M-values](https://www.ncbi.nlm.nih.gov/pubmed/20196867) (TMM)* is performed using the *calcNormFactors* function in *[edgeR](https://bioconductor.org/packages/release/bioc/html/edgeR.html)*. The normalisation factors calculated here are used as a scaling factor for the library sizes. TMM is the recommended for most RNA-Seq data where the majority (more than half) of the genes are believed not differentially expressed between any pair of the samples.

### Unnormalised vs normalised cpm data

Box-plots of log-cpm for individual samples, coloured by dataset, before and after TMM normalisation.


```r
##### Adjust for RNA composition effect. Calculate scaling factors for the library sizes with calcNormFactors function using trimmed mean of M-values (TMM) between each pair of samples. Note, that the raw read counts are used to calculate the normalisation factors
y.norm <- calcNormFactors(y.filtered, method = "TMM")

##### Transformations from the raw-scale to CPM
y.norm.cpm <- cpm(y.norm, normalized.lib.sizes=TRUE, log=TRUE, prior.count=0.25)

##### Plot expression distribution of samples for unnormalised and normalised data
par(mfrow=c(2,1), mar=c(2, 5, 3, 2))
##### Unnormalised cpm data
boxplot(y.filtered.cpm, las=2, col=datasets.colour[[2]], main="", pch=".", las=3, xaxt="n")
title(main="Unnormalised data", ylab="Log-cpm")
legend("topright", levels(targetFile$Dataset), fill=datasets.colour[[1]], horiz=TRUE, bg="white", box.col="transparent")

##### Normalised cpm data
boxplot(y.norm.cpm, las=2, col=datasets.colour[[2]], main="", pch=".", las=3, xaxt="n")
title(main="Normalised data (TMM)", ylab="Log-cpm")
legend("topright", levels(targetFile$Dataset), fill=datasets.colour[[1]], horiz=TRUE, bg="white", box.col="transparent")
```

![](/Users/jmarzec/Documents/GitHub/UMCCR/RNA-seq-analysis/readcount-analysis/Combined_data/Datasets_list.txt.combineExprData_files/figure-html/data_normalisation_unnorm_vs_nomm-1.png)<!-- -->

```r
invisible(dev.off())


##### Save the plot as pdf file
pdf(paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_normalisation.pdf"), width=8, height=8)
par(mfrow=c(2,1), mar=c(2, 5, 3, 2))

##### Unnormalised cpm data
boxplot(y.filtered.cpm, las=2, col=datasets.colour[[2]], main="", pch=".", las=3, xaxt="n")
title(main="Unnormalised data", ylab="Log-cpm")
legend("topright", levels(targetFile$Dataset), fill=datasets.colour[[1]], horiz=TRUE, bg="white", box.col="transparent")

##### Normalised cpm data
boxplot(y.norm.cpm, las=2, col=datasets.colour[[2]], main="", pch=".", las=3, xaxt="n")
title(main="Normalised data (TMM)", ylab="Log-cpm")
legend("topright", levels(targetFile$Dataset), fill=datasets.colour[[1]], horiz=TRUE, bg="white", box.col="transparent")
invisible(dev.off())

# #######################################################
# ##### Prepare expression data frame for plotting in plotly by adding samples annotation and converting the matrix into two column data frame
# ##### Un-normalised cpm data
# y.filtered.cpm.df <- as.data.frame(cbind(rep(rownames(y.filtered.cpm), ncol(y.filtered.cpm)), rep(colnames(y.filtered.cpm), each=nrow(y.filtered.cpm)), rep(as.vector(y.filtered$samples$group), each=nrow(y.filtered.cpm)), as.numeric(y.filtered.cpm)))
# colnames(y.filtered.cpm.df) <- c("Gene", "Sample", "Group", "cpm")
# 
# ##### Normalised cpm data
# y.norm.cpm.df <- as.data.frame(cbind(rep(rownames(y.norm.cpm), ncol(y.norm.cpm)), rep(colnames(y.norm.cpm), each=nrow(y.norm.cpm)), rep(as.vector(y.norm$samples$group), each=nrow(y.norm.cpm)), as.numeric(y.norm.cpm)))
# colnames(y.norm.cpm.df) <- c("Gene", "Sample", "Group", "cpm")
# 
# 
# p <- plot_ly(width = 800, height = 600) 
# 
# for ( i in 1:12 ) {
#  p <- add_trace(p, y = y.filtered.cpm[,i], type = 'box', name = colnames(y.filtered.cpm)[i], jitter = 0.3, pointpos = 0, boxpoints = 'outliers',
#         marker = list(color = 'rgb(9,56,125)'),
#         line = list(color = 'rgb(9,56,125)'),
#         showlegend=FALSE)
#   }
# 
# ##### Save the box-plot as html
# htmlwidgets::saveWidget(as_widget(p), paste0(paste(datasetIDs, collapse="_"),"_normalisation.html"), selfcontained = TRUE)
# #######################################################
```

### Mean-difference plot

The performance of the *TMM* normalisation procedure can be examined using mean-difference
(MD) plots. This visualizes the *library size-adjusted log-fold change* between two libraries (the
difference) against the *average log-expression* across those libraries (the mean). Each MD
plot is generated by comparing one sample against an artificial library constructed from the average
of all other samples. Ideally, the bulk of genes should be centred at a log-fold change of zero. This indicates that
any composition bias between libraries has been successfully removed. The MD plots for all samples are saved in the *`[datasets`] MD_plots* directory.


```r
##### Generate MD plot for the random 2 samples in each dataset (or 1 if 2 not available)
par(mfrow=c(length(datasetIDs),2), mar=c(2, 5, 3, 2))

for (dataset in datasetIDs ) {
  
  ##### Get sample names for each dataset
  samples <- rownames(targetFile[ targetFile$Dataset == dataset, ])
  
  ##### Select random 2 samples (or 1 if 2 not available)
  if ( length(samples) >= 2 ) {
    samples <- samples[ sample(1:length(samples), 2, replace=FALSE) ]
  } else {
     samples <- samples[ sample(1:length(samples), length(samples), replace=FALSE) ]
  }
  
  for ( sample in samples ) {
  
    plotMD(y.filtered.cpm, column=match(sample, colnames(y.filtered.cpm)))
    abline(h=0, col="red", lty=2, lwd=2)
  }

}
```

![](/Users/jmarzec/Documents/GitHub/UMCCR/RNA-seq-analysis/readcount-analysis/Combined_data/Datasets_list.txt.combineExprData_files/figure-html/md_plot-1.png)<!-- -->

```r
invisible(dev.off())


##### Create directory for pdf files
MDplotsDir <- paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"), "_MD_plots")

if ( !file.exists(MDplotsDir) ){
  dir.create(MDplotsDir, recursive=TRUE)
}

##### Save the plot as pdf file for each sample
for ( sample in colnames(y.filtered.cpm) ) {

  pdf(paste0(MDplotsDir, "/", sample, "_MDplot.pdf"), width=6, height=5)
  plotMD(y.filtered.cpm, column=match(sample, colnames(y.filtered.cpm)), xlim=c(-10,15), ylim=c(-10,10))
  abline(h=0, col="red", lty=2, lwd=2)
  invisible(dev.off())
}
```

### Scaling factor (datasets)

Library sizes of individaul samples plotted against corresponsing scaling factors. The colours indicate datasets.


```r
suppressMessages(library(plotly))

##### Plot the library sizes for individaul samples against corresponsing scaling factors
p <- plot_ly(y.norm$samples[, c("norm.factors", "lib.size", "dataset")], x = ~norm.factors, y = ~lib.size, text= ~rownames(y$samples), type='scatter', color = ~factor(dataset), colors = datasets.colour[[1]], mode = "markers", marker = list(size=6, symbol="circle"), width = 600, height = 400) %>%
  layout(title = "", xaxis = list(title = "Scaling factor"), yaxis = list(title = "Library size"), margin = list(l=50, r=50, b=50, t=20, pad=4), autosize = F, showlegend = TRUE)

##### Print htmlwidget
p
```

<!--html_preserve--><div id="htmlwidget-5757eeb066af73d9f678" style="width:600px;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5757eeb066af73d9f678">{"x":{"visdat":{"1c2553a5f921":["function () ","plotlyVisDat"]},"cur_data":"1c2553a5f921","attrs":{"1c2553a5f921":{"x":{},"y":{},"text":{},"mode":"markers","marker":{"size":6,"symbol":"circle"},"color":{},"colors":["dodgerblue","firebrick"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":600,"height":400,"margin":{"b":50,"l":50,"t":20,"r":50,"pad":4},"title":"","xaxis":{"domain":[0,1],"automargin":true,"title":"Scaling factor"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Library size"},"autosize":false,"showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1.01197714686312,0.90697092432366,1.18298470786987,0.985952831135258,1.05293006898922,1.08885081168171,1.10242808020727,0.91202881064863,1.1138019797031,0.956931383723968,0.990149233061622,1.01367031928384,1.06669599948057,1.0071307539804,0.956066613264019,0.887796292558425,1.13752455779191,1.12552460007068,1.00003772551884,0.831742608035453,1.20566158284836,0.985785287482931,0.98361753891839,1.05805304572865,1.05990228127501,0.955752419586193,0.992670321157144,1.03772296044216,0.966947815599343,1.23423965643551,1.0145954217942,0.876227754473111,0.984793800661606,1.11030545416885,0.971268552567552,1.11542645400928,0.937987162037589,0.966122988919013,1.11322623976317,0.950876775421129,0.871722294277497,1.12115528901966,0.971326168142855,1.07824193504382,1.11392487516666,1.08955222042997,0.769004202605627,1.23682300633518,0.93456821151661,0.884305170631442,1.0681321484878,1.14051554489549,0.855962026327431,1.22168590181534,0.968309543364477,1.05109972315868,1.03246335391997,1.02954999648777,1.08183898090178,0.913715116777686,0.978570154482675,0.655646382432621,1.15367493721086,0.991677588834654,1.04951982120114,1.06367361964659,0.962215463769261,1.09917101169971,0.963085395130119,0.964966328189611,0.992409459583742,1.0291364278583,0.989535716770051,1.03496592002113,1.01341179086346,1.03612636621364,1.11949726946258,1.02769135894106,0.858924069228511,1.02410250247336,0.996427855375623,1.01675178697428,1.16102499478675,0.952877903913208,0.880037752623744,1.03086552069282,0.836485832618147,0.985961597001389,1.21368393390621,0.558611020028133,1.09601805502911,0.989288611247593,0.687656915832988,0.956583857740929,1.01934452972203,1.00168823272945,1.05882007734828,1.03410602164693,1.03996325393453,0.922863636307698,0.354234450597673,1.12711122047811,0.955634581677806,0.834913091734766,1.18740955539719,1.02463208596482,0.983035059177656,1.03720212543151,0.915550501477758,1.01894165498722,0.941544498153939,1.00687744203917,1.01035054067745,0.945738248911504,1.03449313656736,0.888541033780598,0.915826259748987,1.01159828506784,1.07698398802853,1.20596046805598,0.904283346209843,1.03466061638472,1.02875210290388,0.980458194070575,1.17355733829493,1.05539110933901,0.9193708558455,1.11485943811637,0.95950430887179,1.04061865640035,1.09526921211253,0.957485987344484,0.969643638226502,1.00447803267431,1.07016022367271,1.02598545311688,1.06112801508858,1.05301784280664,0.873521923922658,1.09456489102372,1.07428298795204,1.03754785224218,1.10017081296418,0.980973809164385,1.00797093692661,0.922359199592749,1.0557847071966,0.979757401868597,0.881289822341895,1.00232223886952,1.06547324418421,1.16416329646408,0.721225426954438,1.08352440242098,0.920102461386147,1.09353574950317,1.09387768275128,1.21373909613041,0.949609209095687,1.13225230657786,1.02500310613345,1.1629076120384,1.01451039963986,1.19639185220693,0.955915172401135],"y":[49606961,49796878,89491251,72246664,55702426,53028984,56311230,45312492,34703945,41826759,37968879,23918373,53696563,20214768,40250678,27261017,45737211,49858855,65860353,68817883,60559036,46668330,51716783,31290873,41208538,58508494,22696522,48920327,30422453,41063147,52782398,41823951,46201322,37534574,48581531,49300787,50166589,44248329,45797028,57519334,50267684,52051354,59756004,39293420,37561821,55764650,48636026,30992933,51155421,64607342,47378455,45832246,59470818,58575232,38938451,47169030,62340760,50702563,53055963,30572768,37536000,40474654,64556704,36955515,47763797,84027842,40343401,42220050,46036853,47424619,71393146,62703887,64486662,29426373,45635292,60420839,55296167,42547315,46139357,73107250,54693722,51496012,88084463,38793639,35838689,53174462,25763063,41930014,48582534,33396840,29899521,33483512,58150124,46437484,52435951,62315342,36712226,45091525,42327019,49396537,40192992,43557389,49582398,53141638,68890557,55556370,40289443,55959315,50673209,45405622,31452023,57153825,59620597,46374315,45003406,49881400,50731954,46348981,43864694,74744706,41392949,60242376,58130034,57853112,36053556,73309451,48060970,35623913,45678332,82696572,51347074,39502958,50129266,42507803,58905440,62787548,37819813,47497685,56392717,23283289,41790617,50671397,42597099,47501948,35503100,79046121,57701165,55788375,48991401,50550958,51927623,41058299,67060840,40742932,62960024,41453529,61540354,59124535,43304124,30418117,46826027,46113636,52211123,28275676,39945894],"text":["TCGA.IB.AAUO.01A.12R.A38C.07","TCGA.3A.A9I9.01A.11R.A38C.07","TCGA.HZ.8519.01A.11R.2404.07","TCGA.IB.7885.01A.11R.2156.07","TCGA.US.A774.01A.21R.A32O.07","TCGA.S4.A8RM.01A.11R.A37L.07","TCGA.3A.A9IR.01A.11R.A38C.07","TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA.2J.AABA.01A.21R.A41B.07","TCGA.M8.A5N4.01A.11R.A26U.07","TCGA.2L.AAQL.01A.11R.A38C.07","TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA.IB.7645.01A.22R.2204.07","TCGA.2J.AABU.01A.11R.A41B.07","TCGA.3A.A9IV.01A.11R.A41B.07","TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA.IB.AAUR.01A.21R.A38C.07","TCGA.IB.7887.01A.11R.2156.07","TCGA.IB.7893.01A.11R.2204.07","TCGA.2J.AABF.01A.31R.A41B.07","TCGA.3A.A9IN.01A.11R.A39D.07","TCGA.HV.AA8V.01A.11R.A41B.07","TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA.IB.7888.01A.11R.2156.07","TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA.2J.AAB9.01A.11R.A41B.07","TCGA.IB.A6UF.01A.23R.A33R.07","TCGA.HV.A5A3.01A.11R.A26U.07","TCGA.S4.A8RP.01A.11R.A36G.07","TCGA.F2.A7TX.01A.33R.A38C.07","TCGA.HV.A7OL.01A.11R.A33R.07","TCGA.HZ.A49H.01A.11R.A26U.07","TCGA.XN.A8T5.01A.12R.A36G.07","TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA.LB.A7SX.01A.11R.A33R.07","TCGA.YB.A89D.11A.11R.A36G.07","TCGA.RB.A7B8.01A.12R.A33R.07","TCGA.XD.AAUI.01A.42R.A41B.07","TCGA.2J.AABH.01A.21R.A41B.07","TCGA.3A.A9IO.01A.11R.A38C.07","TCGA.IB.AAUP.01A.11R.A37L.07","TCGA.3A.A9IB.01A.21R.A39D.07","TCGA.IB.AAUT.01A.11R.A37L.07","TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA.2J.AABK.01A.31R.A41B.07","TCGA.IB.AAUM.01A.11R.A37L.07","TCGA.FB.A4P6.01A.12R.A26U.07","TCGA.3A.A9IC.01A.11R.A38C.07","TCGA.FB.AAPU.01A.31R.A41B.07","TCGA.2L.AAQI.01A.12R.A39D.07","TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA.HZ.8317.01A.11R.2404.07","TCGA.IB.7897.01A.21R.2204.07","TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA.2L.AAQE.01A.11R.A39D.07","TCGA.HZ.A77P.01A.11R.A33R.07","TCGA.IB.A7LX.01A.12R.A36G.07","TCGA.2J.AAB4.01A.12R.A41B.07","TCGA.FB.AAPP.01A.12R.A41B.07","TCGA.2J.AABT.01A.11R.A41B.07","TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA.HZ.8315.01A.11R.2404.07","TCGA.XD.AAUG.01A.61R.A41B.07","TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA.IB.7652.01A.11R.2156.07","TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA.HV.A5A4.01A.11R.A26U.07","TCGA.IB.7890.01A.12R.2204.07","TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA.IB.7644.01A.11R.2156.07","TCGA.IB.A5SO.01A.11R.A32O.07","TCGA.2J.AABI.01A.12R.A41B.07","TCGA.2J.AABO.01A.21R.A41B.07","TCGA.US.A779.01A.11R.A32O.07","TCGA.3A.A9IH.01A.12R.A39D.07","TCGA.HZ.7919.01A.11R.2156.07","TCGA.HV.A5A6.01A.11R.A26U.07","TCGA.YH.A8SY.01A.11R.A37L.07","TCGA.F2.6879.01A.11R.2156.07","TCGA.3A.A9IU.01A.11R.A39D.07","TCGA.HV.AA8X.01A.11R.A39D.07","TCGA.IB.8127.01A.11R.2404.07","TCGA.FB.AAPS.01A.12R.A39D.07","TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA.US.A77E.01A.11R.A32O.07","TCGA.F2.A44H.01A.11R.A26U.07","TCGA.3A.A9I5.01A.11R.A38C.07","TCGA.RB.AA9M.01A.11R.A39D.07","TCGA.HV.A7OP.01A.11R.A33R.07","TCGA.FB.A545.01A.11R.A26U.07","TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA.IB.8126.01A.11R.2404.07","TCGA.IB.A5SP.01A.11R.A32O.07","TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA.HZ.8001.01A.11R.2204.07","TCGA.2J.AABE.01A.12R.A41B.07","TCGA.3A.A9IL.01A.11R.A38C.07","TCGA.IB.AAUN.01A.12R.A38C.07","TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA.2J.AABV.01A.12R.A41B.07","TCGA.XN.A8T3.01A.11R.A36G.07","TCGA.OE.A75W.01A.12R.A32O.07","TCGA.LB.A8F3.01A.11R.A36G.07","TCGA.HZ.8636.01A.21R.2404.07","TCGA.XD.AAUL.01A.21R.A39D.07","TCGA.2L.AAQM.01A.11R.A39D.07","TCGA.3A.A9I7.01A.21R.A38C.07","TCGA.US.A776.01A.13R.A33R.07","TCGA.IB.A7M4.01A.11R.A36G.07","TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA.2L.AAQA.01A.21R.A38C.07","TCGA.IB.7889.01A.11R.2156.07","TCGA.F2.A8YN.01A.11R.A37L.07","TCGA.YB.A89D.01A.12R.A36G.07","TCGA.3A.A9IS.01A.21R.A39D.07","TCGA.IB.A6UG.01A.32R.A33R.07","TCGA.FB.AAPY.01A.11R.A41B.07","TCGA.S4.A8RO.01A.12R.A37L.07","TCGA.HZ.8637.01A.11R.2404.07","TCGA.2J.AAB6.01A.11R.A41B.07","TCGA.IB.7886.01A.11R.2156.07","TCGA.H6.8124.01A.11R.2404.07","TCGA.IB.7891.01A.11R.2204.07","TCGA.H6.A45N.11A.12R.A26U.07","TCGA.HZ.7926.01A.11R.2156.07","TCGA.IB.7646.01A.11R.2156.07","TCGA.2J.AABR.01A.11R.A41B.07","TCGA.3A.A9J0.01A.11R.A41B.07","TCGA.IB.7651.01A.11R.2156.07","TCGA.IB.AAUU.01A.11R.A37L.07","TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA.IB.AAUS.01A.12R.A38C.07","TCGA.F2.A44G.01A.11R.A26U.07","TCGA.3A.A9IX.01A.11R.A41B.07","TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA.US.A77G.01A.11R.A32O.07","TCGA.HZ.8005.01A.11R.2204.07","TCGA.2J.AAB8.01A.12R.A41B.07","TCGA.HV.A5A3.11A.11R.A26U.07","TCGA.YY.A8LH.01A.11R.A36G.07","TCGA.HZ.A49G.01A.11R.A26U.07","TCGA.FB.A5VM.01A.11R.A32O.07","TCGA.IB.7649.01A.11R.2156.07","TCGA.HZ.7925.01A.11R.2156.07","TCGA.FB.A78T.01A.12R.A32O.07","TCGA.HZ.7922.01A.11R.2156.07","TCGA.HZ.A77O.01A.11R.A33R.07","TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA.IB.A5ST.01A.11R.A32O.07","TCGA.XD.AAUH.01A.42R.A41B.07","TCGA.HZ.8003.01A.21R.2204.07","TCGA.HV.A5A5.01A.11R.A26U.07","TCGA.IB.A5SS.01A.11R.A32O.07","TCGA.HZ.A49I.01A.12R.A26U.07","TCGA.H6.8124.11A.01R.2404.07","TCGA.HZ.8002.01A.11R.2204.07","TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA.FB.A4P5.01A.11R.A26U.07","TCGA.2J.AAB1.01A.11R.A41B.07","TCGA.3E.AAAY.01A.11R.A38C.07","TCGA.L1.A7W4.01A.12R.A36G.07","TCGA.H6.A45N.01A.11R.A26U.07","TCGA.FB.AAQ0.01A.31R.A41B.07"],"mode":"markers","marker":{"color":"rgba(30,144,255,1)","size":6,"symbol":"circle","line":{"color":"rgba(30,144,255,1)"}},"type":"scatter","name":"TCGA-PAAD","textfont":{"color":"rgba(30,144,255,1)"},"error_y":{"color":"rgba(30,144,255,1)"},"error_x":{"color":"rgba(30,144,255,1)"},"line":{"color":"rgba(30,144,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.09282110294379,0.849752512722496],"y":[29316953,36658009],"text":["CCR170093_RNA_WPT_013","CCR170012_MH17T001P013"],"mode":"markers","marker":{"color":"rgba(178,34,34,1)","size":6,"symbol":"circle","line":{"color":"rgba(178,34,34,1)"}},"type":"scatter","name":"Avner","textfont":{"color":"rgba(178,34,34,1)"},"error_y":{"color":"rgba(178,34,34,1)"},"error_x":{"color":"rgba(178,34,34,1)"},"line":{"color":"rgba(178,34,34,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save the scatter-plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_scaling_factor_datasets.html"), selfcontained = TRUE)
```

### Scaling factor (targets)

Library sizes of individaul samples plotted against corresponsing scaling factors. The colours indicate sample groups (e.g. biological groups), as provided in *Target* column in the target files.


```r
##### Plot the library sizes for individaul samples against corresponsing scaling factors
p <- plot_ly(y.norm$samples[, c("norm.factors", "lib.size", "group")], x = ~norm.factors, y = ~lib.size, text= ~rownames(y$samples), type='scatter', color = ~factor(group), colors = targets.colour[[1]], mode = "markers", marker = list(size=6, symbol="circle"), width = 600, height = 400) %>%
  layout(title = "", xaxis = list(title = "Scaling factor"), yaxis = list(title = "Library size"), margin = list(l=50, r=50, b=50, t=20, pad=4), autosize = F, showlegend = TRUE)

##### Print htmlwidget
p
```

<!--html_preserve--><div id="htmlwidget-06276f50880d67b398a0" style="width:600px;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-06276f50880d67b398a0">{"x":{"visdat":{"1c257dbd8897":["function () ","plotlyVisDat"]},"cur_data":"1c257dbd8897","attrs":{"1c257dbd8897":{"x":{},"y":{},"text":{},"mode":"markers","marker":{"size":6,"symbol":"circle"},"color":{},"colors":["red","blue","green","darkgoldenrod","darkred","deepskyblue"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":600,"height":400,"margin":{"b":50,"l":50,"t":20,"r":50,"pad":4},"title":"","xaxis":{"domain":[0,1],"automargin":true,"title":"Scaling factor"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Library size"},"autosize":false,"showlegend":true,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[0.913715116777686,0.558611020028133],"y":[30572768,33396840],"text":["TCGA.FB.AAPP.01A.12R.A41B.07","TCGA.HV.A7OP.01A.11R.A33R.07"],"mode":"markers","marker":{"color":"rgba(255,0,0,1)","size":6,"symbol":"circle","line":{"color":"rgba(255,0,0,1)"}},"type":"scatter","name":"IPMN","textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.01934452972203],"y":[52435951],"text":"TCGA.HZ.A9TJ.06A.11R.A41B.07","mode":"markers","marker":{"color":"rgba(0,0,255,1)","size":6,"symbol":"circle","line":{"color":"rgba(0,0,255,1)"}},"type":"scatter","name":"Metastatic","textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.937987162037589,1.17355733829493,1.07428298795204,1.09387768275128],"y":[50166589,36053556,41790617,61540354],"text":["TCGA.YB.A89D.11A.11R.A36G.07","TCGA.H6.A45N.11A.12R.A26U.07","TCGA.HV.A5A3.11A.11R.A26U.07","TCGA.H6.8124.11A.01R.2404.07"],"mode":"markers","marker":{"color":"rgba(0,255,0,1)","size":6,"symbol":"circle","line":{"color":"rgba(0,255,0,1)"}},"type":"scatter","name":"Normal","textfont":{"color":"rgba(0,255,0,1)"},"error_y":{"color":"rgba(0,255,0,1)"},"error_x":{"color":"rgba(0,255,0,1)"},"line":{"color":"rgba(0,255,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.09282110294379],"y":[29316953],"text":"CCR170093_RNA_WPT_013","mode":"markers","marker":{"color":"rgba(184,134,11,1)","size":6,"symbol":"circle","line":{"color":"rgba(184,134,11,1)"}},"type":"scatter","name":"Organoid","textfont":{"color":"rgba(184,134,11,1)"},"error_y":{"color":"rgba(184,134,11,1)"},"error_x":{"color":"rgba(184,134,11,1)"},"line":{"color":"rgba(184,134,11,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.10242808020727,0.91202881064863,0.956066613264019,0.985785287482931,0.871722294277497,1.03410602164693,0.983035059177656,0.888541033780598],"y":[56311230,45312492,40250678,46668330,50267684,45091525,40289443,49881400],"text":["TCGA.3A.A9IR.01A.11R.A38C.07","TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA.3A.A9IV.01A.11R.A41B.07","TCGA.3A.A9IN.01A.11R.A39D.07","TCGA.3A.A9IO.01A.11R.A38C.07","TCGA.3A.A9IL.01A.11R.A38C.07","TCGA.2L.AAQM.01A.11R.A39D.07","TCGA.3A.A9IS.01A.21R.A39D.07"],"mode":"markers","marker":{"color":"rgba(139,0,0,1)","size":6,"symbol":"circle","line":{"color":"rgba(139,0,0,1)"}},"type":"scatter","name":"PanNET","textfont":{"color":"rgba(139,0,0,1)"},"error_y":{"color":"rgba(139,0,0,1)"},"error_x":{"color":"rgba(139,0,0,1)"},"line":{"color":"rgba(139,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.01197714686312,0.90697092432366,1.18298470786987,0.985952831135258,1.05293006898922,1.08885081168171,1.1138019797031,0.956931383723968,0.990149233061622,1.01367031928384,1.06669599948057,1.0071307539804,0.887796292558425,1.13752455779191,1.12552460007068,1.00003772551884,0.831742608035453,1.20566158284836,0.98361753891839,1.05805304572865,1.05990228127501,0.955752419586193,0.992670321157144,1.03772296044216,0.966947815599343,1.23423965643551,1.0145954217942,0.876227754473111,0.984793800661606,1.11030545416885,0.971268552567552,1.11542645400928,0.966122988919013,1.11322623976317,0.950876775421129,1.12115528901966,0.971326168142855,1.07824193504382,1.11392487516666,1.08955222042997,0.769004202605627,1.23682300633518,0.93456821151661,0.884305170631442,1.0681321484878,1.14051554489549,0.855962026327431,1.22168590181534,0.968309543364477,1.05109972315868,1.03246335391997,1.02954999648777,1.08183898090178,0.978570154482675,0.655646382432621,1.15367493721086,0.991677588834654,1.04951982120114,1.06367361964659,0.962215463769261,1.09917101169971,0.963085395130119,0.964966328189611,0.992409459583742,1.0291364278583,0.989535716770051,1.03496592002113,1.01341179086346,1.03612636621364,1.11949726946258,1.02769135894106,0.858924069228511,1.02410250247336,0.996427855375623,1.01675178697428,1.16102499478675,0.952877903913208,0.880037752623744,1.03086552069282,0.836485832618147,0.985961597001389,1.21368393390621,1.09601805502911,0.989288611247593,0.687656915832988,0.956583857740929,1.00168823272945,1.05882007734828,1.03996325393453,0.922863636307698,0.354234450597673,1.12711122047811,0.955634581677806,0.834913091734766,1.18740955539719,1.02463208596482,1.03720212543151,0.915550501477758,1.01894165498722,0.941544498153939,1.00687744203917,1.01035054067745,0.945738248911504,1.03449313656736,0.915826259748987,1.01159828506784,1.07698398802853,1.20596046805598,0.904283346209843,1.03466061638472,1.02875210290388,0.980458194070575,1.05539110933901,0.9193708558455,1.11485943811637,0.95950430887179,1.04061865640035,1.09526921211253,0.957485987344484,0.969643638226502,1.00447803267431,1.07016022367271,1.02598545311688,1.06112801508858,1.05301784280664,0.873521923922658,1.09456489102372,1.03754785224218,1.10017081296418,0.980973809164385,1.00797093692661,0.922359199592749,1.0557847071966,0.979757401868597,0.881289822341895,1.00232223886952,1.06547324418421,1.16416329646408,0.721225426954438,1.08352440242098,0.920102461386147,1.09353574950317,1.21373909613041,0.949609209095687,1.13225230657786,1.02500310613345,1.1629076120384,1.01451039963986,1.19639185220693,0.955915172401135,0.849752512722496],"y":[49606961,49796878,89491251,72246664,55702426,53028984,34703945,41826759,37968879,23918373,53696563,20214768,27261017,45737211,49858855,65860353,68817883,60559036,51716783,31290873,41208538,58508494,22696522,48920327,30422453,41063147,52782398,41823951,46201322,37534574,48581531,49300787,44248329,45797028,57519334,52051354,59756004,39293420,37561821,55764650,48636026,30992933,51155421,64607342,47378455,45832246,59470818,58575232,38938451,47169030,62340760,50702563,53055963,37536000,40474654,64556704,36955515,47763797,84027842,40343401,42220050,46036853,47424619,71393146,62703887,64486662,29426373,45635292,60420839,55296167,42547315,46139357,73107250,54693722,51496012,88084463,38793639,35838689,53174462,25763063,41930014,48582534,29899521,33483512,58150124,46437484,62315342,36712226,42327019,49396537,40192992,43557389,49582398,53141638,68890557,55556370,55959315,50673209,45405622,31452023,57153825,59620597,46374315,45003406,50731954,46348981,43864694,74744706,41392949,60242376,58130034,57853112,73309451,48060970,35623913,45678332,82696572,51347074,39502958,50129266,42507803,58905440,62787548,37819813,47497685,56392717,23283289,50671397,42597099,47501948,35503100,79046121,57701165,55788375,48991401,50550958,51927623,41058299,67060840,40742932,62960024,41453529,59124535,43304124,30418117,46826027,46113636,52211123,28275676,39945894,36658009],"text":["TCGA.IB.AAUO.01A.12R.A38C.07","TCGA.3A.A9I9.01A.11R.A38C.07","TCGA.HZ.8519.01A.11R.2404.07","TCGA.IB.7885.01A.11R.2156.07","TCGA.US.A774.01A.21R.A32O.07","TCGA.S4.A8RM.01A.11R.A37L.07","TCGA.2J.AABA.01A.21R.A41B.07","TCGA.M8.A5N4.01A.11R.A26U.07","TCGA.2L.AAQL.01A.11R.A38C.07","TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA.IB.7645.01A.22R.2204.07","TCGA.2J.AABU.01A.11R.A41B.07","TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA.IB.AAUR.01A.21R.A38C.07","TCGA.IB.7887.01A.11R.2156.07","TCGA.IB.7893.01A.11R.2204.07","TCGA.2J.AABF.01A.31R.A41B.07","TCGA.HV.AA8V.01A.11R.A41B.07","TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA.IB.7888.01A.11R.2156.07","TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA.2J.AAB9.01A.11R.A41B.07","TCGA.IB.A6UF.01A.23R.A33R.07","TCGA.HV.A5A3.01A.11R.A26U.07","TCGA.S4.A8RP.01A.11R.A36G.07","TCGA.F2.A7TX.01A.33R.A38C.07","TCGA.HV.A7OL.01A.11R.A33R.07","TCGA.HZ.A49H.01A.11R.A26U.07","TCGA.XN.A8T5.01A.12R.A36G.07","TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA.LB.A7SX.01A.11R.A33R.07","TCGA.RB.A7B8.01A.12R.A33R.07","TCGA.XD.AAUI.01A.42R.A41B.07","TCGA.2J.AABH.01A.21R.A41B.07","TCGA.IB.AAUP.01A.11R.A37L.07","TCGA.3A.A9IB.01A.21R.A39D.07","TCGA.IB.AAUT.01A.11R.A37L.07","TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA.2J.AABK.01A.31R.A41B.07","TCGA.IB.AAUM.01A.11R.A37L.07","TCGA.FB.A4P6.01A.12R.A26U.07","TCGA.3A.A9IC.01A.11R.A38C.07","TCGA.FB.AAPU.01A.31R.A41B.07","TCGA.2L.AAQI.01A.12R.A39D.07","TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA.HZ.8317.01A.11R.2404.07","TCGA.IB.7897.01A.21R.2204.07","TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA.2L.AAQE.01A.11R.A39D.07","TCGA.HZ.A77P.01A.11R.A33R.07","TCGA.IB.A7LX.01A.12R.A36G.07","TCGA.2J.AAB4.01A.12R.A41B.07","TCGA.2J.AABT.01A.11R.A41B.07","TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA.HZ.8315.01A.11R.2404.07","TCGA.XD.AAUG.01A.61R.A41B.07","TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA.IB.7652.01A.11R.2156.07","TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA.HV.A5A4.01A.11R.A26U.07","TCGA.IB.7890.01A.12R.2204.07","TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA.IB.7644.01A.11R.2156.07","TCGA.IB.A5SO.01A.11R.A32O.07","TCGA.2J.AABI.01A.12R.A41B.07","TCGA.2J.AABO.01A.21R.A41B.07","TCGA.US.A779.01A.11R.A32O.07","TCGA.3A.A9IH.01A.12R.A39D.07","TCGA.HZ.7919.01A.11R.2156.07","TCGA.HV.A5A6.01A.11R.A26U.07","TCGA.YH.A8SY.01A.11R.A37L.07","TCGA.F2.6879.01A.11R.2156.07","TCGA.3A.A9IU.01A.11R.A39D.07","TCGA.HV.AA8X.01A.11R.A39D.07","TCGA.IB.8127.01A.11R.2404.07","TCGA.FB.AAPS.01A.12R.A39D.07","TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA.US.A77E.01A.11R.A32O.07","TCGA.F2.A44H.01A.11R.A26U.07","TCGA.3A.A9I5.01A.11R.A38C.07","TCGA.RB.AA9M.01A.11R.A39D.07","TCGA.FB.A545.01A.11R.A26U.07","TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA.IB.8126.01A.11R.2404.07","TCGA.IB.A5SP.01A.11R.A32O.07","TCGA.HZ.8001.01A.11R.2204.07","TCGA.2J.AABE.01A.12R.A41B.07","TCGA.IB.AAUN.01A.12R.A38C.07","TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA.2J.AABV.01A.12R.A41B.07","TCGA.XN.A8T3.01A.11R.A36G.07","TCGA.OE.A75W.01A.12R.A32O.07","TCGA.LB.A8F3.01A.11R.A36G.07","TCGA.HZ.8636.01A.21R.2404.07","TCGA.XD.AAUL.01A.21R.A39D.07","TCGA.3A.A9I7.01A.21R.A38C.07","TCGA.US.A776.01A.13R.A33R.07","TCGA.IB.A7M4.01A.11R.A36G.07","TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA.2L.AAQA.01A.21R.A38C.07","TCGA.IB.7889.01A.11R.2156.07","TCGA.F2.A8YN.01A.11R.A37L.07","TCGA.YB.A89D.01A.12R.A36G.07","TCGA.IB.A6UG.01A.32R.A33R.07","TCGA.FB.AAPY.01A.11R.A41B.07","TCGA.S4.A8RO.01A.12R.A37L.07","TCGA.HZ.8637.01A.11R.2404.07","TCGA.2J.AAB6.01A.11R.A41B.07","TCGA.IB.7886.01A.11R.2156.07","TCGA.H6.8124.01A.11R.2404.07","TCGA.IB.7891.01A.11R.2204.07","TCGA.HZ.7926.01A.11R.2156.07","TCGA.IB.7646.01A.11R.2156.07","TCGA.2J.AABR.01A.11R.A41B.07","TCGA.3A.A9J0.01A.11R.A41B.07","TCGA.IB.7651.01A.11R.2156.07","TCGA.IB.AAUU.01A.11R.A37L.07","TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA.IB.AAUS.01A.12R.A38C.07","TCGA.F2.A44G.01A.11R.A26U.07","TCGA.3A.A9IX.01A.11R.A41B.07","TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA.US.A77G.01A.11R.A32O.07","TCGA.HZ.8005.01A.11R.2204.07","TCGA.2J.AAB8.01A.12R.A41B.07","TCGA.YY.A8LH.01A.11R.A36G.07","TCGA.HZ.A49G.01A.11R.A26U.07","TCGA.FB.A5VM.01A.11R.A32O.07","TCGA.IB.7649.01A.11R.2156.07","TCGA.HZ.7925.01A.11R.2156.07","TCGA.FB.A78T.01A.12R.A32O.07","TCGA.HZ.7922.01A.11R.2156.07","TCGA.HZ.A77O.01A.11R.A33R.07","TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA.IB.A5ST.01A.11R.A32O.07","TCGA.XD.AAUH.01A.42R.A41B.07","TCGA.HZ.8003.01A.21R.2204.07","TCGA.HV.A5A5.01A.11R.A26U.07","TCGA.IB.A5SS.01A.11R.A32O.07","TCGA.HZ.A49I.01A.12R.A26U.07","TCGA.HZ.8002.01A.11R.2204.07","TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA.FB.A4P5.01A.11R.A26U.07","TCGA.2J.AAB1.01A.11R.A41B.07","TCGA.3E.AAAY.01A.11R.A38C.07","TCGA.L1.A7W4.01A.12R.A36G.07","TCGA.H6.A45N.01A.11R.A26U.07","TCGA.FB.AAQ0.01A.31R.A41B.07","CCR170012_MH17T001P013"],"mode":"markers","marker":{"color":"rgba(0,191,255,1)","size":6,"symbol":"circle","line":{"color":"rgba(0,191,255,1)"}},"type":"scatter","name":"PDAC","textfont":{"color":"rgba(0,191,255,1)"},"error_y":{"color":"rgba(0,191,255,1)"},"error_x":{"color":"rgba(0,191,255,1)"},"line":{"color":"rgba(0,191,255,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save the scatter-plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_scaling_factor_targets.html"), selfcontained = TRUE)

##### Detach plotly package. Otherwise it clashes with other graphics devices
detach("package:plotly", unload=FALSE)
```


## Exploratory data analysis {.tabset}

Before principal component analysis, we perform some exploratory data analysis such as PCA, relative log expression (RLE) plot, correlation matrix and scatter plot matrix. This procedure follows [this tutorial](http://www.sthda.com/english/wiki/print.php?id=202) and implements fucntions from the [inSilicoMerging](http://www.bioconductor.org/packages//2.10/bioc/vignettes/inSilicoMerging/inst/doc/inSilicoMerging.pdf) package.

### PCA plot (datasets)

Principal component analysis (PCA) reduces the dimensionality of data while retaining most of the variation in the dataset, making it possible to visually assess similarities and differences between samples and determine whether samples can be grouped. This exploratory analysis facilitates identification of the key factors affecting the variability in the  expression data. Different colours represent datasets.


```r
suppressMessages(library(plotly))
##### Keep only genes with variance > 0 across all samples
rsd <- apply(y.norm.cpm,1,sd)
y.norm.cpm.subset <- y.norm.cpm[rsd>0,]

##### Perform PCA
y.norm.cpm.subset_pca <- prcomp(t(y.norm.cpm.subset), scale=FALSE)

##### Get variance importance for all principal components
importance_pca <- summary(y.norm.cpm.subset_pca)$importance[2,]
importance_pca <- paste(round(100*importance_pca, 2), "%", sep="")
names(importance_pca) <- names(summary(y.norm.cpm.subset_pca)$importance[2,])
  
##### Prepare data frame
y.norm.cpm.subset_pca.df <- data.frame(targetFile$Target,targetFile$Dataset, y.norm.cpm.subset_pca$x[,"PC1"], y.norm.cpm.subset_pca$x[,"PC2"], y.norm.cpm.subset_pca$x[,"PC3"])
colnames(y.norm.cpm.subset_pca.df) <- c("Target", "Dataset", "PC1", "PC2", "PC3")

##### Generate PCA 2-D plot
p <- plot_ly(y.norm.cpm.subset_pca.df, x = ~PC1, y = ~PC2, color = ~Dataset, text=paste(targetFile$Dataset, rownames(y.norm.cpm.subset_pca.df), sep=": "), colors = datasets.colour[[1]], type='scatter', mode = "markers", marker = list(size=10, opacity = 0.7, symbol=datasets.symbols[[2]][order(targetFile$Dataset)]), width = 600, height = 400) %>%
layout(title = "", xaxis = list(title = paste( "PC1", " (",importance_pca["PC1"],")",sep="")), yaxis = list(title = paste( "PC2", " (",importance_pca["PC2"],")",sep="")), margin = list(l=50, r=50, b=50, t=20, pad=4), autosize = FALSE, showlegend = TRUE, legend = list(orientation = "v", y = 0.9))

p
```

<!--html_preserve--><div id="htmlwidget-bc1ff816054a00ccd679" style="width:600px;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-bc1ff816054a00ccd679">{"x":{"visdat":{"1c252a4a2b7f":["function () ","plotlyVisDat"]},"cur_data":"1c252a4a2b7f","attrs":{"1c252a4a2b7f":{"x":{},"y":{},"text":["TCGA-PAAD: TCGA.IB.AAUO.01A.12R.A38C.07","TCGA-PAAD: TCGA.3A.A9I9.01A.11R.A38C.07","TCGA-PAAD: TCGA.HZ.8519.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7885.01A.11R.2156.07","TCGA-PAAD: TCGA.US.A774.01A.21R.A32O.07","TCGA-PAAD: TCGA.S4.A8RM.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IR.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA-PAAD: TCGA.2J.AABA.01A.21R.A41B.07","TCGA-PAAD: TCGA.M8.A5N4.01A.11R.A26U.07","TCGA-PAAD: TCGA.2L.AAQL.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7645.01A.22R.2204.07","TCGA-PAAD: TCGA.2J.AABU.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9IV.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.AAUR.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7887.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7893.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABF.01A.31R.A41B.07","TCGA-PAAD: TCGA.3A.A9IN.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8V.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7888.01A.11R.2156.07","TCGA-PAAD: TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AAB9.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.A6UF.01A.23R.A33R.07","TCGA-PAAD: TCGA.HV.A5A3.01A.11R.A26U.07","TCGA-PAAD: TCGA.S4.A8RP.01A.11R.A36G.07","TCGA-PAAD: TCGA.F2.A7TX.01A.33R.A38C.07","TCGA-PAAD: TCGA.HV.A7OL.01A.11R.A33R.07","TCGA-PAAD: TCGA.HZ.A49H.01A.11R.A26U.07","TCGA-PAAD: TCGA.XN.A8T5.01A.12R.A36G.07","TCGA-PAAD: TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA-PAAD: TCGA.LB.A7SX.01A.11R.A33R.07","TCGA-PAAD: TCGA.YB.A89D.11A.11R.A36G.07","TCGA-PAAD: TCGA.RB.A7B8.01A.12R.A33R.07","TCGA-PAAD: TCGA.XD.AAUI.01A.42R.A41B.07","TCGA-PAAD: TCGA.2J.AABH.01A.21R.A41B.07","TCGA-PAAD: TCGA.3A.A9IO.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUP.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IB.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.AAUT.01A.11R.A37L.07","TCGA-PAAD: TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABK.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.AAUM.01A.11R.A37L.07","TCGA-PAAD: TCGA.FB.A4P6.01A.12R.A26U.07","TCGA-PAAD: TCGA.3A.A9IC.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAPU.01A.31R.A41B.07","TCGA-PAAD: TCGA.2L.AAQI.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA-PAAD: TCGA.HZ.8317.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7897.01A.21R.2204.07","TCGA-PAAD: TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA-PAAD: TCGA.2L.AAQE.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.A77P.01A.11R.A33R.07","TCGA-PAAD: TCGA.IB.A7LX.01A.12R.A36G.07","TCGA-PAAD: TCGA.2J.AAB4.01A.12R.A41B.07","TCGA-PAAD: TCGA.FB.AAPP.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABT.01A.11R.A41B.07","TCGA-PAAD: TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.8315.01A.11R.2404.07","TCGA-PAAD: TCGA.XD.AAUG.01A.61R.A41B.07","TCGA-PAAD: TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7652.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA-PAAD: TCGA.HV.A5A4.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.7890.01A.12R.2204.07","TCGA-PAAD: TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA-PAAD: TCGA.IB.7644.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.A5SO.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AABI.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABO.01A.21R.A41B.07","TCGA-PAAD: TCGA.US.A779.01A.11R.A32O.07","TCGA-PAAD: TCGA.3A.A9IH.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.7919.01A.11R.2156.07","TCGA-PAAD: TCGA.HV.A5A6.01A.11R.A26U.07","TCGA-PAAD: TCGA.YH.A8SY.01A.11R.A37L.07","TCGA-PAAD: TCGA.F2.6879.01A.11R.2156.07","TCGA-PAAD: TCGA.3A.A9IU.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8X.01A.11R.A39D.07","TCGA-PAAD: TCGA.IB.8127.01A.11R.2404.07","TCGA-PAAD: TCGA.FB.AAPS.01A.12R.A39D.07","TCGA-PAAD: TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA-PAAD: TCGA.US.A77E.01A.11R.A32O.07","TCGA-PAAD: TCGA.F2.A44H.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9I5.01A.11R.A38C.07","TCGA-PAAD: TCGA.RB.AA9M.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.A7OP.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.A545.01A.11R.A26U.07","TCGA-PAAD: TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA-PAAD: TCGA.IB.8126.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.A5SP.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.8001.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABE.01A.12R.A41B.07","TCGA-PAAD: TCGA.3A.A9IL.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUN.01A.12R.A38C.07","TCGA-PAAD: TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA-PAAD: TCGA.2J.AABV.01A.12R.A41B.07","TCGA-PAAD: TCGA.XN.A8T3.01A.11R.A36G.07","TCGA-PAAD: TCGA.OE.A75W.01A.12R.A32O.07","TCGA-PAAD: TCGA.LB.A8F3.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.8636.01A.21R.2404.07","TCGA-PAAD: TCGA.XD.AAUL.01A.21R.A39D.07","TCGA-PAAD: TCGA.2L.AAQM.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9I7.01A.21R.A38C.07","TCGA-PAAD: TCGA.US.A776.01A.13R.A33R.07","TCGA-PAAD: TCGA.IB.A7M4.01A.11R.A36G.07","TCGA-PAAD: TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA-PAAD: TCGA.2L.AAQA.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7889.01A.11R.2156.07","TCGA-PAAD: TCGA.F2.A8YN.01A.11R.A37L.07","TCGA-PAAD: TCGA.YB.A89D.01A.12R.A36G.07","TCGA-PAAD: TCGA.3A.A9IS.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.A6UG.01A.32R.A33R.07","TCGA-PAAD: TCGA.FB.AAPY.01A.11R.A41B.07","TCGA-PAAD: TCGA.S4.A8RO.01A.12R.A37L.07","TCGA-PAAD: TCGA.HZ.8637.01A.11R.2404.07","TCGA-PAAD: TCGA.2J.AAB6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7886.01A.11R.2156.07","TCGA-PAAD: TCGA.H6.8124.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7891.01A.11R.2204.07","TCGA-PAAD: TCGA.H6.A45N.11A.12R.A26U.07","TCGA-PAAD: TCGA.HZ.7926.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7646.01A.11R.2156.07","TCGA-PAAD: TCGA.2J.AABR.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9J0.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7651.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.AAUU.01A.11R.A37L.07","TCGA-PAAD: TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA-PAAD: TCGA.IB.AAUS.01A.12R.A38C.07","TCGA-PAAD: TCGA.F2.A44G.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9IX.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA-PAAD: TCGA.US.A77G.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8005.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AAB8.01A.12R.A41B.07","TCGA-PAAD: TCGA.HV.A5A3.11A.11R.A26U.07","TCGA-PAAD: TCGA.YY.A8LH.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.A49G.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.A5VM.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7649.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.7925.01A.11R.2156.07","TCGA-PAAD: TCGA.FB.A78T.01A.12R.A32O.07","TCGA-PAAD: TCGA.HZ.7922.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77O.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.A5ST.01A.11R.A32O.07","TCGA-PAAD: TCGA.XD.AAUH.01A.42R.A41B.07","TCGA-PAAD: TCGA.HZ.8003.01A.21R.2204.07","TCGA-PAAD: TCGA.HV.A5A5.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.A5SS.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A49I.01A.12R.A26U.07","TCGA-PAAD: TCGA.H6.8124.11A.01R.2404.07","TCGA-PAAD: TCGA.HZ.8002.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA-PAAD: TCGA.FB.A4P5.01A.11R.A26U.07","TCGA-PAAD: TCGA.2J.AAB1.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAY.01A.11R.A38C.07","TCGA-PAAD: TCGA.L1.A7W4.01A.12R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.AAQ0.01A.31R.A41B.07","Avner: CCR170093_RNA_WPT_013","Avner: CCR170012_MH17T001P013"],"mode":"markers","marker":{"size":10,"opacity":0.7,"symbol":["circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","square","square"]},"color":{},"colors":["dodgerblue","firebrick"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":600,"height":400,"margin":{"b":50,"l":50,"t":20,"r":50,"pad":4},"title":"","xaxis":{"domain":[0,1],"automargin":true,"title":"PC1 (14.76%)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"PC2 (12.64%)"},"autosize":false,"showlegend":true,"legend":{"orientation":"v","y":0.9},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[-39.5096329738213,-0.9505355203886,80.2127705047868,-46.6230272166826,-27.1441323826728,-33.405260943958,254.460947231326,267.88992161989,-34.0023167958671,-55.3480676372859,-5.60915111816782,-23.6603991658158,-1.73724967460498,-44.1529304681383,224.453407921171,-31.4517058117416,-27.3741670418291,8.95319781501381,-48.7635072481656,-18.6611006738754,-10.8112677324935,205.494928124774,-21.7235872145004,-25.7935281045507,22.5336300615491,-51.2106961117494,-4.75603870600442,-21.3782025618893,-51.0637610497309,-8.40918772983574,-9.62561098082745,-55.1413865942984,17.2780844973726,29.7644621792625,-0.599146807661378,-26.0403425923249,-18.5291516603558,-22.2591111664937,-15.6396539159804,-5.47469531112594,224.979561127269,-11.2446478790358,-22.8484060882454,17.2106872488172,-2.52297915054892,18.8700354963358,25.2036386603,16.6812598620333,-37.9148215642545,-33.0443803562137,-16.8226751641533,-8.30164988472832,-11.9588165083182,67.4957652118502,-27.0466788657155,-32.2849438435798,15.2220232259752,-39.3760650643882,-11.0314730731224,25.0409903306279,6.64538342370945,2.31070894211073,-34.2422879349515,39.5548849803914,37.0912017070588,-5.17510042752755,-38.595908396523,-20.8868625337465,-1.06787109830572,-9.70080534427894,-40.4470566422701,-17.433622191752,-9.30737146604097,-11.9030176002842,-6.50445511943287,-13.5967922314083,-36.7969011077622,-33.3578684842641,-55.158622958603,-46.7913639046901,-40.053807011482,-28.5007568946637,-44.5965513819438,2.88966076089788,-43.9403545793389,-27.895206833818,14.0534016337911,48.8322490551398,18.666778519432,40.6256668841229,-22.7207085825641,-50.0016980143501,35.1917082529504,-19.5596616917483,12.5427537830307,19.9847552302763,-36.0590582414961,198.247287550819,-28.426362759485,-59.3563817822117,18.5140763076994,12.548483996723,-44.886876885917,23.7435159342809,-23.3523525453009,-33.6454088392129,223.80018994889,-27.8943798117145,26.6914988763467,-41.8186105096457,-45.2332689447674,-63.6129891062409,-23.9949036163229,-56.4386454233988,-18.409584919232,316.804873693753,-3.61490628635037,-28.4664778938386,-15.2809885879065,28.0712787550042,-5.72502772557059,-47.8378725517243,-13.8703310029183,0.0836406521641423,89.4220691900872,-34.1986729312702,-29.0339058245327,3.08077895985972,-56.1190496657094,-10.6610156191389,-33.1059208412153,-24.9183301808939,-17.8165375537453,-54.9078329721756,4.78773455576834,-16.4672550332323,-2.80010447463,-24.7980389455741,-20.8239609548476,-50.3351268187208,39.1939807238073,-34.1326482882487,-3.66868407496047,-1.48495068372064,-2.0057179917184,-20.1802101973969,-18.4501134088173,-31.3268296852103,-31.2466950492202,12.6143352842551,-17.2489615674335,64.7407938131919,22.3855394502879,11.5118758656272,-29.6793672635051,-23.0190198633823,44.5426805875147,22.8590441054633,-17.8902878778119,2.6842240602341,-32.1569787115552,-6.39955696632374,6.17368294369863,5.64165749724985,-48.0795303820063],"y":[-34.399269297641,23.2053421393136,58.8662840107597,27.5560235691365,56.2020593453304,-59.2321436665237,-81.1441830815798,-56.7030467758504,-8.75882545773145,-55.373018967477,9.04771077484417,-66.2387779270581,69.5120956588285,-38.0471354434322,-51.1228411552338,-44.065536176215,16.0489669837953,60.9218515939107,-29.7398154560986,14.340222180226,36.0645822796106,20.0644929603723,22.5272376108219,18.0140903654966,81.4420522012264,-31.7502152942052,54.6965414822371,-26.5580751011711,-76.701521149603,14.5638653808841,34.726874436223,-37.8658598190469,80.1206935775191,52.1020823347876,-12.0106311201158,-35.461679374984,48.7984125678722,-1.18392140635895,34.6929673302986,1.56239226147181,-6.45521730326628,60.4572973418011,9.15822305935094,73.8838276282681,15.342749763907,9.31613946784426,53.8214209466886,44.601968302529,-17.2799534289966,-86.5527312034837,7.59482346797364,27.2242059327944,35.5392214927861,101.961830622603,-84.0338710447212,-41.6734377551029,37.7134321048641,-53.0005107116629,6.06592702479911,-210.6638900255,5.3746657533973,53.2769460110038,38.0335713461849,83.2400960801393,53.867850847346,52.3972236258561,32.0309063278044,-6.28128059700764,23.8137275934406,44.0114600492213,-34.6680652507444,52.0932320779514,-44.9894188560586,17.2751288807307,-54.3840258252979,-12.4465964127922,19.0787450981375,-66.0691782916553,-35.2066389950616,-81.0699372074134,-5.02806569061731,-54.8024505705096,15.9763424903294,62.6611544430876,-38.6469120267407,-33.9960994351649,46.7416433229874,1.20847405160905,25.5660347004922,-146.020148943408,-43.6197230546796,-66.4966711314414,95.2208292015278,-43.5930056753265,-57.5673900379553,77.4700932435424,-11.3892794250771,-2.56315721580087,19.6717675707837,-26.3438773809578,5.8838685215405,34.4589743793149,-55.3790962964125,-19.2926501695037,23.3981860558057,4.61464494056441,-66.520607816587,21.225066817134,-121.287921869455,-22.2314913966622,-52.8509484580436,-77.6108269508814,45.482710368137,-40.9444702445933,30.6031860766845,-102.234655613013,20.2122681701092,25.5432989141772,-25.8828550842807,59.4840091122676,-17.4115264842447,-2.40434474086709,-31.1383048407228,91.1695350499447,32.1695564435801,19.6297019982158,-11.0581570221627,69.1685628708782,-40.1681676374665,32.611924247639,-10.8533495870535,2.7489293718562,60.0217866782442,-29.6609083770713,81.8402141841094,-1.719690277714,20.4655551898078,-61.9897229090999,-39.9309189158507,-37.6910386009108,46.39511808786,-83.0968141117788,57.4628331009818,7.81618925686741,86.2330855815594,6.41306788451144,-13.9786072997683,41.9887442078321,1.38619416201718,-35.2866240165053,44.0794998113294,74.5068147205299,97.9356664692912,43.2927233207322,-29.2511422806137,-1.04061452782688,79.5899759522146,87.0597418345398,-45.7091182819685,76.4139972846996,-5.06767491271939,43.270407728351,-58.7935056986307,57.1003244277275,-124.284983123327],"text":["TCGA-PAAD: TCGA.IB.AAUO.01A.12R.A38C.07","TCGA-PAAD: TCGA.3A.A9I9.01A.11R.A38C.07","TCGA-PAAD: TCGA.HZ.8519.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7885.01A.11R.2156.07","TCGA-PAAD: TCGA.US.A774.01A.21R.A32O.07","TCGA-PAAD: TCGA.S4.A8RM.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IR.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA-PAAD: TCGA.2J.AABA.01A.21R.A41B.07","TCGA-PAAD: TCGA.M8.A5N4.01A.11R.A26U.07","TCGA-PAAD: TCGA.2L.AAQL.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7645.01A.22R.2204.07","TCGA-PAAD: TCGA.2J.AABU.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9IV.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.AAUR.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7887.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7893.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABF.01A.31R.A41B.07","TCGA-PAAD: TCGA.3A.A9IN.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8V.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7888.01A.11R.2156.07","TCGA-PAAD: TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AAB9.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.A6UF.01A.23R.A33R.07","TCGA-PAAD: TCGA.HV.A5A3.01A.11R.A26U.07","TCGA-PAAD: TCGA.S4.A8RP.01A.11R.A36G.07","TCGA-PAAD: TCGA.F2.A7TX.01A.33R.A38C.07","TCGA-PAAD: TCGA.HV.A7OL.01A.11R.A33R.07","TCGA-PAAD: TCGA.HZ.A49H.01A.11R.A26U.07","TCGA-PAAD: TCGA.XN.A8T5.01A.12R.A36G.07","TCGA-PAAD: TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA-PAAD: TCGA.LB.A7SX.01A.11R.A33R.07","TCGA-PAAD: TCGA.YB.A89D.11A.11R.A36G.07","TCGA-PAAD: TCGA.RB.A7B8.01A.12R.A33R.07","TCGA-PAAD: TCGA.XD.AAUI.01A.42R.A41B.07","TCGA-PAAD: TCGA.2J.AABH.01A.21R.A41B.07","TCGA-PAAD: TCGA.3A.A9IO.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUP.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IB.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.AAUT.01A.11R.A37L.07","TCGA-PAAD: TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABK.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.AAUM.01A.11R.A37L.07","TCGA-PAAD: TCGA.FB.A4P6.01A.12R.A26U.07","TCGA-PAAD: TCGA.3A.A9IC.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAPU.01A.31R.A41B.07","TCGA-PAAD: TCGA.2L.AAQI.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA-PAAD: TCGA.HZ.8317.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7897.01A.21R.2204.07","TCGA-PAAD: TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA-PAAD: TCGA.2L.AAQE.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.A77P.01A.11R.A33R.07","TCGA-PAAD: TCGA.IB.A7LX.01A.12R.A36G.07","TCGA-PAAD: TCGA.2J.AAB4.01A.12R.A41B.07","TCGA-PAAD: TCGA.FB.AAPP.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABT.01A.11R.A41B.07","TCGA-PAAD: TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.8315.01A.11R.2404.07","TCGA-PAAD: TCGA.XD.AAUG.01A.61R.A41B.07","TCGA-PAAD: TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7652.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA-PAAD: TCGA.HV.A5A4.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.7890.01A.12R.2204.07","TCGA-PAAD: TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA-PAAD: TCGA.IB.7644.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.A5SO.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AABI.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABO.01A.21R.A41B.07","TCGA-PAAD: TCGA.US.A779.01A.11R.A32O.07","TCGA-PAAD: TCGA.3A.A9IH.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.7919.01A.11R.2156.07","TCGA-PAAD: TCGA.HV.A5A6.01A.11R.A26U.07","TCGA-PAAD: TCGA.YH.A8SY.01A.11R.A37L.07","TCGA-PAAD: TCGA.F2.6879.01A.11R.2156.07","TCGA-PAAD: TCGA.3A.A9IU.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8X.01A.11R.A39D.07","TCGA-PAAD: TCGA.IB.8127.01A.11R.2404.07","TCGA-PAAD: TCGA.FB.AAPS.01A.12R.A39D.07","TCGA-PAAD: TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA-PAAD: TCGA.US.A77E.01A.11R.A32O.07","TCGA-PAAD: TCGA.F2.A44H.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9I5.01A.11R.A38C.07","TCGA-PAAD: TCGA.RB.AA9M.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.A7OP.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.A545.01A.11R.A26U.07","TCGA-PAAD: TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA-PAAD: TCGA.IB.8126.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.A5SP.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.8001.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABE.01A.12R.A41B.07","TCGA-PAAD: TCGA.3A.A9IL.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUN.01A.12R.A38C.07","TCGA-PAAD: TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA-PAAD: TCGA.2J.AABV.01A.12R.A41B.07","TCGA-PAAD: TCGA.XN.A8T3.01A.11R.A36G.07","TCGA-PAAD: TCGA.OE.A75W.01A.12R.A32O.07","TCGA-PAAD: TCGA.LB.A8F3.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.8636.01A.21R.2404.07","TCGA-PAAD: TCGA.XD.AAUL.01A.21R.A39D.07","TCGA-PAAD: TCGA.2L.AAQM.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9I7.01A.21R.A38C.07","TCGA-PAAD: TCGA.US.A776.01A.13R.A33R.07","TCGA-PAAD: TCGA.IB.A7M4.01A.11R.A36G.07","TCGA-PAAD: TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA-PAAD: TCGA.2L.AAQA.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7889.01A.11R.2156.07","TCGA-PAAD: TCGA.F2.A8YN.01A.11R.A37L.07","TCGA-PAAD: TCGA.YB.A89D.01A.12R.A36G.07","TCGA-PAAD: TCGA.3A.A9IS.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.A6UG.01A.32R.A33R.07","TCGA-PAAD: TCGA.FB.AAPY.01A.11R.A41B.07","TCGA-PAAD: TCGA.S4.A8RO.01A.12R.A37L.07","TCGA-PAAD: TCGA.HZ.8637.01A.11R.2404.07","TCGA-PAAD: TCGA.2J.AAB6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7886.01A.11R.2156.07","TCGA-PAAD: TCGA.H6.8124.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7891.01A.11R.2204.07","TCGA-PAAD: TCGA.H6.A45N.11A.12R.A26U.07","TCGA-PAAD: TCGA.HZ.7926.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7646.01A.11R.2156.07","TCGA-PAAD: TCGA.2J.AABR.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9J0.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7651.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.AAUU.01A.11R.A37L.07","TCGA-PAAD: TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA-PAAD: TCGA.IB.AAUS.01A.12R.A38C.07","TCGA-PAAD: TCGA.F2.A44G.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9IX.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA-PAAD: TCGA.US.A77G.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8005.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AAB8.01A.12R.A41B.07","TCGA-PAAD: TCGA.HV.A5A3.11A.11R.A26U.07","TCGA-PAAD: TCGA.YY.A8LH.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.A49G.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.A5VM.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7649.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.7925.01A.11R.2156.07","TCGA-PAAD: TCGA.FB.A78T.01A.12R.A32O.07","TCGA-PAAD: TCGA.HZ.7922.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77O.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.A5ST.01A.11R.A32O.07","TCGA-PAAD: TCGA.XD.AAUH.01A.42R.A41B.07","TCGA-PAAD: TCGA.HZ.8003.01A.21R.2204.07","TCGA-PAAD: TCGA.HV.A5A5.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.A5SS.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A49I.01A.12R.A26U.07","TCGA-PAAD: TCGA.H6.8124.11A.01R.2404.07","TCGA-PAAD: TCGA.HZ.8002.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA-PAAD: TCGA.FB.A4P5.01A.11R.A26U.07","TCGA-PAAD: TCGA.2J.AAB1.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAY.01A.11R.A38C.07","TCGA-PAAD: TCGA.L1.A7W4.01A.12R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.AAQ0.01A.31R.A41B.07"],"mode":"markers","marker":{"color":"rgba(30,144,255,1)","size":10,"opacity":0.7,"symbol":["circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"line":{"color":"rgba(30,144,255,1)"}},"type":"scatter","name":"TCGA-PAAD","textfont":{"color":"rgba(30,144,255,1)"},"error_y":{"color":"rgba(30,144,255,1)"},"error_x":{"color":"rgba(30,144,255,1)"},"line":{"color":"rgba(30,144,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[28.3761904119425,3.70657659121272],"y":[-271.839201781264,-20.6361946440352],"text":["Avner: CCR170093_RNA_WPT_013","Avner: CCR170012_MH17T001P013"],"mode":"markers","marker":{"color":"rgba(178,34,34,1)","size":10,"opacity":0.7,"symbol":["square","square"],"line":{"color":"rgba(178,34,34,1)"}},"type":"scatter","name":"Avner","textfont":{"color":"rgba(178,34,34,1)"},"error_y":{"color":"rgba(178,34,34,1)"},"error_x":{"color":"rgba(178,34,34,1)"},"line":{"color":"rgba(178,34,34,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save PCA plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_PCA_2d_datasets.html"), selfcontained = TRUE)

##### Generate PCA 3-D plot
p <- plot_ly(y.norm.cpm.subset_pca.df, x = ~PC1, y = ~PC2, z = ~PC3, color = ~Dataset, text=paste(targetFile$Dataset, rownames(y.norm.cpm.subset_pca.df), sep=": "), colors = datasets.colour[[1]], type='scatter3d', mode = "markers", marker = list(size=8, opacity = 0.7, symbol=datasets.symbols[[2]][order(targetFile$Dataset)]), width = 600, height = 600) %>%
layout(title = "", xaxis = list(title = paste( "PC1", " (",importance_pca["PC1"],")",sep="")), yaxis = list(title = paste( "PC2", " (",importance_pca["PC2"],")",sep="")), zaxis = list(title = paste( "PC3", " (",importance_pca["PC3"],")",sep="")) , margin = list(l=50, r=50, b=50, t=10, pad=4), autosize = FALSE, showlegend = TRUE, legend = list(orientation = "v", y = 0.9))

p
```

<!--html_preserve--><div id="htmlwidget-38d3e53aae68771272bb" style="width:600px;height:600px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-38d3e53aae68771272bb">{"x":{"visdat":{"1c25282d7549":["function () ","plotlyVisDat"]},"cur_data":"1c25282d7549","attrs":{"1c25282d7549":{"x":{},"y":{},"z":{},"text":["TCGA-PAAD: TCGA.IB.AAUO.01A.12R.A38C.07","TCGA-PAAD: TCGA.3A.A9I9.01A.11R.A38C.07","TCGA-PAAD: TCGA.HZ.8519.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7885.01A.11R.2156.07","TCGA-PAAD: TCGA.US.A774.01A.21R.A32O.07","TCGA-PAAD: TCGA.S4.A8RM.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IR.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA-PAAD: TCGA.2J.AABA.01A.21R.A41B.07","TCGA-PAAD: TCGA.M8.A5N4.01A.11R.A26U.07","TCGA-PAAD: TCGA.2L.AAQL.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7645.01A.22R.2204.07","TCGA-PAAD: TCGA.2J.AABU.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9IV.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.AAUR.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7887.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7893.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABF.01A.31R.A41B.07","TCGA-PAAD: TCGA.3A.A9IN.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8V.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7888.01A.11R.2156.07","TCGA-PAAD: TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AAB9.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.A6UF.01A.23R.A33R.07","TCGA-PAAD: TCGA.HV.A5A3.01A.11R.A26U.07","TCGA-PAAD: TCGA.S4.A8RP.01A.11R.A36G.07","TCGA-PAAD: TCGA.F2.A7TX.01A.33R.A38C.07","TCGA-PAAD: TCGA.HV.A7OL.01A.11R.A33R.07","TCGA-PAAD: TCGA.HZ.A49H.01A.11R.A26U.07","TCGA-PAAD: TCGA.XN.A8T5.01A.12R.A36G.07","TCGA-PAAD: TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA-PAAD: TCGA.LB.A7SX.01A.11R.A33R.07","TCGA-PAAD: TCGA.YB.A89D.11A.11R.A36G.07","TCGA-PAAD: TCGA.RB.A7B8.01A.12R.A33R.07","TCGA-PAAD: TCGA.XD.AAUI.01A.42R.A41B.07","TCGA-PAAD: TCGA.2J.AABH.01A.21R.A41B.07","TCGA-PAAD: TCGA.3A.A9IO.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUP.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IB.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.AAUT.01A.11R.A37L.07","TCGA-PAAD: TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABK.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.AAUM.01A.11R.A37L.07","TCGA-PAAD: TCGA.FB.A4P6.01A.12R.A26U.07","TCGA-PAAD: TCGA.3A.A9IC.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAPU.01A.31R.A41B.07","TCGA-PAAD: TCGA.2L.AAQI.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA-PAAD: TCGA.HZ.8317.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7897.01A.21R.2204.07","TCGA-PAAD: TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA-PAAD: TCGA.2L.AAQE.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.A77P.01A.11R.A33R.07","TCGA-PAAD: TCGA.IB.A7LX.01A.12R.A36G.07","TCGA-PAAD: TCGA.2J.AAB4.01A.12R.A41B.07","TCGA-PAAD: TCGA.FB.AAPP.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABT.01A.11R.A41B.07","TCGA-PAAD: TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.8315.01A.11R.2404.07","TCGA-PAAD: TCGA.XD.AAUG.01A.61R.A41B.07","TCGA-PAAD: TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7652.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA-PAAD: TCGA.HV.A5A4.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.7890.01A.12R.2204.07","TCGA-PAAD: TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA-PAAD: TCGA.IB.7644.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.A5SO.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AABI.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABO.01A.21R.A41B.07","TCGA-PAAD: TCGA.US.A779.01A.11R.A32O.07","TCGA-PAAD: TCGA.3A.A9IH.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.7919.01A.11R.2156.07","TCGA-PAAD: TCGA.HV.A5A6.01A.11R.A26U.07","TCGA-PAAD: TCGA.YH.A8SY.01A.11R.A37L.07","TCGA-PAAD: TCGA.F2.6879.01A.11R.2156.07","TCGA-PAAD: TCGA.3A.A9IU.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8X.01A.11R.A39D.07","TCGA-PAAD: TCGA.IB.8127.01A.11R.2404.07","TCGA-PAAD: TCGA.FB.AAPS.01A.12R.A39D.07","TCGA-PAAD: TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA-PAAD: TCGA.US.A77E.01A.11R.A32O.07","TCGA-PAAD: TCGA.F2.A44H.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9I5.01A.11R.A38C.07","TCGA-PAAD: TCGA.RB.AA9M.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.A7OP.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.A545.01A.11R.A26U.07","TCGA-PAAD: TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA-PAAD: TCGA.IB.8126.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.A5SP.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.8001.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABE.01A.12R.A41B.07","TCGA-PAAD: TCGA.3A.A9IL.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUN.01A.12R.A38C.07","TCGA-PAAD: TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA-PAAD: TCGA.2J.AABV.01A.12R.A41B.07","TCGA-PAAD: TCGA.XN.A8T3.01A.11R.A36G.07","TCGA-PAAD: TCGA.OE.A75W.01A.12R.A32O.07","TCGA-PAAD: TCGA.LB.A8F3.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.8636.01A.21R.2404.07","TCGA-PAAD: TCGA.XD.AAUL.01A.21R.A39D.07","TCGA-PAAD: TCGA.2L.AAQM.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9I7.01A.21R.A38C.07","TCGA-PAAD: TCGA.US.A776.01A.13R.A33R.07","TCGA-PAAD: TCGA.IB.A7M4.01A.11R.A36G.07","TCGA-PAAD: TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA-PAAD: TCGA.2L.AAQA.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7889.01A.11R.2156.07","TCGA-PAAD: TCGA.F2.A8YN.01A.11R.A37L.07","TCGA-PAAD: TCGA.YB.A89D.01A.12R.A36G.07","TCGA-PAAD: TCGA.3A.A9IS.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.A6UG.01A.32R.A33R.07","TCGA-PAAD: TCGA.FB.AAPY.01A.11R.A41B.07","TCGA-PAAD: TCGA.S4.A8RO.01A.12R.A37L.07","TCGA-PAAD: TCGA.HZ.8637.01A.11R.2404.07","TCGA-PAAD: TCGA.2J.AAB6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7886.01A.11R.2156.07","TCGA-PAAD: TCGA.H6.8124.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7891.01A.11R.2204.07","TCGA-PAAD: TCGA.H6.A45N.11A.12R.A26U.07","TCGA-PAAD: TCGA.HZ.7926.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7646.01A.11R.2156.07","TCGA-PAAD: TCGA.2J.AABR.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9J0.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7651.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.AAUU.01A.11R.A37L.07","TCGA-PAAD: TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA-PAAD: TCGA.IB.AAUS.01A.12R.A38C.07","TCGA-PAAD: TCGA.F2.A44G.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9IX.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA-PAAD: TCGA.US.A77G.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8005.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AAB8.01A.12R.A41B.07","TCGA-PAAD: TCGA.HV.A5A3.11A.11R.A26U.07","TCGA-PAAD: TCGA.YY.A8LH.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.A49G.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.A5VM.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7649.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.7925.01A.11R.2156.07","TCGA-PAAD: TCGA.FB.A78T.01A.12R.A32O.07","TCGA-PAAD: TCGA.HZ.7922.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77O.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.A5ST.01A.11R.A32O.07","TCGA-PAAD: TCGA.XD.AAUH.01A.42R.A41B.07","TCGA-PAAD: TCGA.HZ.8003.01A.21R.2204.07","TCGA-PAAD: TCGA.HV.A5A5.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.A5SS.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A49I.01A.12R.A26U.07","TCGA-PAAD: TCGA.H6.8124.11A.01R.2404.07","TCGA-PAAD: TCGA.HZ.8002.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA-PAAD: TCGA.FB.A4P5.01A.11R.A26U.07","TCGA-PAAD: TCGA.2J.AAB1.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAY.01A.11R.A38C.07","TCGA-PAAD: TCGA.L1.A7W4.01A.12R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.AAQ0.01A.31R.A41B.07","Avner: CCR170093_RNA_WPT_013","Avner: CCR170012_MH17T001P013"],"mode":"markers","marker":{"size":8,"opacity":0.7,"symbol":["circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","square","square"]},"color":{},"colors":["dodgerblue","firebrick"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"width":600,"height":600,"margin":{"b":50,"l":50,"t":10,"r":50,"pad":4},"title":"","xaxis":{"title":"PC1 (14.76%)"},"yaxis":{"title":"PC2 (12.64%)"},"zaxis":{"title":"PC3 (7.61%)"},"autosize":false,"showlegend":true,"legend":{"orientation":"v","y":0.9},"scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[-39.5096329738213,-0.9505355203886,80.2127705047868,-46.6230272166826,-27.1441323826728,-33.405260943958,254.460947231326,267.88992161989,-34.0023167958671,-55.3480676372859,-5.60915111816782,-23.6603991658158,-1.73724967460498,-44.1529304681383,224.453407921171,-31.4517058117416,-27.3741670418291,8.95319781501381,-48.7635072481656,-18.6611006738754,-10.8112677324935,205.494928124774,-21.7235872145004,-25.7935281045507,22.5336300615491,-51.2106961117494,-4.75603870600442,-21.3782025618893,-51.0637610497309,-8.40918772983574,-9.62561098082745,-55.1413865942984,17.2780844973726,29.7644621792625,-0.599146807661378,-26.0403425923249,-18.5291516603558,-22.2591111664937,-15.6396539159804,-5.47469531112594,224.979561127269,-11.2446478790358,-22.8484060882454,17.2106872488172,-2.52297915054892,18.8700354963358,25.2036386603,16.6812598620333,-37.9148215642545,-33.0443803562137,-16.8226751641533,-8.30164988472832,-11.9588165083182,67.4957652118502,-27.0466788657155,-32.2849438435798,15.2220232259752,-39.3760650643882,-11.0314730731224,25.0409903306279,6.64538342370945,2.31070894211073,-34.2422879349515,39.5548849803914,37.0912017070588,-5.17510042752755,-38.595908396523,-20.8868625337465,-1.06787109830572,-9.70080534427894,-40.4470566422701,-17.433622191752,-9.30737146604097,-11.9030176002842,-6.50445511943287,-13.5967922314083,-36.7969011077622,-33.3578684842641,-55.158622958603,-46.7913639046901,-40.053807011482,-28.5007568946637,-44.5965513819438,2.88966076089788,-43.9403545793389,-27.895206833818,14.0534016337911,48.8322490551398,18.666778519432,40.6256668841229,-22.7207085825641,-50.0016980143501,35.1917082529504,-19.5596616917483,12.5427537830307,19.9847552302763,-36.0590582414961,198.247287550819,-28.426362759485,-59.3563817822117,18.5140763076994,12.548483996723,-44.886876885917,23.7435159342809,-23.3523525453009,-33.6454088392129,223.80018994889,-27.8943798117145,26.6914988763467,-41.8186105096457,-45.2332689447674,-63.6129891062409,-23.9949036163229,-56.4386454233988,-18.409584919232,316.804873693753,-3.61490628635037,-28.4664778938386,-15.2809885879065,28.0712787550042,-5.72502772557059,-47.8378725517243,-13.8703310029183,0.0836406521641423,89.4220691900872,-34.1986729312702,-29.0339058245327,3.08077895985972,-56.1190496657094,-10.6610156191389,-33.1059208412153,-24.9183301808939,-17.8165375537453,-54.9078329721756,4.78773455576834,-16.4672550332323,-2.80010447463,-24.7980389455741,-20.8239609548476,-50.3351268187208,39.1939807238073,-34.1326482882487,-3.66868407496047,-1.48495068372064,-2.0057179917184,-20.1802101973969,-18.4501134088173,-31.3268296852103,-31.2466950492202,12.6143352842551,-17.2489615674335,64.7407938131919,22.3855394502879,11.5118758656272,-29.6793672635051,-23.0190198633823,44.5426805875147,22.8590441054633,-17.8902878778119,2.6842240602341,-32.1569787115552,-6.39955696632374,6.17368294369863,5.64165749724985,-48.0795303820063],"y":[-34.399269297641,23.2053421393136,58.8662840107597,27.5560235691365,56.2020593453304,-59.2321436665237,-81.1441830815798,-56.7030467758504,-8.75882545773145,-55.373018967477,9.04771077484417,-66.2387779270581,69.5120956588285,-38.0471354434322,-51.1228411552338,-44.065536176215,16.0489669837953,60.9218515939107,-29.7398154560986,14.340222180226,36.0645822796106,20.0644929603723,22.5272376108219,18.0140903654966,81.4420522012264,-31.7502152942052,54.6965414822371,-26.5580751011711,-76.701521149603,14.5638653808841,34.726874436223,-37.8658598190469,80.1206935775191,52.1020823347876,-12.0106311201158,-35.461679374984,48.7984125678722,-1.18392140635895,34.6929673302986,1.56239226147181,-6.45521730326628,60.4572973418011,9.15822305935094,73.8838276282681,15.342749763907,9.31613946784426,53.8214209466886,44.601968302529,-17.2799534289966,-86.5527312034837,7.59482346797364,27.2242059327944,35.5392214927861,101.961830622603,-84.0338710447212,-41.6734377551029,37.7134321048641,-53.0005107116629,6.06592702479911,-210.6638900255,5.3746657533973,53.2769460110038,38.0335713461849,83.2400960801393,53.867850847346,52.3972236258561,32.0309063278044,-6.28128059700764,23.8137275934406,44.0114600492213,-34.6680652507444,52.0932320779514,-44.9894188560586,17.2751288807307,-54.3840258252979,-12.4465964127922,19.0787450981375,-66.0691782916553,-35.2066389950616,-81.0699372074134,-5.02806569061731,-54.8024505705096,15.9763424903294,62.6611544430876,-38.6469120267407,-33.9960994351649,46.7416433229874,1.20847405160905,25.5660347004922,-146.020148943408,-43.6197230546796,-66.4966711314414,95.2208292015278,-43.5930056753265,-57.5673900379553,77.4700932435424,-11.3892794250771,-2.56315721580087,19.6717675707837,-26.3438773809578,5.8838685215405,34.4589743793149,-55.3790962964125,-19.2926501695037,23.3981860558057,4.61464494056441,-66.520607816587,21.225066817134,-121.287921869455,-22.2314913966622,-52.8509484580436,-77.6108269508814,45.482710368137,-40.9444702445933,30.6031860766845,-102.234655613013,20.2122681701092,25.5432989141772,-25.8828550842807,59.4840091122676,-17.4115264842447,-2.40434474086709,-31.1383048407228,91.1695350499447,32.1695564435801,19.6297019982158,-11.0581570221627,69.1685628708782,-40.1681676374665,32.611924247639,-10.8533495870535,2.7489293718562,60.0217866782442,-29.6609083770713,81.8402141841094,-1.719690277714,20.4655551898078,-61.9897229090999,-39.9309189158507,-37.6910386009108,46.39511808786,-83.0968141117788,57.4628331009818,7.81618925686741,86.2330855815594,6.41306788451144,-13.9786072997683,41.9887442078321,1.38619416201718,-35.2866240165053,44.0794998113294,74.5068147205299,97.9356664692912,43.2927233207322,-29.2511422806137,-1.04061452782688,79.5899759522146,87.0597418345398,-45.7091182819685,76.4139972846996,-5.06767491271939,43.270407728351,-58.7935056986307,57.1003244277275,-124.284983123327],"z":[14.4433746194537,73.6419075468557,-4.12252884625644,-36.7947656638453,22.5727893369401,28.7169616918795,-28.4218023447517,3.31215691523526,-39.4078582941947,-58.9996912372938,61.4324270329008,15.2521692846821,-53.959114213929,-65.7353834676327,-28.5393583639167,39.6210957405027,31.7618640297212,-71.5792472612978,-37.6514273971197,-95.1231244009534,32.5707614739835,-24.1704954688484,-2.574684546356,13.0922985049363,-44.4893671801986,-13.9587533709559,38.5884160835129,36.941494391536,-8.3852512622659,44.1424760162707,13.5068740069953,-11.5832324202859,30.8628694026069,-49.8798239960916,44.3342736019198,-5.97102487390717,-17.0217230182258,-21.0580644022308,15.1297616269398,60.6493690305427,43.9667191049479,-56.2334306349418,-4.6068594251015,41.0015671218337,-109.054207823621,80.9268686777502,75.5133413176364,55.4830560245933,-32.1293381169056,24.5929361456099,60.9990195385238,-32.7920837014595,49.5886917447029,-41.3231824063551,46.6687316045696,-36.9248263153452,22.1189297573828,-14.2461822315398,53.8633653758892,8.79742089194846,-45.1236374803291,59.8153519722351,0.0135359214998918,-6.76611766547812,-38.1747311310124,19.6016745816593,-90.6912775665534,16.189435473157,-72.0117269852754,-102.248604168908,-8.07576579188661,-10.5980105320371,-95.4005387397385,25.4812990585129,75.4785471232121,19.5372797228912,9.75130660414105,-20.0905953527906,-68.6371540818144,-26.1423509665497,10.3865879641954,29.4705200001886,0.839621816476604,-37.0694556283622,52.5820731398342,8.93703687063038,36.7947788858545,32.7422791245015,14.0083360114318,33.9085738513744,-4.31893007339812,-12.6896410349944,44.4877288723771,70.2718213445726,-14.1878488007826,-22.7700142250266,3.7295314892925,17.5694258850915,31.7747172509015,-19.4460144143153,111.738072057527,25.968763861394,18.165082632402,76.4826284442393,-16.8851538144735,9.87926412703678,-9.02508367243031,-8.33266671333825,2.59585121700165,-8.25338860921372,12.8437099174172,3.10817159469454,21.4563783410558,-9.20992999893639,-1.56785615841894,-18.9613086988743,50.3973610319599,36.642141081662,7.67072835350195,-37.9477057339374,-35.9906553647311,-21.0139405243512,-19.707933526554,18.0597172531909,-134.353633977014,19.0242133864905,-84.771024981342,30.3969781898882,-50.7332736986664,-14.5479895233108,40.6186909069621,25.5073464526351,-44.8650287388969,1.00655755244037,22.5116314870241,6.73443373517409,-0.315216694059143,80.9949060018774,-100.950056308057,-57.0796881199647,29.0377604141077,35.5597222949769,45.1438885003671,-54.8113255224926,27.008730667217,-61.963057364094,75.5154122559307,-20.126026617202,45.1529966164939,-35.834828186381,-85.97003204647,-31.9784738544035,23.9461482235661,43.4084692212702,-86.6197348959631,-1.62067694843777,9.13084986437795,5.78710548786037,13.4674818908744,-1.08255177661878,38.0988458004362,39.7781655235771,-76.0053095323458,27.1919885499744,15.7077253517216],"text":["TCGA-PAAD: TCGA.IB.AAUO.01A.12R.A38C.07","TCGA-PAAD: TCGA.3A.A9I9.01A.11R.A38C.07","TCGA-PAAD: TCGA.HZ.8519.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7885.01A.11R.2156.07","TCGA-PAAD: TCGA.US.A774.01A.21R.A32O.07","TCGA-PAAD: TCGA.S4.A8RM.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IR.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA-PAAD: TCGA.2J.AABA.01A.21R.A41B.07","TCGA-PAAD: TCGA.M8.A5N4.01A.11R.A26U.07","TCGA-PAAD: TCGA.2L.AAQL.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7645.01A.22R.2204.07","TCGA-PAAD: TCGA.2J.AABU.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9IV.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.AAUR.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7887.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7893.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABF.01A.31R.A41B.07","TCGA-PAAD: TCGA.3A.A9IN.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8V.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7888.01A.11R.2156.07","TCGA-PAAD: TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AAB9.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.A6UF.01A.23R.A33R.07","TCGA-PAAD: TCGA.HV.A5A3.01A.11R.A26U.07","TCGA-PAAD: TCGA.S4.A8RP.01A.11R.A36G.07","TCGA-PAAD: TCGA.F2.A7TX.01A.33R.A38C.07","TCGA-PAAD: TCGA.HV.A7OL.01A.11R.A33R.07","TCGA-PAAD: TCGA.HZ.A49H.01A.11R.A26U.07","TCGA-PAAD: TCGA.XN.A8T5.01A.12R.A36G.07","TCGA-PAAD: TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA-PAAD: TCGA.LB.A7SX.01A.11R.A33R.07","TCGA-PAAD: TCGA.YB.A89D.11A.11R.A36G.07","TCGA-PAAD: TCGA.RB.A7B8.01A.12R.A33R.07","TCGA-PAAD: TCGA.XD.AAUI.01A.42R.A41B.07","TCGA-PAAD: TCGA.2J.AABH.01A.21R.A41B.07","TCGA-PAAD: TCGA.3A.A9IO.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUP.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IB.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.AAUT.01A.11R.A37L.07","TCGA-PAAD: TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABK.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.AAUM.01A.11R.A37L.07","TCGA-PAAD: TCGA.FB.A4P6.01A.12R.A26U.07","TCGA-PAAD: TCGA.3A.A9IC.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAPU.01A.31R.A41B.07","TCGA-PAAD: TCGA.2L.AAQI.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA-PAAD: TCGA.HZ.8317.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7897.01A.21R.2204.07","TCGA-PAAD: TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA-PAAD: TCGA.2L.AAQE.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.A77P.01A.11R.A33R.07","TCGA-PAAD: TCGA.IB.A7LX.01A.12R.A36G.07","TCGA-PAAD: TCGA.2J.AAB4.01A.12R.A41B.07","TCGA-PAAD: TCGA.FB.AAPP.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABT.01A.11R.A41B.07","TCGA-PAAD: TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.8315.01A.11R.2404.07","TCGA-PAAD: TCGA.XD.AAUG.01A.61R.A41B.07","TCGA-PAAD: TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7652.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA-PAAD: TCGA.HV.A5A4.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.7890.01A.12R.2204.07","TCGA-PAAD: TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA-PAAD: TCGA.IB.7644.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.A5SO.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AABI.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABO.01A.21R.A41B.07","TCGA-PAAD: TCGA.US.A779.01A.11R.A32O.07","TCGA-PAAD: TCGA.3A.A9IH.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.7919.01A.11R.2156.07","TCGA-PAAD: TCGA.HV.A5A6.01A.11R.A26U.07","TCGA-PAAD: TCGA.YH.A8SY.01A.11R.A37L.07","TCGA-PAAD: TCGA.F2.6879.01A.11R.2156.07","TCGA-PAAD: TCGA.3A.A9IU.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8X.01A.11R.A39D.07","TCGA-PAAD: TCGA.IB.8127.01A.11R.2404.07","TCGA-PAAD: TCGA.FB.AAPS.01A.12R.A39D.07","TCGA-PAAD: TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA-PAAD: TCGA.US.A77E.01A.11R.A32O.07","TCGA-PAAD: TCGA.F2.A44H.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9I5.01A.11R.A38C.07","TCGA-PAAD: TCGA.RB.AA9M.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.A7OP.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.A545.01A.11R.A26U.07","TCGA-PAAD: TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA-PAAD: TCGA.IB.8126.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.A5SP.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.8001.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABE.01A.12R.A41B.07","TCGA-PAAD: TCGA.3A.A9IL.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUN.01A.12R.A38C.07","TCGA-PAAD: TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA-PAAD: TCGA.2J.AABV.01A.12R.A41B.07","TCGA-PAAD: TCGA.XN.A8T3.01A.11R.A36G.07","TCGA-PAAD: TCGA.OE.A75W.01A.12R.A32O.07","TCGA-PAAD: TCGA.LB.A8F3.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.8636.01A.21R.2404.07","TCGA-PAAD: TCGA.XD.AAUL.01A.21R.A39D.07","TCGA-PAAD: TCGA.2L.AAQM.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9I7.01A.21R.A38C.07","TCGA-PAAD: TCGA.US.A776.01A.13R.A33R.07","TCGA-PAAD: TCGA.IB.A7M4.01A.11R.A36G.07","TCGA-PAAD: TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA-PAAD: TCGA.2L.AAQA.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7889.01A.11R.2156.07","TCGA-PAAD: TCGA.F2.A8YN.01A.11R.A37L.07","TCGA-PAAD: TCGA.YB.A89D.01A.12R.A36G.07","TCGA-PAAD: TCGA.3A.A9IS.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.A6UG.01A.32R.A33R.07","TCGA-PAAD: TCGA.FB.AAPY.01A.11R.A41B.07","TCGA-PAAD: TCGA.S4.A8RO.01A.12R.A37L.07","TCGA-PAAD: TCGA.HZ.8637.01A.11R.2404.07","TCGA-PAAD: TCGA.2J.AAB6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7886.01A.11R.2156.07","TCGA-PAAD: TCGA.H6.8124.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7891.01A.11R.2204.07","TCGA-PAAD: TCGA.H6.A45N.11A.12R.A26U.07","TCGA-PAAD: TCGA.HZ.7926.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7646.01A.11R.2156.07","TCGA-PAAD: TCGA.2J.AABR.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9J0.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7651.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.AAUU.01A.11R.A37L.07","TCGA-PAAD: TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA-PAAD: TCGA.IB.AAUS.01A.12R.A38C.07","TCGA-PAAD: TCGA.F2.A44G.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9IX.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA-PAAD: TCGA.US.A77G.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8005.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AAB8.01A.12R.A41B.07","TCGA-PAAD: TCGA.HV.A5A3.11A.11R.A26U.07","TCGA-PAAD: TCGA.YY.A8LH.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.A49G.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.A5VM.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7649.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.7925.01A.11R.2156.07","TCGA-PAAD: TCGA.FB.A78T.01A.12R.A32O.07","TCGA-PAAD: TCGA.HZ.7922.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77O.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.A5ST.01A.11R.A32O.07","TCGA-PAAD: TCGA.XD.AAUH.01A.42R.A41B.07","TCGA-PAAD: TCGA.HZ.8003.01A.21R.2204.07","TCGA-PAAD: TCGA.HV.A5A5.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.A5SS.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A49I.01A.12R.A26U.07","TCGA-PAAD: TCGA.H6.8124.11A.01R.2404.07","TCGA-PAAD: TCGA.HZ.8002.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA-PAAD: TCGA.FB.A4P5.01A.11R.A26U.07","TCGA-PAAD: TCGA.2J.AAB1.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAY.01A.11R.A38C.07","TCGA-PAAD: TCGA.L1.A7W4.01A.12R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.AAQ0.01A.31R.A41B.07"],"mode":"markers","marker":{"color":"rgba(30,144,255,1)","size":8,"opacity":0.7,"symbol":["circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"line":{"color":"rgba(30,144,255,1)"}},"type":"scatter3d","name":"TCGA-PAAD","textfont":{"color":"rgba(30,144,255,1)"},"error_y":{"color":"rgba(30,144,255,1)"},"error_x":{"color":"rgba(30,144,255,1)"},"line":{"color":"rgba(30,144,255,1)"},"frame":null},{"x":[28.3761904119425,3.70657659121272],"y":[-271.839201781264,-20.6361946440352],"z":[10.1288467931282,-31.6294167622333],"text":["Avner: CCR170093_RNA_WPT_013","Avner: CCR170012_MH17T001P013"],"mode":"markers","marker":{"color":"rgba(178,34,34,1)","size":8,"opacity":0.7,"symbol":["square","square"],"line":{"color":"rgba(178,34,34,1)"}},"type":"scatter3d","name":"Avner","textfont":{"color":"rgba(178,34,34,1)"},"error_y":{"color":"rgba(178,34,34,1)"},"error_x":{"color":"rgba(178,34,34,1)"},"line":{"color":"rgba(178,34,34,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save PCA plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_PCA_3d_datasets.html"), selfcontained = TRUE)
```


Below we plot all combinations between the first 5 principal components (PCs), which may help in identifying which PCs explain the biological and/or batch effects.


```r
##### Plot all combinations between the first 5 PCs
##### Preapre colours for plot exis
axis = list(showline=FALSE, zeroline=FALSE, gridcolor='#ffff', ticklen=5)

p <- as.data.frame(y.norm.cpm.subset_pca$x[,1:5]) %>%
  plot_ly(width = 800, height = 800) %>%
  add_trace( type = 'splom', dimensions = list(
      list(label='PC1', values=~PC1), list(label='PC2', values=~PC2), list(label='PC3', values=~PC3), list(label='PC4', values=~PC4), list(label='PC5', values=~PC5)
    ),
  text=paste(targetFile$Dataset, rownames(y.norm.cpm.subset_pca$x), sep=": "),
    marker = list( color = datasets.colour[[2]], size = 7, opacity = 0.7
    )
  ) %>%
  layout(
    title= "",
    hovermode="closest",
    plot_bgcolor="rgba(240,240,240, 0.95)",
    xaxis=list(domain=NULL, showline=F, zeroline=F, gridcolor='#ffff', ticklen=4),
    yaxis=list(domain=NULL, showline=F, zeroline=F, gridcolor='#ffff', ticklen=4),
    xaxis2=axis, xaxis3=axis, xaxis4=axis, xaxis5=axis, yaxis2=axis, yaxis3=axis, yaxis4=axis, yaxis5=axis
)

p
```

<!--html_preserve--><div id="htmlwidget-f64177f320aea6b2c34f" style="width:800px;height:800px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f64177f320aea6b2c34f">{"x":{"visdat":{"1c251cd5eb2":["function () ","plotlyVisDat"]},"cur_data":"1c251cd5eb2","attrs":{"1c251cd5eb2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"splom","dimensions":[{"label":"PC1","values":{}},{"label":"PC2","values":{}},{"label":"PC3","values":{}},{"label":"PC4","values":{}},{"label":"PC5","values":{}}],"text":["TCGA-PAAD: TCGA.IB.AAUO.01A.12R.A38C.07","TCGA-PAAD: TCGA.3A.A9I9.01A.11R.A38C.07","TCGA-PAAD: TCGA.HZ.8519.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7885.01A.11R.2156.07","TCGA-PAAD: TCGA.US.A774.01A.21R.A32O.07","TCGA-PAAD: TCGA.S4.A8RM.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IR.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA-PAAD: TCGA.2J.AABA.01A.21R.A41B.07","TCGA-PAAD: TCGA.M8.A5N4.01A.11R.A26U.07","TCGA-PAAD: TCGA.2L.AAQL.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7645.01A.22R.2204.07","TCGA-PAAD: TCGA.2J.AABU.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9IV.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.AAUR.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7887.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7893.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABF.01A.31R.A41B.07","TCGA-PAAD: TCGA.3A.A9IN.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8V.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7888.01A.11R.2156.07","TCGA-PAAD: TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AAB9.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.A6UF.01A.23R.A33R.07","TCGA-PAAD: TCGA.HV.A5A3.01A.11R.A26U.07","TCGA-PAAD: TCGA.S4.A8RP.01A.11R.A36G.07","TCGA-PAAD: TCGA.F2.A7TX.01A.33R.A38C.07","TCGA-PAAD: TCGA.HV.A7OL.01A.11R.A33R.07","TCGA-PAAD: TCGA.HZ.A49H.01A.11R.A26U.07","TCGA-PAAD: TCGA.XN.A8T5.01A.12R.A36G.07","TCGA-PAAD: TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA-PAAD: TCGA.LB.A7SX.01A.11R.A33R.07","TCGA-PAAD: TCGA.YB.A89D.11A.11R.A36G.07","TCGA-PAAD: TCGA.RB.A7B8.01A.12R.A33R.07","TCGA-PAAD: TCGA.XD.AAUI.01A.42R.A41B.07","TCGA-PAAD: TCGA.2J.AABH.01A.21R.A41B.07","TCGA-PAAD: TCGA.3A.A9IO.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUP.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IB.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.AAUT.01A.11R.A37L.07","TCGA-PAAD: TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABK.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.AAUM.01A.11R.A37L.07","TCGA-PAAD: TCGA.FB.A4P6.01A.12R.A26U.07","TCGA-PAAD: TCGA.3A.A9IC.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAPU.01A.31R.A41B.07","TCGA-PAAD: TCGA.2L.AAQI.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA-PAAD: TCGA.HZ.8317.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7897.01A.21R.2204.07","TCGA-PAAD: TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA-PAAD: TCGA.2L.AAQE.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.A77P.01A.11R.A33R.07","TCGA-PAAD: TCGA.IB.A7LX.01A.12R.A36G.07","TCGA-PAAD: TCGA.2J.AAB4.01A.12R.A41B.07","TCGA-PAAD: TCGA.FB.AAPP.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABT.01A.11R.A41B.07","TCGA-PAAD: TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.8315.01A.11R.2404.07","TCGA-PAAD: TCGA.XD.AAUG.01A.61R.A41B.07","TCGA-PAAD: TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7652.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA-PAAD: TCGA.HV.A5A4.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.7890.01A.12R.2204.07","TCGA-PAAD: TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA-PAAD: TCGA.IB.7644.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.A5SO.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AABI.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABO.01A.21R.A41B.07","TCGA-PAAD: TCGA.US.A779.01A.11R.A32O.07","TCGA-PAAD: TCGA.3A.A9IH.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.7919.01A.11R.2156.07","TCGA-PAAD: TCGA.HV.A5A6.01A.11R.A26U.07","TCGA-PAAD: TCGA.YH.A8SY.01A.11R.A37L.07","TCGA-PAAD: TCGA.F2.6879.01A.11R.2156.07","TCGA-PAAD: TCGA.3A.A9IU.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8X.01A.11R.A39D.07","TCGA-PAAD: TCGA.IB.8127.01A.11R.2404.07","TCGA-PAAD: TCGA.FB.AAPS.01A.12R.A39D.07","TCGA-PAAD: TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA-PAAD: TCGA.US.A77E.01A.11R.A32O.07","TCGA-PAAD: TCGA.F2.A44H.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9I5.01A.11R.A38C.07","TCGA-PAAD: TCGA.RB.AA9M.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.A7OP.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.A545.01A.11R.A26U.07","TCGA-PAAD: TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA-PAAD: TCGA.IB.8126.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.A5SP.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.8001.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABE.01A.12R.A41B.07","TCGA-PAAD: TCGA.3A.A9IL.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUN.01A.12R.A38C.07","TCGA-PAAD: TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA-PAAD: TCGA.2J.AABV.01A.12R.A41B.07","TCGA-PAAD: TCGA.XN.A8T3.01A.11R.A36G.07","TCGA-PAAD: TCGA.OE.A75W.01A.12R.A32O.07","TCGA-PAAD: TCGA.LB.A8F3.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.8636.01A.21R.2404.07","TCGA-PAAD: TCGA.XD.AAUL.01A.21R.A39D.07","TCGA-PAAD: TCGA.2L.AAQM.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9I7.01A.21R.A38C.07","TCGA-PAAD: TCGA.US.A776.01A.13R.A33R.07","TCGA-PAAD: TCGA.IB.A7M4.01A.11R.A36G.07","TCGA-PAAD: TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA-PAAD: TCGA.2L.AAQA.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7889.01A.11R.2156.07","TCGA-PAAD: TCGA.F2.A8YN.01A.11R.A37L.07","TCGA-PAAD: TCGA.YB.A89D.01A.12R.A36G.07","TCGA-PAAD: TCGA.3A.A9IS.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.A6UG.01A.32R.A33R.07","TCGA-PAAD: TCGA.FB.AAPY.01A.11R.A41B.07","TCGA-PAAD: TCGA.S4.A8RO.01A.12R.A37L.07","TCGA-PAAD: TCGA.HZ.8637.01A.11R.2404.07","TCGA-PAAD: TCGA.2J.AAB6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7886.01A.11R.2156.07","TCGA-PAAD: TCGA.H6.8124.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7891.01A.11R.2204.07","TCGA-PAAD: TCGA.H6.A45N.11A.12R.A26U.07","TCGA-PAAD: TCGA.HZ.7926.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7646.01A.11R.2156.07","TCGA-PAAD: TCGA.2J.AABR.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9J0.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7651.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.AAUU.01A.11R.A37L.07","TCGA-PAAD: TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA-PAAD: TCGA.IB.AAUS.01A.12R.A38C.07","TCGA-PAAD: TCGA.F2.A44G.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9IX.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA-PAAD: TCGA.US.A77G.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8005.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AAB8.01A.12R.A41B.07","TCGA-PAAD: TCGA.HV.A5A3.11A.11R.A26U.07","TCGA-PAAD: TCGA.YY.A8LH.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.A49G.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.A5VM.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7649.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.7925.01A.11R.2156.07","TCGA-PAAD: TCGA.FB.A78T.01A.12R.A32O.07","TCGA-PAAD: TCGA.HZ.7922.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77O.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.A5ST.01A.11R.A32O.07","TCGA-PAAD: TCGA.XD.AAUH.01A.42R.A41B.07","TCGA-PAAD: TCGA.HZ.8003.01A.21R.2204.07","TCGA-PAAD: TCGA.HV.A5A5.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.A5SS.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A49I.01A.12R.A26U.07","TCGA-PAAD: TCGA.H6.8124.11A.01R.2404.07","TCGA-PAAD: TCGA.HZ.8002.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA-PAAD: TCGA.FB.A4P5.01A.11R.A26U.07","TCGA-PAAD: TCGA.2J.AAB1.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAY.01A.11R.A38C.07","TCGA-PAAD: TCGA.L1.A7W4.01A.12R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.AAQ0.01A.31R.A41B.07","Avner: CCR170093_RNA_WPT_013","Avner: CCR170012_MH17T001P013"],"marker":{"color":["dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","firebrick","firebrick"],"size":7,"opacity":0.7},"inherit":true}},"layout":{"width":800,"height":800,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"","hovermode":"closest","plot_bgcolor":"rgba(240,240,240, 0.95)","xaxis":{"domain":[],"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":4},"yaxis":{"domain":[],"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":4},"xaxis2":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"xaxis3":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"xaxis4":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"xaxis5":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"yaxis2":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"yaxis3":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"yaxis4":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"yaxis5":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"type":"splom","dimensions":[{"label":"PC1","values":[-39.5096329738213,-0.9505355203886,80.2127705047868,-46.6230272166826,-27.1441323826728,-33.405260943958,254.460947231326,267.88992161989,-34.0023167958671,-55.3480676372859,-5.60915111816782,-23.6603991658158,-1.73724967460498,-44.1529304681383,224.453407921171,-31.4517058117416,-27.3741670418291,8.95319781501381,-48.7635072481656,-18.6611006738754,-10.8112677324935,205.494928124774,-21.7235872145004,-25.7935281045507,22.5336300615491,-51.2106961117494,-4.75603870600442,-21.3782025618893,-51.0637610497309,-8.40918772983574,-9.62561098082745,-55.1413865942984,17.2780844973726,29.7644621792625,-0.599146807661378,-26.0403425923249,-18.5291516603558,-22.2591111664937,-15.6396539159804,-5.47469531112594,224.979561127269,-11.2446478790358,-22.8484060882454,17.2106872488172,-2.52297915054892,18.8700354963358,25.2036386603,16.6812598620333,-37.9148215642545,-33.0443803562137,-16.8226751641533,-8.30164988472832,-11.9588165083182,67.4957652118502,-27.0466788657155,-32.2849438435798,15.2220232259752,-39.3760650643882,-11.0314730731224,25.0409903306279,6.64538342370945,2.31070894211073,-34.2422879349515,39.5548849803914,37.0912017070588,-5.17510042752755,-38.595908396523,-20.8868625337465,-1.06787109830572,-9.70080534427894,-40.4470566422701,-17.433622191752,-9.30737146604097,-11.9030176002842,-6.50445511943287,-13.5967922314083,-36.7969011077622,-33.3578684842641,-55.158622958603,-46.7913639046901,-40.053807011482,-28.5007568946637,-44.5965513819438,2.88966076089788,-43.9403545793389,-27.895206833818,14.0534016337911,48.8322490551398,18.666778519432,40.6256668841229,-22.7207085825641,-50.0016980143501,35.1917082529504,-19.5596616917483,12.5427537830307,19.9847552302763,-36.0590582414961,198.247287550819,-28.426362759485,-59.3563817822117,18.5140763076994,12.548483996723,-44.886876885917,23.7435159342809,-23.3523525453009,-33.6454088392129,223.80018994889,-27.8943798117145,26.6914988763467,-41.8186105096457,-45.2332689447674,-63.6129891062409,-23.9949036163229,-56.4386454233988,-18.409584919232,316.804873693753,-3.61490628635037,-28.4664778938386,-15.2809885879065,28.0712787550042,-5.72502772557059,-47.8378725517243,-13.8703310029183,0.0836406521641423,89.4220691900872,-34.1986729312702,-29.0339058245327,3.08077895985972,-56.1190496657094,-10.6610156191389,-33.1059208412153,-24.9183301808939,-17.8165375537453,-54.9078329721756,4.78773455576834,-16.4672550332323,-2.80010447463,-24.7980389455741,-20.8239609548476,-50.3351268187208,39.1939807238073,-34.1326482882487,-3.66868407496047,-1.48495068372064,-2.0057179917184,-20.1802101973969,-18.4501134088173,-31.3268296852103,-31.2466950492202,12.6143352842551,-17.2489615674335,64.7407938131919,22.3855394502879,11.5118758656272,-29.6793672635051,-23.0190198633823,44.5426805875147,22.8590441054633,-17.8902878778119,2.6842240602341,-32.1569787115552,-6.39955696632374,6.17368294369863,5.64165749724985,-48.0795303820063,28.3761904119425,3.70657659121272]},{"label":"PC2","values":[-34.399269297641,23.2053421393136,58.8662840107597,27.5560235691365,56.2020593453304,-59.2321436665237,-81.1441830815798,-56.7030467758504,-8.75882545773145,-55.373018967477,9.04771077484417,-66.2387779270581,69.5120956588285,-38.0471354434322,-51.1228411552338,-44.065536176215,16.0489669837953,60.9218515939107,-29.7398154560986,14.340222180226,36.0645822796106,20.0644929603723,22.5272376108219,18.0140903654966,81.4420522012264,-31.7502152942052,54.6965414822371,-26.5580751011711,-76.701521149603,14.5638653808841,34.726874436223,-37.8658598190469,80.1206935775191,52.1020823347876,-12.0106311201158,-35.461679374984,48.7984125678722,-1.18392140635895,34.6929673302986,1.56239226147181,-6.45521730326628,60.4572973418011,9.15822305935094,73.8838276282681,15.342749763907,9.31613946784426,53.8214209466886,44.601968302529,-17.2799534289966,-86.5527312034837,7.59482346797364,27.2242059327944,35.5392214927861,101.961830622603,-84.0338710447212,-41.6734377551029,37.7134321048641,-53.0005107116629,6.06592702479911,-210.6638900255,5.3746657533973,53.2769460110038,38.0335713461849,83.2400960801393,53.867850847346,52.3972236258561,32.0309063278044,-6.28128059700764,23.8137275934406,44.0114600492213,-34.6680652507444,52.0932320779514,-44.9894188560586,17.2751288807307,-54.3840258252979,-12.4465964127922,19.0787450981375,-66.0691782916553,-35.2066389950616,-81.0699372074134,-5.02806569061731,-54.8024505705096,15.9763424903294,62.6611544430876,-38.6469120267407,-33.9960994351649,46.7416433229874,1.20847405160905,25.5660347004922,-146.020148943408,-43.6197230546796,-66.4966711314414,95.2208292015278,-43.5930056753265,-57.5673900379553,77.4700932435424,-11.3892794250771,-2.56315721580087,19.6717675707837,-26.3438773809578,5.8838685215405,34.4589743793149,-55.3790962964125,-19.2926501695037,23.3981860558057,4.61464494056441,-66.520607816587,21.225066817134,-121.287921869455,-22.2314913966622,-52.8509484580436,-77.6108269508814,45.482710368137,-40.9444702445933,30.6031860766845,-102.234655613013,20.2122681701092,25.5432989141772,-25.8828550842807,59.4840091122676,-17.4115264842447,-2.40434474086709,-31.1383048407228,91.1695350499447,32.1695564435801,19.6297019982158,-11.0581570221627,69.1685628708782,-40.1681676374665,32.611924247639,-10.8533495870535,2.7489293718562,60.0217866782442,-29.6609083770713,81.8402141841094,-1.719690277714,20.4655551898078,-61.9897229090999,-39.9309189158507,-37.6910386009108,46.39511808786,-83.0968141117788,57.4628331009818,7.81618925686741,86.2330855815594,6.41306788451144,-13.9786072997683,41.9887442078321,1.38619416201718,-35.2866240165053,44.0794998113294,74.5068147205299,97.9356664692912,43.2927233207322,-29.2511422806137,-1.04061452782688,79.5899759522146,87.0597418345398,-45.7091182819685,76.4139972846996,-5.06767491271939,43.270407728351,-58.7935056986307,57.1003244277275,-124.284983123327,-271.839201781264,-20.6361946440352]},{"label":"PC3","values":[14.4433746194537,73.6419075468557,-4.12252884625644,-36.7947656638453,22.5727893369401,28.7169616918795,-28.4218023447517,3.31215691523526,-39.4078582941947,-58.9996912372938,61.4324270329008,15.2521692846821,-53.959114213929,-65.7353834676327,-28.5393583639167,39.6210957405027,31.7618640297212,-71.5792472612978,-37.6514273971197,-95.1231244009534,32.5707614739835,-24.1704954688484,-2.574684546356,13.0922985049363,-44.4893671801986,-13.9587533709559,38.5884160835129,36.941494391536,-8.3852512622659,44.1424760162707,13.5068740069953,-11.5832324202859,30.8628694026069,-49.8798239960916,44.3342736019198,-5.97102487390717,-17.0217230182258,-21.0580644022308,15.1297616269398,60.6493690305427,43.9667191049479,-56.2334306349418,-4.6068594251015,41.0015671218337,-109.054207823621,80.9268686777502,75.5133413176364,55.4830560245933,-32.1293381169056,24.5929361456099,60.9990195385238,-32.7920837014595,49.5886917447029,-41.3231824063551,46.6687316045696,-36.9248263153452,22.1189297573828,-14.2461822315398,53.8633653758892,8.79742089194846,-45.1236374803291,59.8153519722351,0.0135359214998918,-6.76611766547812,-38.1747311310124,19.6016745816593,-90.6912775665534,16.189435473157,-72.0117269852754,-102.248604168908,-8.07576579188661,-10.5980105320371,-95.4005387397385,25.4812990585129,75.4785471232121,19.5372797228912,9.75130660414105,-20.0905953527906,-68.6371540818144,-26.1423509665497,10.3865879641954,29.4705200001886,0.839621816476604,-37.0694556283622,52.5820731398342,8.93703687063038,36.7947788858545,32.7422791245015,14.0083360114318,33.9085738513744,-4.31893007339812,-12.6896410349944,44.4877288723771,70.2718213445726,-14.1878488007826,-22.7700142250266,3.7295314892925,17.5694258850915,31.7747172509015,-19.4460144143153,111.738072057527,25.968763861394,18.165082632402,76.4826284442393,-16.8851538144735,9.87926412703678,-9.02508367243031,-8.33266671333825,2.59585121700165,-8.25338860921372,12.8437099174172,3.10817159469454,21.4563783410558,-9.20992999893639,-1.56785615841894,-18.9613086988743,50.3973610319599,36.642141081662,7.67072835350195,-37.9477057339374,-35.9906553647311,-21.0139405243512,-19.707933526554,18.0597172531909,-134.353633977014,19.0242133864905,-84.771024981342,30.3969781898882,-50.7332736986664,-14.5479895233108,40.6186909069621,25.5073464526351,-44.8650287388969,1.00655755244037,22.5116314870241,6.73443373517409,-0.315216694059143,80.9949060018774,-100.950056308057,-57.0796881199647,29.0377604141077,35.5597222949769,45.1438885003671,-54.8113255224926,27.008730667217,-61.963057364094,75.5154122559307,-20.126026617202,45.1529966164939,-35.834828186381,-85.97003204647,-31.9784738544035,23.9461482235661,43.4084692212702,-86.6197348959631,-1.62067694843777,9.13084986437795,5.78710548786037,13.4674818908744,-1.08255177661878,38.0988458004362,39.7781655235771,-76.0053095323458,27.1919885499744,15.7077253517216,10.1288467931282,-31.6294167622333]},{"label":"PC4","values":[-30.5215179528616,-18.1148134083211,9.98000473162354,10.7868406079264,3.22406818584532,4.76421866250625,-20.5237060417052,-28.603203398937,-14.2412865136295,-7.91472363706741,-44.2433085188953,-14.094828774041,27.5152100534478,0.836379455420395,58.011188992471,14.3647549662214,-11.9265711865363,-63.0451924930352,23.2407003252296,95.9033811884572,-3.33690439189445,-27.3292536210579,-4.00809751044514,7.99387042664518,26.0530595049254,-17.3033552626164,9.69103665709617,9.14770163953408,0.587373218480175,-4.45201693456038,26.9420589675493,-88.0722191990734,-22.3638129986194,-29.463850118304,0.871833690572151,-33.7619910645081,-14.3781621948211,-27.1749806363972,-20.3890355393125,8.82158005547739,22.2569217720667,-37.6893609578941,22.5967514098125,-10.1254183564262,-71.9185987789307,-13.4104741810934,-12.4374461235002,6.79889822704671,-12.3700253815585,-2.77997428556688,24.8036286007148,-10.3345972243542,32.6298074205701,40.7624381819586,1.857387378923,-15.9288871201071,-2.19904793160285,10.1176848801939,8.12180325979207,6.47974101253709,-9.18671367801601,17.5459268100355,22.5748174911913,3.77865975073175,5.48951638835358,56.168131321937,-18.9391321428908,-11.6380596117443,66.0379163726169,-88.9990524131379,42.9816504873411,-16.4132053360349,-37.3107575906327,7.55104633593584,-30.064939400796,7.41306593965474,54.0413520614315,-0.83815112106209,-9.79931891917338,52.0486322655208,10.7410748565438,13.3307873006739,24.1032912369756,-29.4047443813027,-8.56693718797626,-0.964175814834657,12.4702171397645,-50.9000470804405,12.4843660865634,-116.87375401615,19.6231835363298,-37.4961021031799,16.5608891192151,4.29762675722137,-3.78110722223915,-19.7781957328296,-6.63503651933671,-7.45589686832821,15.8645185617458,-15.5845463682043,-59.3226556037017,8.92681390181989,-70.2703060159993,-22.371861917992,35.0740641688898,5.49828561929506,-17.5366513595037,-17.6502253446894,-41.4818913144677,-16.8437921885901,29.7225997026709,1.0012648090561,2.65666833776791,7.70905410876491,1.97394481876149,56.0854381914231,-13.7789263175618,-47.2649185,2.67435146456274,-11.6302748341639,20.3986976219694,45.3173931487574,46.6112599567345,53.2914401271107,-88.5870484258858,35.2332699456002,84.6474010432368,9.51641484180396,-26.8494726494928,42.0092584645978,4.05082127712511,-23.5950065750152,-20.2518969190238,12.4874342754209,6.81661661348944,-2.27245996431234,-7.89058698538117,-0.718373467556169,44.820000637312,-15.2592490874489,-4.04038606394445,-27.8778939355003,2.06632115664285,-62.2561125927123,54.5460453371818,42.7132065380241,-10.4608385101549,62.2883230456609,12.1102468744215,3.80260734301835,-43.4063686063914,-26.6590348406037,37.2430676070774,0.828622530620896,41.1723915463002,-33.194213087384,28.5943858779843,44.6738589008831,-4.43517899067233,-32.5828503341628,-6.91633378029485,-27.6508852661345,22.4025371546269,-8.71458074288857,-7.30397179125085,123.707249114168,41.2224318632558]},{"label":"PC5","values":[18.4170734310273,11.5051612842814,-4.7925279647287,-3.89649078116424,-17.74948358358,-55.4784862960605,-25.6623518535527,66.131193758933,-17.2683836262269,2.06157775802756,39.2617987304432,7.17557618877806,-37.1152363170002,25.904164677542,27.3689898075814,2.66728882985467,-19.2092879873178,-34.248932207647,-2.5431336301628,45.2700031805006,-14.9248405228694,25.1778830678485,27.4134296673518,0.941336211243048,-33.645215021755,26.8723538421424,10.8208606305253,26.2695573336696,34.6193764748997,-11.1100350733611,0.23732760290092,29.117030679578,-19.6351867971589,-6.30256205212752,30.6869597271236,-13.1374895980657,21.1917515813206,2.22949457603004,7.21439442635967,11.9817928678678,9.91620052371146,-41.468042986841,31.7474691255467,-20.7171822370073,-92.1352454058494,-2.19591544374197,-32.4523388787636,-26.4213628088597,35.3020374957098,-37.0237243685272,6.93916808572545,4.2586318413741,-32.6400698379847,-28.8068831107158,-30.2056279297134,11.65275429131,-10.1518608078583,23.0994956468963,14.0827173337597,-92.8826768873348,-30.0712707074461,0.136015093299594,-16.2715635261852,14.6130649697854,38.8510618238409,-10.5264290067589,-9.70725185275789,4.54728827441891,49.9827004705704,-41.2784625264701,-32.4043375255294,3.90712604515392,18.5623704273976,31.647027672196,4.2619817420399,31.9345751975395,-9.45026022355376,17.7222433513217,49.6862240022134,-7.34978061623089,23.0310822453481,0.697841254044266,-5.01983397816441,12.9539356902652,23.6750801222238,6.98683419330688,21.4342706892128,33.9380833779324,19.2529526823178,13.0194149226599,40.5288497673427,-13.4710196090663,-50.1734900086342,-1.80088597220591,2.6909405674762,36.5290591711711,20.0715058710469,16.074332669236,2.79234960492672,-24.1723829483961,10.2092698571679,31.0626232465906,44.7302297543057,24.7146757270733,2.52850492935326,23.5679124063578,19.4656074101333,-16.7149074560156,-71.8282795021967,7.92179810854001,18.4172724676139,2.42292173453235,-9.53438110291865,21.1832940100514,27.7804252608426,14.9654205198751,-7.83764483284608,-6.28086301725921,19.2909051794232,-49.7431215413048,87.9561932175601,-22.7233811704872,44.5753998177566,-25.5815819973517,-123.368533920767,-38.4742113544572,26.1102881339544,-10.0797539329718,-3.73083450609542,-17.6451016146003,2.76296417655553,-0.188976107841715,2.87166958763987,7.37764133022596,-18.1836337845352,-10.2363688348357,46.0410315548913,-33.8953932990309,48.9644981822648,-7.94741639076982,3.00043423424566,-8.98342382651689,-14.2313860128921,70.6631111760367,-21.2604341214747,20.7180150692023,-21.0055998696374,-12.0395985943602,21.637558227619,44.9092906556806,-46.7331331146091,-6.51818728789057,-36.7563210636765,-0.415665318505501,56.3373180984851,-2.33123241560257,-9.44892246409976,-23.5148744804373,-4.17165792411087,-8.72446843911549,-10.978023509373,-7.45715362379176,45.6214238766654,1.35248537234653,2.37432056834147,-132.99330248502,-121.522255034709]}],"text":["TCGA-PAAD: TCGA.IB.AAUO.01A.12R.A38C.07","TCGA-PAAD: TCGA.3A.A9I9.01A.11R.A38C.07","TCGA-PAAD: TCGA.HZ.8519.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7885.01A.11R.2156.07","TCGA-PAAD: TCGA.US.A774.01A.21R.A32O.07","TCGA-PAAD: TCGA.S4.A8RM.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IR.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA-PAAD: TCGA.2J.AABA.01A.21R.A41B.07","TCGA-PAAD: TCGA.M8.A5N4.01A.11R.A26U.07","TCGA-PAAD: TCGA.2L.AAQL.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7645.01A.22R.2204.07","TCGA-PAAD: TCGA.2J.AABU.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9IV.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.AAUR.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7887.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7893.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABF.01A.31R.A41B.07","TCGA-PAAD: TCGA.3A.A9IN.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8V.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7888.01A.11R.2156.07","TCGA-PAAD: TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AAB9.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.A6UF.01A.23R.A33R.07","TCGA-PAAD: TCGA.HV.A5A3.01A.11R.A26U.07","TCGA-PAAD: TCGA.S4.A8RP.01A.11R.A36G.07","TCGA-PAAD: TCGA.F2.A7TX.01A.33R.A38C.07","TCGA-PAAD: TCGA.HV.A7OL.01A.11R.A33R.07","TCGA-PAAD: TCGA.HZ.A49H.01A.11R.A26U.07","TCGA-PAAD: TCGA.XN.A8T5.01A.12R.A36G.07","TCGA-PAAD: TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA-PAAD: TCGA.LB.A7SX.01A.11R.A33R.07","TCGA-PAAD: TCGA.YB.A89D.11A.11R.A36G.07","TCGA-PAAD: TCGA.RB.A7B8.01A.12R.A33R.07","TCGA-PAAD: TCGA.XD.AAUI.01A.42R.A41B.07","TCGA-PAAD: TCGA.2J.AABH.01A.21R.A41B.07","TCGA-PAAD: TCGA.3A.A9IO.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUP.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IB.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.AAUT.01A.11R.A37L.07","TCGA-PAAD: TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABK.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.AAUM.01A.11R.A37L.07","TCGA-PAAD: TCGA.FB.A4P6.01A.12R.A26U.07","TCGA-PAAD: TCGA.3A.A9IC.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAPU.01A.31R.A41B.07","TCGA-PAAD: TCGA.2L.AAQI.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA-PAAD: TCGA.HZ.8317.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7897.01A.21R.2204.07","TCGA-PAAD: TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA-PAAD: TCGA.2L.AAQE.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.A77P.01A.11R.A33R.07","TCGA-PAAD: TCGA.IB.A7LX.01A.12R.A36G.07","TCGA-PAAD: TCGA.2J.AAB4.01A.12R.A41B.07","TCGA-PAAD: TCGA.FB.AAPP.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABT.01A.11R.A41B.07","TCGA-PAAD: TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.8315.01A.11R.2404.07","TCGA-PAAD: TCGA.XD.AAUG.01A.61R.A41B.07","TCGA-PAAD: TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7652.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA-PAAD: TCGA.HV.A5A4.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.7890.01A.12R.2204.07","TCGA-PAAD: TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA-PAAD: TCGA.IB.7644.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.A5SO.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AABI.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABO.01A.21R.A41B.07","TCGA-PAAD: TCGA.US.A779.01A.11R.A32O.07","TCGA-PAAD: TCGA.3A.A9IH.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.7919.01A.11R.2156.07","TCGA-PAAD: TCGA.HV.A5A6.01A.11R.A26U.07","TCGA-PAAD: TCGA.YH.A8SY.01A.11R.A37L.07","TCGA-PAAD: TCGA.F2.6879.01A.11R.2156.07","TCGA-PAAD: TCGA.3A.A9IU.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8X.01A.11R.A39D.07","TCGA-PAAD: TCGA.IB.8127.01A.11R.2404.07","TCGA-PAAD: TCGA.FB.AAPS.01A.12R.A39D.07","TCGA-PAAD: TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA-PAAD: TCGA.US.A77E.01A.11R.A32O.07","TCGA-PAAD: TCGA.F2.A44H.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9I5.01A.11R.A38C.07","TCGA-PAAD: TCGA.RB.AA9M.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.A7OP.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.A545.01A.11R.A26U.07","TCGA-PAAD: TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA-PAAD: TCGA.IB.8126.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.A5SP.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.8001.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABE.01A.12R.A41B.07","TCGA-PAAD: TCGA.3A.A9IL.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUN.01A.12R.A38C.07","TCGA-PAAD: TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA-PAAD: TCGA.2J.AABV.01A.12R.A41B.07","TCGA-PAAD: TCGA.XN.A8T3.01A.11R.A36G.07","TCGA-PAAD: TCGA.OE.A75W.01A.12R.A32O.07","TCGA-PAAD: TCGA.LB.A8F3.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.8636.01A.21R.2404.07","TCGA-PAAD: TCGA.XD.AAUL.01A.21R.A39D.07","TCGA-PAAD: TCGA.2L.AAQM.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9I7.01A.21R.A38C.07","TCGA-PAAD: TCGA.US.A776.01A.13R.A33R.07","TCGA-PAAD: TCGA.IB.A7M4.01A.11R.A36G.07","TCGA-PAAD: TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA-PAAD: TCGA.2L.AAQA.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7889.01A.11R.2156.07","TCGA-PAAD: TCGA.F2.A8YN.01A.11R.A37L.07","TCGA-PAAD: TCGA.YB.A89D.01A.12R.A36G.07","TCGA-PAAD: TCGA.3A.A9IS.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.A6UG.01A.32R.A33R.07","TCGA-PAAD: TCGA.FB.AAPY.01A.11R.A41B.07","TCGA-PAAD: TCGA.S4.A8RO.01A.12R.A37L.07","TCGA-PAAD: TCGA.HZ.8637.01A.11R.2404.07","TCGA-PAAD: TCGA.2J.AAB6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7886.01A.11R.2156.07","TCGA-PAAD: TCGA.H6.8124.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7891.01A.11R.2204.07","TCGA-PAAD: TCGA.H6.A45N.11A.12R.A26U.07","TCGA-PAAD: TCGA.HZ.7926.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7646.01A.11R.2156.07","TCGA-PAAD: TCGA.2J.AABR.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9J0.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7651.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.AAUU.01A.11R.A37L.07","TCGA-PAAD: TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA-PAAD: TCGA.IB.AAUS.01A.12R.A38C.07","TCGA-PAAD: TCGA.F2.A44G.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9IX.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA-PAAD: TCGA.US.A77G.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8005.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AAB8.01A.12R.A41B.07","TCGA-PAAD: TCGA.HV.A5A3.11A.11R.A26U.07","TCGA-PAAD: TCGA.YY.A8LH.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.A49G.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.A5VM.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7649.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.7925.01A.11R.2156.07","TCGA-PAAD: TCGA.FB.A78T.01A.12R.A32O.07","TCGA-PAAD: TCGA.HZ.7922.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77O.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.A5ST.01A.11R.A32O.07","TCGA-PAAD: TCGA.XD.AAUH.01A.42R.A41B.07","TCGA-PAAD: TCGA.HZ.8003.01A.21R.2204.07","TCGA-PAAD: TCGA.HV.A5A5.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.A5SS.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A49I.01A.12R.A26U.07","TCGA-PAAD: TCGA.H6.8124.11A.01R.2404.07","TCGA-PAAD: TCGA.HZ.8002.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA-PAAD: TCGA.FB.A4P5.01A.11R.A26U.07","TCGA-PAAD: TCGA.2J.AAB1.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAY.01A.11R.A38C.07","TCGA-PAAD: TCGA.L1.A7W4.01A.12R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.AAQ0.01A.31R.A41B.07","Avner: CCR170093_RNA_WPT_013","Avner: CCR170012_MH17T001P013"],"marker":{"color":["dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","dodgerblue","firebrick","firebrick"],"size":7,"opacity":0.7,"line":{"color":"rgba(31,119,180,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save pairwise PCA plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_PCA_pairwise_datasets.html"), selfcontained = TRUE)


##### Plot all combinations between the first 5 PCs
#pairs(y.norm.cpm.subset_pca$x[,1:5], pch=16, col=datasets.colour[[2]])

##### Save the plot as pdf file
#pdf(paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_PCA_pairwise_datasets.pdf"), width=10, height=10)
#pairs(y.norm.cpm.subset_pca$x[,1:5], pch=16, col=datasets.colour[[2]])
#invisible(dev.off())
```


The global variability of the data can also be assessed from the scree plot. Here, you can identify the fraction of total variance (y-axis) attributed to each PC (x-axis). The PCs are ordered by decreasing order of contribution to total variance. 


```r
##### Generate scree plot
##### Prepare data frame
y.norm.cpm.subset_scree.df <- data.frame(paste0("PC ", c(1:length(y.norm.cpm.subset_pca$sdev))), y.norm.cpm.subset_pca$sdev)
colnames(y.norm.cpm.subset_scree.df) <- c("PC", "Variances")

##### The default order will be alphabetized unless specified as below
y.norm.cpm.subset_scree.df$PC <- factor(y.norm.cpm.subset_scree.df$PC, levels = y.norm.cpm.subset_scree.df[["PC"]])

##### Generate scree plot
p <- plot_ly(y.norm.cpm.subset_scree.df, x = ~PC, y = ~Variances, type = 'bar', width = 600, height = 400) %>%
  layout(title = "The variances captured by principal components", xaxis = list(title = ""), margin = list(l=50, r=50, b=100, t=100, pad=4), autosize = F)

p
```

<!--html_preserve--><div id="htmlwidget-b10b3e8bb5c2da0e5193" style="width:600px;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b10b3e8bb5c2da0e5193">{"x":{"visdat":{"1c2548b6bcb":["function () ","plotlyVisDat"]},"cur_data":"1c2548b6bcb","attrs":{"1c2548b6bcb":{"x":{},"y":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":600,"height":400,"margin":{"b":100,"l":50,"t":100,"r":50,"pad":4},"title":"The variances captured by principal components","xaxis":{"domain":[0,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["PC 1","PC 2","PC 3","PC 4","PC 5","PC 6","PC 7","PC 8","PC 9","PC 10","PC 11","PC 12","PC 13","PC 14","PC 15","PC 16","PC 17","PC 18","PC 19","PC 20","PC 21","PC 22","PC 23","PC 24","PC 25","PC 26","PC 27","PC 28","PC 29","PC 30","PC 31","PC 32","PC 33","PC 34","PC 35","PC 36","PC 37","PC 38","PC 39","PC 40","PC 41","PC 42","PC 43","PC 44","PC 45","PC 46","PC 47","PC 48","PC 49","PC 50","PC 51","PC 52","PC 53","PC 54","PC 55","PC 56","PC 57","PC 58","PC 59","PC 60","PC 61","PC 62","PC 63","PC 64","PC 65","PC 66","PC 67","PC 68","PC 69","PC 70","PC 71","PC 72","PC 73","PC 74","PC 75","PC 76","PC 77","PC 78","PC 79","PC 80","PC 81","PC 82","PC 83","PC 84","PC 85","PC 86","PC 87","PC 88","PC 89","PC 90","PC 91","PC 92","PC 93","PC 94","PC 95","PC 96","PC 97","PC 98","PC 99","PC 100","PC 101","PC 102","PC 103","PC 104","PC 105","PC 106","PC 107","PC 108","PC 109","PC 110","PC 111","PC 112","PC 113","PC 114","PC 115","PC 116","PC 117","PC 118","PC 119","PC 120","PC 121","PC 122","PC 123","PC 124","PC 125","PC 126","PC 127","PC 128","PC 129","PC 130","PC 131","PC 132","PC 133","PC 134","PC 135","PC 136","PC 137","PC 138","PC 139","PC 140","PC 141","PC 142","PC 143","PC 144","PC 145","PC 146","PC 147","PC 148","PC 149","PC 150","PC 151","PC 152","PC 153","PC 154","PC 155","PC 156","PC 157","PC 158","PC 159","PC 160","PC 161","PC 162","PC 163","PC 164","PC 165","PC 166","PC 167"]},"autosize":false,"yaxis":{"domain":[0,1],"automargin":true,"title":"Variances"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":["PC 1","PC 2","PC 3","PC 4","PC 5","PC 6","PC 7","PC 8","PC 9","PC 10","PC 11","PC 12","PC 13","PC 14","PC 15","PC 16","PC 17","PC 18","PC 19","PC 20","PC 21","PC 22","PC 23","PC 24","PC 25","PC 26","PC 27","PC 28","PC 29","PC 30","PC 31","PC 32","PC 33","PC 34","PC 35","PC 36","PC 37","PC 38","PC 39","PC 40","PC 41","PC 42","PC 43","PC 44","PC 45","PC 46","PC 47","PC 48","PC 49","PC 50","PC 51","PC 52","PC 53","PC 54","PC 55","PC 56","PC 57","PC 58","PC 59","PC 60","PC 61","PC 62","PC 63","PC 64","PC 65","PC 66","PC 67","PC 68","PC 69","PC 70","PC 71","PC 72","PC 73","PC 74","PC 75","PC 76","PC 77","PC 78","PC 79","PC 80","PC 81","PC 82","PC 83","PC 84","PC 85","PC 86","PC 87","PC 88","PC 89","PC 90","PC 91","PC 92","PC 93","PC 94","PC 95","PC 96","PC 97","PC 98","PC 99","PC 100","PC 101","PC 102","PC 103","PC 104","PC 105","PC 106","PC 107","PC 108","PC 109","PC 110","PC 111","PC 112","PC 113","PC 114","PC 115","PC 116","PC 117","PC 118","PC 119","PC 120","PC 121","PC 122","PC 123","PC 124","PC 125","PC 126","PC 127","PC 128","PC 129","PC 130","PC 131","PC 132","PC 133","PC 134","PC 135","PC 136","PC 137","PC 138","PC 139","PC 140","PC 141","PC 142","PC 143","PC 144","PC 145","PC 146","PC 147","PC 148","PC 149","PC 150","PC 151","PC 152","PC 153","PC 154","PC 155","PC 156","PC 157","PC 158","PC 159","PC 160","PC 161","PC 162","PC 163","PC 164","PC 165","PC 166","PC 167"],"y":[61.2816680394548,56.7092992831563,43.9953824409781,33.8927926494172,32.9209964316122,30.1246454087163,26.3768077674494,24.7063865909092,21.4932221268643,20.1005220269225,19.517951564629,18.5199755402274,17.7364090963343,17.5701506371052,16.4663250849815,15.9812283129245,15.7060398341311,15.2738406275444,14.9468474876645,14.3873262500604,14.2769256825544,14.0497043045493,13.7867496128954,13.6087507823631,13.2468993764275,12.6874169295549,12.411801387413,12.10341602808,11.9232670094065,11.7308327513205,11.6171544492056,11.3531830234903,11.2445378898984,11.0549782243022,10.9504451740682,10.6964323491217,10.6610818006426,10.541443301489,10.5098964916766,10.2266477788314,10.1189268447398,10.0221156822438,9.91536244929708,9.78325546109227,9.70874949570648,9.58770513104842,9.45557733442683,9.40724431063706,9.33283003375397,9.18187606125267,9.08373224141748,9.01473113833227,8.93783771855063,8.85421490771337,8.76857579780888,8.65979983854746,8.632694641883,8.51451796922002,8.50044180262617,8.41008428678342,8.35715833628163,8.17517770220906,8.11935870864234,8.09523648537855,8.04812009660331,7.96572832241281,7.89507435022154,7.82342083768159,7.7797177084484,7.70012697635664,7.66852176874713,7.55977950955928,7.54509138073506,7.4839006579861,7.46259726725042,7.38258910014943,7.32474312339802,7.3146971604951,7.24283786864915,7.21647516761596,7.14090544315851,7.10110450997083,7.08042827904734,7.03984047971476,6.99765039389496,6.95524772913785,6.92875535843345,6.84306443728638,6.80101852592058,6.76651758286343,6.72461667511063,6.66438750185698,6.60335704957791,6.58452986591119,6.53235497498698,6.45014713834418,6.4322929642741,6.41950908407676,6.37246210079757,6.31889083063925,6.2880293362306,6.23099366497453,6.21767894405525,6.16418814884787,6.13192205752089,6.10043867278597,6.07138329136665,6.02056521472388,5.98591129113375,5.97375602867603,5.94433294531571,5.85600948105293,5.84509961632739,5.81862059180668,5.80405333427694,5.74438205604818,5.71444999710185,5.69390297471362,5.65763266035144,5.59753621051471,5.58679669227347,5.55852034889234,5.52167581911321,5.49370381887118,5.47134459922944,5.43326870256281,5.36895157671941,5.34124777008158,5.28669870130327,5.25198587775069,5.21142045312874,5.18596103751472,5.17965568074935,5.13976002230075,5.08475481109271,5.05637037326034,5.02514016067895,5.00056770325685,4.97389313744474,4.95333530706183,4.87009954563955,4.84895575518473,4.81243356583681,4.78057772350369,4.73253334907365,4.71573596398501,4.70145398190553,4.6651135554821,4.62836000503815,4.54511286655963,4.53606388174122,4.49588991145879,4.46540128004381,4.43088476688364,4.40139465131246,4.3656073697338,4.33656138519701,4.30684013233557,4.19512169700645,4.14445990393004,4.1324077020797,4.07865509281236,4.03918332143783,3.9417701383069,3.81651545067546,3.60355166808696,4.78155714536153e-14],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save scree plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_scree_plot.html"), selfcontained = TRUE)

##### Detach plotly package. Otherwise it clashes with other graphics devices
```

### PCA plot (targets)

Principal component analysis (PCA) reduces the dimensionality of data while retaining most of the variation in the dataset, making it possible to visually assess similarities and differences between samples and determine whether samples can be grouped. This exploratory analysis facilitates identification of the key factors affecting the variability in the  expression data. The colours indicate sample groups (e.g. biological groups), as provided in *Target* column in the target files.


```r
##### Generate PCA 2-D plot
p <- plot_ly(y.norm.cpm.subset_pca.df, x = ~PC1, y = ~PC2, color = ~Target, text=paste(targetFile$Dataset, rownames(y.norm.cpm.subset_pca.df), sep=": "), colors = targets.colour[[1]], type='scatter', mode = "markers", marker = list(size=10, opacity = 0.7, symbol=datasets.symbols[[2]][order(targetFile$Target)]), width = 600, height = 400) %>%
layout(title = "", xaxis = list(title = paste( "PC1", " (",importance_pca["PC1"],")",sep="")), yaxis = list(title = paste( "PC2", " (",importance_pca["PC2"],")",sep="")), margin = list(l=50, r=50, b=50, t=20, pad=4), autosize = FALSE, showlegend = TRUE, legend = list(orientation = "v", y = 0.9))

p
```

<!--html_preserve--><div id="htmlwidget-f27657687ac7f4c43a5b" style="width:600px;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f27657687ac7f4c43a5b">{"x":{"visdat":{"1c25acbe4a0":["function () ","plotlyVisDat"]},"cur_data":"1c25acbe4a0","attrs":{"1c25acbe4a0":{"x":{},"y":{},"text":["TCGA-PAAD: TCGA.IB.AAUO.01A.12R.A38C.07","TCGA-PAAD: TCGA.3A.A9I9.01A.11R.A38C.07","TCGA-PAAD: TCGA.HZ.8519.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7885.01A.11R.2156.07","TCGA-PAAD: TCGA.US.A774.01A.21R.A32O.07","TCGA-PAAD: TCGA.S4.A8RM.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IR.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA-PAAD: TCGA.2J.AABA.01A.21R.A41B.07","TCGA-PAAD: TCGA.M8.A5N4.01A.11R.A26U.07","TCGA-PAAD: TCGA.2L.AAQL.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7645.01A.22R.2204.07","TCGA-PAAD: TCGA.2J.AABU.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9IV.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.AAUR.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7887.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7893.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABF.01A.31R.A41B.07","TCGA-PAAD: TCGA.3A.A9IN.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8V.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7888.01A.11R.2156.07","TCGA-PAAD: TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AAB9.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.A6UF.01A.23R.A33R.07","TCGA-PAAD: TCGA.HV.A5A3.01A.11R.A26U.07","TCGA-PAAD: TCGA.S4.A8RP.01A.11R.A36G.07","TCGA-PAAD: TCGA.F2.A7TX.01A.33R.A38C.07","TCGA-PAAD: TCGA.HV.A7OL.01A.11R.A33R.07","TCGA-PAAD: TCGA.HZ.A49H.01A.11R.A26U.07","TCGA-PAAD: TCGA.XN.A8T5.01A.12R.A36G.07","TCGA-PAAD: TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA-PAAD: TCGA.LB.A7SX.01A.11R.A33R.07","TCGA-PAAD: TCGA.YB.A89D.11A.11R.A36G.07","TCGA-PAAD: TCGA.RB.A7B8.01A.12R.A33R.07","TCGA-PAAD: TCGA.XD.AAUI.01A.42R.A41B.07","TCGA-PAAD: TCGA.2J.AABH.01A.21R.A41B.07","TCGA-PAAD: TCGA.3A.A9IO.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUP.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IB.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.AAUT.01A.11R.A37L.07","TCGA-PAAD: TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABK.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.AAUM.01A.11R.A37L.07","TCGA-PAAD: TCGA.FB.A4P6.01A.12R.A26U.07","TCGA-PAAD: TCGA.3A.A9IC.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAPU.01A.31R.A41B.07","TCGA-PAAD: TCGA.2L.AAQI.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA-PAAD: TCGA.HZ.8317.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7897.01A.21R.2204.07","TCGA-PAAD: TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA-PAAD: TCGA.2L.AAQE.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.A77P.01A.11R.A33R.07","TCGA-PAAD: TCGA.IB.A7LX.01A.12R.A36G.07","TCGA-PAAD: TCGA.2J.AAB4.01A.12R.A41B.07","TCGA-PAAD: TCGA.FB.AAPP.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABT.01A.11R.A41B.07","TCGA-PAAD: TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.8315.01A.11R.2404.07","TCGA-PAAD: TCGA.XD.AAUG.01A.61R.A41B.07","TCGA-PAAD: TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7652.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA-PAAD: TCGA.HV.A5A4.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.7890.01A.12R.2204.07","TCGA-PAAD: TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA-PAAD: TCGA.IB.7644.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.A5SO.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AABI.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABO.01A.21R.A41B.07","TCGA-PAAD: TCGA.US.A779.01A.11R.A32O.07","TCGA-PAAD: TCGA.3A.A9IH.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.7919.01A.11R.2156.07","TCGA-PAAD: TCGA.HV.A5A6.01A.11R.A26U.07","TCGA-PAAD: TCGA.YH.A8SY.01A.11R.A37L.07","TCGA-PAAD: TCGA.F2.6879.01A.11R.2156.07","TCGA-PAAD: TCGA.3A.A9IU.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8X.01A.11R.A39D.07","TCGA-PAAD: TCGA.IB.8127.01A.11R.2404.07","TCGA-PAAD: TCGA.FB.AAPS.01A.12R.A39D.07","TCGA-PAAD: TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA-PAAD: TCGA.US.A77E.01A.11R.A32O.07","TCGA-PAAD: TCGA.F2.A44H.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9I5.01A.11R.A38C.07","TCGA-PAAD: TCGA.RB.AA9M.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.A7OP.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.A545.01A.11R.A26U.07","TCGA-PAAD: TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA-PAAD: TCGA.IB.8126.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.A5SP.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.8001.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABE.01A.12R.A41B.07","TCGA-PAAD: TCGA.3A.A9IL.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUN.01A.12R.A38C.07","TCGA-PAAD: TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA-PAAD: TCGA.2J.AABV.01A.12R.A41B.07","TCGA-PAAD: TCGA.XN.A8T3.01A.11R.A36G.07","TCGA-PAAD: TCGA.OE.A75W.01A.12R.A32O.07","TCGA-PAAD: TCGA.LB.A8F3.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.8636.01A.21R.2404.07","TCGA-PAAD: TCGA.XD.AAUL.01A.21R.A39D.07","TCGA-PAAD: TCGA.2L.AAQM.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9I7.01A.21R.A38C.07","TCGA-PAAD: TCGA.US.A776.01A.13R.A33R.07","TCGA-PAAD: TCGA.IB.A7M4.01A.11R.A36G.07","TCGA-PAAD: TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA-PAAD: TCGA.2L.AAQA.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7889.01A.11R.2156.07","TCGA-PAAD: TCGA.F2.A8YN.01A.11R.A37L.07","TCGA-PAAD: TCGA.YB.A89D.01A.12R.A36G.07","TCGA-PAAD: TCGA.3A.A9IS.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.A6UG.01A.32R.A33R.07","TCGA-PAAD: TCGA.FB.AAPY.01A.11R.A41B.07","TCGA-PAAD: TCGA.S4.A8RO.01A.12R.A37L.07","TCGA-PAAD: TCGA.HZ.8637.01A.11R.2404.07","TCGA-PAAD: TCGA.2J.AAB6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7886.01A.11R.2156.07","TCGA-PAAD: TCGA.H6.8124.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7891.01A.11R.2204.07","TCGA-PAAD: TCGA.H6.A45N.11A.12R.A26U.07","TCGA-PAAD: TCGA.HZ.7926.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7646.01A.11R.2156.07","TCGA-PAAD: TCGA.2J.AABR.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9J0.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7651.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.AAUU.01A.11R.A37L.07","TCGA-PAAD: TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA-PAAD: TCGA.IB.AAUS.01A.12R.A38C.07","TCGA-PAAD: TCGA.F2.A44G.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9IX.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA-PAAD: TCGA.US.A77G.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8005.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AAB8.01A.12R.A41B.07","TCGA-PAAD: TCGA.HV.A5A3.11A.11R.A26U.07","TCGA-PAAD: TCGA.YY.A8LH.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.A49G.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.A5VM.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7649.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.7925.01A.11R.2156.07","TCGA-PAAD: TCGA.FB.A78T.01A.12R.A32O.07","TCGA-PAAD: TCGA.HZ.7922.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77O.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.A5ST.01A.11R.A32O.07","TCGA-PAAD: TCGA.XD.AAUH.01A.42R.A41B.07","TCGA-PAAD: TCGA.HZ.8003.01A.21R.2204.07","TCGA-PAAD: TCGA.HV.A5A5.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.A5SS.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A49I.01A.12R.A26U.07","TCGA-PAAD: TCGA.H6.8124.11A.01R.2404.07","TCGA-PAAD: TCGA.HZ.8002.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA-PAAD: TCGA.FB.A4P5.01A.11R.A26U.07","TCGA-PAAD: TCGA.2J.AAB1.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAY.01A.11R.A38C.07","TCGA-PAAD: TCGA.L1.A7W4.01A.12R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.AAQ0.01A.31R.A41B.07","Avner: CCR170093_RNA_WPT_013","Avner: CCR170012_MH17T001P013"],"mode":"markers","marker":{"size":10,"opacity":0.7,"symbol":["circle","circle","circle","circle","circle","circle","circle","square","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","square"]},"color":{},"colors":["red","blue","green","darkgoldenrod","darkred","deepskyblue"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"width":600,"height":400,"margin":{"b":50,"l":50,"t":20,"r":50,"pad":4},"title":"","xaxis":{"domain":[0,1],"automargin":true,"title":"PC1 (14.76%)"},"yaxis":{"domain":[0,1],"automargin":true,"title":"PC2 (12.64%)"},"autosize":false,"showlegend":true,"legend":{"orientation":"v","y":0.9},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[25.0409903306279,40.6256668841229],"y":[-210.6638900255,-146.020148943408],"text":["TCGA-PAAD: TCGA.FB.AAPP.01A.12R.A41B.07","TCGA-PAAD: TCGA.HV.A7OP.01A.11R.A33R.07"],"mode":"markers","marker":{"color":"rgba(255,0,0,1)","size":10,"opacity":0.7,"symbol":["circle","circle"],"line":{"color":"rgba(255,0,0,1)"}},"type":"scatter","name":"IPMN","textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[12.5427537830307],"y":[-57.5673900379553],"text":"TCGA-PAAD: TCGA.HZ.A9TJ.06A.11R.A41B.07","mode":"markers","marker":{"color":"rgba(0,0,255,1)","size":10,"opacity":0.7,"symbol":"circle","line":{"color":"rgba(0,0,255,1)"}},"type":"scatter","name":"Metastatic","textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-18.5291516603558,89.4220691900872,39.1939807238073,44.5426805875147],"y":[48.7984125678722,32.1695564435801,46.39511808786,79.5899759522146],"text":["TCGA-PAAD: TCGA.YB.A89D.11A.11R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.11A.12R.A26U.07","TCGA-PAAD: TCGA.HV.A5A3.11A.11R.A26U.07","TCGA-PAAD: TCGA.H6.8124.11A.01R.2404.07"],"mode":"markers","marker":{"color":"rgba(0,255,0,1)","size":10,"opacity":0.7,"symbol":["circle","circle","circle","circle"],"line":{"color":"rgba(0,255,0,1)"}},"type":"scatter","name":"Normal","textfont":{"color":"rgba(0,255,0,1)"},"error_y":{"color":"rgba(0,255,0,1)"},"error_x":{"color":"rgba(0,255,0,1)"},"line":{"color":"rgba(0,255,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[28.3761904119425],"y":[-271.839201781264],"text":"Avner: CCR170093_RNA_WPT_013","mode":"markers","marker":{"color":"rgba(184,134,11,1)","size":10,"opacity":0.7,"symbol":"square","line":{"color":"rgba(184,134,11,1)"}},"type":"scatter","name":"Organoid","textfont":{"color":"rgba(184,134,11,1)"},"error_y":{"color":"rgba(184,134,11,1)"},"error_x":{"color":"rgba(184,134,11,1)"},"line":{"color":"rgba(184,134,11,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[254.460947231326,267.88992161989,224.453407921171,205.494928124774,224.979561127269,198.247287550819,223.80018994889,316.804873693753],"y":[-81.1441830815798,-56.7030467758504,-51.1228411552338,20.0644929603723,-6.45521730326628,-2.56315721580087,-66.520607816587,-102.234655613013],"text":["TCGA-PAAD: TCGA.3A.A9IR.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9IV.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9IN.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9IO.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IL.01A.11R.A38C.07","TCGA-PAAD: TCGA.2L.AAQM.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9IS.01A.21R.A39D.07"],"mode":"markers","marker":{"color":"rgba(139,0,0,1)","size":10,"opacity":0.7,"symbol":["circle","circle","circle","circle","circle","circle","circle","circle"],"line":{"color":"rgba(139,0,0,1)"}},"type":"scatter","name":"PanNET","textfont":{"color":"rgba(139,0,0,1)"},"error_y":{"color":"rgba(139,0,0,1)"},"error_x":{"color":"rgba(139,0,0,1)"},"line":{"color":"rgba(139,0,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-39.5096329738213,-0.9505355203886,80.2127705047868,-46.6230272166826,-27.1441323826728,-33.405260943958,-34.0023167958671,-55.3480676372859,-5.60915111816782,-23.6603991658158,-1.73724967460498,-44.1529304681383,-31.4517058117416,-27.3741670418291,8.95319781501381,-48.7635072481656,-18.6611006738754,-10.8112677324935,-21.7235872145004,-25.7935281045507,22.5336300615491,-51.2106961117494,-4.75603870600442,-21.3782025618893,-51.0637610497309,-8.40918772983574,-9.62561098082745,-55.1413865942984,17.2780844973726,29.7644621792625,-0.599146807661378,-26.0403425923249,-22.2591111664937,-15.6396539159804,-5.47469531112594,-11.2446478790358,-22.8484060882454,17.2106872488172,-2.52297915054892,18.8700354963358,25.2036386603,16.6812598620333,-37.9148215642545,-33.0443803562137,-16.8226751641533,-8.30164988472832,-11.9588165083182,67.4957652118502,-27.0466788657155,-32.2849438435798,15.2220232259752,-39.3760650643882,-11.0314730731224,6.64538342370945,2.31070894211073,-34.2422879349515,39.5548849803914,37.0912017070588,-5.17510042752755,-38.595908396523,-20.8868625337465,-1.06787109830572,-9.70080534427894,-40.4470566422701,-17.433622191752,-9.30737146604097,-11.9030176002842,-6.50445511943287,-13.5967922314083,-36.7969011077622,-33.3578684842641,-55.158622958603,-46.7913639046901,-40.053807011482,-28.5007568946637,-44.5965513819438,2.88966076089788,-43.9403545793389,-27.895206833818,14.0534016337911,48.8322490551398,18.666778519432,-22.7207085825641,-50.0016980143501,35.1917082529504,-19.5596616917483,19.9847552302763,-36.0590582414961,-28.426362759485,-59.3563817822117,18.5140763076994,12.548483996723,-44.886876885917,23.7435159342809,-23.3523525453009,-33.6454088392129,-27.8943798117145,26.6914988763467,-41.8186105096457,-45.2332689447674,-63.6129891062409,-23.9949036163229,-56.4386454233988,-18.409584919232,-3.61490628635037,-28.4664778938386,-15.2809885879065,28.0712787550042,-5.72502772557059,-47.8378725517243,-13.8703310029183,0.0836406521641423,-34.1986729312702,-29.0339058245327,3.08077895985972,-56.1190496657094,-10.6610156191389,-33.1059208412153,-24.9183301808939,-17.8165375537453,-54.9078329721756,4.78773455576834,-16.4672550332323,-2.80010447463,-24.7980389455741,-20.8239609548476,-50.3351268187208,-34.1326482882487,-3.66868407496047,-1.48495068372064,-2.0057179917184,-20.1802101973969,-18.4501134088173,-31.3268296852103,-31.2466950492202,12.6143352842551,-17.2489615674335,64.7407938131919,22.3855394502879,11.5118758656272,-29.6793672635051,-23.0190198633823,22.8590441054633,-17.8902878778119,2.6842240602341,-32.1569787115552,-6.39955696632374,6.17368294369863,5.64165749724985,-48.0795303820063,3.70657659121272],"y":[-34.399269297641,23.2053421393136,58.8662840107597,27.5560235691365,56.2020593453304,-59.2321436665237,-8.75882545773145,-55.373018967477,9.04771077484417,-66.2387779270581,69.5120956588285,-38.0471354434322,-44.065536176215,16.0489669837953,60.9218515939107,-29.7398154560986,14.340222180226,36.0645822796106,22.5272376108219,18.0140903654966,81.4420522012264,-31.7502152942052,54.6965414822371,-26.5580751011711,-76.701521149603,14.5638653808841,34.726874436223,-37.8658598190469,80.1206935775191,52.1020823347876,-12.0106311201158,-35.461679374984,-1.18392140635895,34.6929673302986,1.56239226147181,60.4572973418011,9.15822305935094,73.8838276282681,15.342749763907,9.31613946784426,53.8214209466886,44.601968302529,-17.2799534289966,-86.5527312034837,7.59482346797364,27.2242059327944,35.5392214927861,101.961830622603,-84.0338710447212,-41.6734377551029,37.7134321048641,-53.0005107116629,6.06592702479911,5.3746657533973,53.2769460110038,38.0335713461849,83.2400960801393,53.867850847346,52.3972236258561,32.0309063278044,-6.28128059700764,23.8137275934406,44.0114600492213,-34.6680652507444,52.0932320779514,-44.9894188560586,17.2751288807307,-54.3840258252979,-12.4465964127922,19.0787450981375,-66.0691782916553,-35.2066389950616,-81.0699372074134,-5.02806569061731,-54.8024505705096,15.9763424903294,62.6611544430876,-38.6469120267407,-33.9960994351649,46.7416433229874,1.20847405160905,25.5660347004922,-43.6197230546796,-66.4966711314414,95.2208292015278,-43.5930056753265,77.4700932435424,-11.3892794250771,19.6717675707837,-26.3438773809578,5.8838685215405,34.4589743793149,-55.3790962964125,-19.2926501695037,23.3981860558057,4.61464494056441,21.225066817134,-121.287921869455,-22.2314913966622,-52.8509484580436,-77.6108269508814,45.482710368137,-40.9444702445933,30.6031860766845,20.2122681701092,25.5432989141772,-25.8828550842807,59.4840091122676,-17.4115264842447,-2.40434474086709,-31.1383048407228,91.1695350499447,19.6297019982158,-11.0581570221627,69.1685628708782,-40.1681676374665,32.611924247639,-10.8533495870535,2.7489293718562,60.0217866782442,-29.6609083770713,81.8402141841094,-1.719690277714,20.4655551898078,-61.9897229090999,-39.9309189158507,-37.6910386009108,-83.0968141117788,57.4628331009818,7.81618925686741,86.2330855815594,6.41306788451144,-13.9786072997683,41.9887442078321,1.38619416201718,-35.2866240165053,44.0794998113294,74.5068147205299,97.9356664692912,43.2927233207322,-29.2511422806137,-1.04061452782688,87.0597418345398,-45.7091182819685,76.4139972846996,-5.06767491271939,43.270407728351,-58.7935056986307,57.1003244277275,-124.284983123327,-20.6361946440352],"text":["TCGA-PAAD: TCGA.IB.AAUO.01A.12R.A38C.07","TCGA-PAAD: TCGA.3A.A9I9.01A.11R.A38C.07","TCGA-PAAD: TCGA.HZ.8519.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7885.01A.11R.2156.07","TCGA-PAAD: TCGA.US.A774.01A.21R.A32O.07","TCGA-PAAD: TCGA.S4.A8RM.01A.11R.A37L.07","TCGA-PAAD: TCGA.2J.AABA.01A.21R.A41B.07","TCGA-PAAD: TCGA.M8.A5N4.01A.11R.A26U.07","TCGA-PAAD: TCGA.2L.AAQL.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7645.01A.22R.2204.07","TCGA-PAAD: TCGA.2J.AABU.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.AAUR.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7887.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7893.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABF.01A.31R.A41B.07","TCGA-PAAD: TCGA.HV.AA8V.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7888.01A.11R.2156.07","TCGA-PAAD: TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AAB9.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.A6UF.01A.23R.A33R.07","TCGA-PAAD: TCGA.HV.A5A3.01A.11R.A26U.07","TCGA-PAAD: TCGA.S4.A8RP.01A.11R.A36G.07","TCGA-PAAD: TCGA.F2.A7TX.01A.33R.A38C.07","TCGA-PAAD: TCGA.HV.A7OL.01A.11R.A33R.07","TCGA-PAAD: TCGA.HZ.A49H.01A.11R.A26U.07","TCGA-PAAD: TCGA.XN.A8T5.01A.12R.A36G.07","TCGA-PAAD: TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA-PAAD: TCGA.LB.A7SX.01A.11R.A33R.07","TCGA-PAAD: TCGA.RB.A7B8.01A.12R.A33R.07","TCGA-PAAD: TCGA.XD.AAUI.01A.42R.A41B.07","TCGA-PAAD: TCGA.2J.AABH.01A.21R.A41B.07","TCGA-PAAD: TCGA.IB.AAUP.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IB.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.AAUT.01A.11R.A37L.07","TCGA-PAAD: TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABK.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.AAUM.01A.11R.A37L.07","TCGA-PAAD: TCGA.FB.A4P6.01A.12R.A26U.07","TCGA-PAAD: TCGA.3A.A9IC.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAPU.01A.31R.A41B.07","TCGA-PAAD: TCGA.2L.AAQI.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA-PAAD: TCGA.HZ.8317.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7897.01A.21R.2204.07","TCGA-PAAD: TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA-PAAD: TCGA.2L.AAQE.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.A77P.01A.11R.A33R.07","TCGA-PAAD: TCGA.IB.A7LX.01A.12R.A36G.07","TCGA-PAAD: TCGA.2J.AAB4.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABT.01A.11R.A41B.07","TCGA-PAAD: TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.8315.01A.11R.2404.07","TCGA-PAAD: TCGA.XD.AAUG.01A.61R.A41B.07","TCGA-PAAD: TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7652.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA-PAAD: TCGA.HV.A5A4.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.7890.01A.12R.2204.07","TCGA-PAAD: TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA-PAAD: TCGA.IB.7644.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.A5SO.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AABI.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABO.01A.21R.A41B.07","TCGA-PAAD: TCGA.US.A779.01A.11R.A32O.07","TCGA-PAAD: TCGA.3A.A9IH.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.7919.01A.11R.2156.07","TCGA-PAAD: TCGA.HV.A5A6.01A.11R.A26U.07","TCGA-PAAD: TCGA.YH.A8SY.01A.11R.A37L.07","TCGA-PAAD: TCGA.F2.6879.01A.11R.2156.07","TCGA-PAAD: TCGA.3A.A9IU.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8X.01A.11R.A39D.07","TCGA-PAAD: TCGA.IB.8127.01A.11R.2404.07","TCGA-PAAD: TCGA.FB.AAPS.01A.12R.A39D.07","TCGA-PAAD: TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA-PAAD: TCGA.US.A77E.01A.11R.A32O.07","TCGA-PAAD: TCGA.F2.A44H.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9I5.01A.11R.A38C.07","TCGA-PAAD: TCGA.RB.AA9M.01A.11R.A39D.07","TCGA-PAAD: TCGA.FB.A545.01A.11R.A26U.07","TCGA-PAAD: TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA-PAAD: TCGA.IB.8126.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.A5SP.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8001.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABE.01A.12R.A41B.07","TCGA-PAAD: TCGA.IB.AAUN.01A.12R.A38C.07","TCGA-PAAD: TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA-PAAD: TCGA.2J.AABV.01A.12R.A41B.07","TCGA-PAAD: TCGA.XN.A8T3.01A.11R.A36G.07","TCGA-PAAD: TCGA.OE.A75W.01A.12R.A32O.07","TCGA-PAAD: TCGA.LB.A8F3.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.8636.01A.21R.2404.07","TCGA-PAAD: TCGA.XD.AAUL.01A.21R.A39D.07","TCGA-PAAD: TCGA.3A.A9I7.01A.21R.A38C.07","TCGA-PAAD: TCGA.US.A776.01A.13R.A33R.07","TCGA-PAAD: TCGA.IB.A7M4.01A.11R.A36G.07","TCGA-PAAD: TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA-PAAD: TCGA.2L.AAQA.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7889.01A.11R.2156.07","TCGA-PAAD: TCGA.F2.A8YN.01A.11R.A37L.07","TCGA-PAAD: TCGA.YB.A89D.01A.12R.A36G.07","TCGA-PAAD: TCGA.IB.A6UG.01A.32R.A33R.07","TCGA-PAAD: TCGA.FB.AAPY.01A.11R.A41B.07","TCGA-PAAD: TCGA.S4.A8RO.01A.12R.A37L.07","TCGA-PAAD: TCGA.HZ.8637.01A.11R.2404.07","TCGA-PAAD: TCGA.2J.AAB6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7886.01A.11R.2156.07","TCGA-PAAD: TCGA.H6.8124.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7891.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.7926.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7646.01A.11R.2156.07","TCGA-PAAD: TCGA.2J.AABR.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9J0.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7651.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.AAUU.01A.11R.A37L.07","TCGA-PAAD: TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA-PAAD: TCGA.IB.AAUS.01A.12R.A38C.07","TCGA-PAAD: TCGA.F2.A44G.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9IX.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA-PAAD: TCGA.US.A77G.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8005.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AAB8.01A.12R.A41B.07","TCGA-PAAD: TCGA.YY.A8LH.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.A49G.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.A5VM.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7649.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.7925.01A.11R.2156.07","TCGA-PAAD: TCGA.FB.A78T.01A.12R.A32O.07","TCGA-PAAD: TCGA.HZ.7922.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77O.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.A5ST.01A.11R.A32O.07","TCGA-PAAD: TCGA.XD.AAUH.01A.42R.A41B.07","TCGA-PAAD: TCGA.HZ.8003.01A.21R.2204.07","TCGA-PAAD: TCGA.HV.A5A5.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.A5SS.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A49I.01A.12R.A26U.07","TCGA-PAAD: TCGA.HZ.8002.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA-PAAD: TCGA.FB.A4P5.01A.11R.A26U.07","TCGA-PAAD: TCGA.2J.AAB1.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAY.01A.11R.A38C.07","TCGA-PAAD: TCGA.L1.A7W4.01A.12R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.AAQ0.01A.31R.A41B.07","Avner: CCR170012_MH17T001P013"],"mode":"markers","marker":{"color":"rgba(0,191,255,1)","size":10,"opacity":0.7,"symbol":["circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","square"],"line":{"color":"rgba(0,191,255,1)"}},"type":"scatter","name":"PDAC","textfont":{"color":"rgba(0,191,255,1)"},"error_y":{"color":"rgba(0,191,255,1)"},"error_x":{"color":"rgba(0,191,255,1)"},"line":{"color":"rgba(0,191,255,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save PCA plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_PCA_2d_targets.html"), selfcontained = TRUE)

##### Generate PCA 3-D plot
p <- plot_ly(y.norm.cpm.subset_pca.df, x = ~PC1, y = ~PC2, z = ~PC3, color = ~Target, text=paste(targetFile$Dataset, rownames(y.norm.cpm.subset_pca.df), sep=": "), colors = targets.colour[[1]], type='scatter3d', mode = "markers", marker = list(size=8, opacity = 0.7, symbol=datasets.symbols[[2]][order(targetFile$Target)]), width = 600, height = 600) %>%
layout(title = "", xaxis = list(title = paste( "PC1", " (",importance_pca["PC1"],")",sep="")), yaxis = list(title = paste( "PC2", " (",importance_pca["PC2"],")",sep="")), zaxis = list(title = paste( "PC3", " (",importance_pca["PC3"],")",sep="")) , margin = list(l=50, r=50, b=50, t=10, pad=4), autosize = FALSE, showlegend = TRUE, legend = list(orientation = "v", y = 0.9))

p
```

<!--html_preserve--><div id="htmlwidget-39ea54851775ef372a7a" style="width:600px;height:600px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-39ea54851775ef372a7a">{"x":{"visdat":{"1c256c7badba":["function () ","plotlyVisDat"]},"cur_data":"1c256c7badba","attrs":{"1c256c7badba":{"x":{},"y":{},"z":{},"text":["TCGA-PAAD: TCGA.IB.AAUO.01A.12R.A38C.07","TCGA-PAAD: TCGA.3A.A9I9.01A.11R.A38C.07","TCGA-PAAD: TCGA.HZ.8519.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7885.01A.11R.2156.07","TCGA-PAAD: TCGA.US.A774.01A.21R.A32O.07","TCGA-PAAD: TCGA.S4.A8RM.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IR.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA-PAAD: TCGA.2J.AABA.01A.21R.A41B.07","TCGA-PAAD: TCGA.M8.A5N4.01A.11R.A26U.07","TCGA-PAAD: TCGA.2L.AAQL.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7645.01A.22R.2204.07","TCGA-PAAD: TCGA.2J.AABU.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9IV.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.AAUR.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7887.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7893.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABF.01A.31R.A41B.07","TCGA-PAAD: TCGA.3A.A9IN.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8V.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7888.01A.11R.2156.07","TCGA-PAAD: TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AAB9.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.A6UF.01A.23R.A33R.07","TCGA-PAAD: TCGA.HV.A5A3.01A.11R.A26U.07","TCGA-PAAD: TCGA.S4.A8RP.01A.11R.A36G.07","TCGA-PAAD: TCGA.F2.A7TX.01A.33R.A38C.07","TCGA-PAAD: TCGA.HV.A7OL.01A.11R.A33R.07","TCGA-PAAD: TCGA.HZ.A49H.01A.11R.A26U.07","TCGA-PAAD: TCGA.XN.A8T5.01A.12R.A36G.07","TCGA-PAAD: TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA-PAAD: TCGA.LB.A7SX.01A.11R.A33R.07","TCGA-PAAD: TCGA.YB.A89D.11A.11R.A36G.07","TCGA-PAAD: TCGA.RB.A7B8.01A.12R.A33R.07","TCGA-PAAD: TCGA.XD.AAUI.01A.42R.A41B.07","TCGA-PAAD: TCGA.2J.AABH.01A.21R.A41B.07","TCGA-PAAD: TCGA.3A.A9IO.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUP.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IB.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.AAUT.01A.11R.A37L.07","TCGA-PAAD: TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABK.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.AAUM.01A.11R.A37L.07","TCGA-PAAD: TCGA.FB.A4P6.01A.12R.A26U.07","TCGA-PAAD: TCGA.3A.A9IC.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAPU.01A.31R.A41B.07","TCGA-PAAD: TCGA.2L.AAQI.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA-PAAD: TCGA.HZ.8317.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7897.01A.21R.2204.07","TCGA-PAAD: TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA-PAAD: TCGA.2L.AAQE.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.A77P.01A.11R.A33R.07","TCGA-PAAD: TCGA.IB.A7LX.01A.12R.A36G.07","TCGA-PAAD: TCGA.2J.AAB4.01A.12R.A41B.07","TCGA-PAAD: TCGA.FB.AAPP.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABT.01A.11R.A41B.07","TCGA-PAAD: TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.8315.01A.11R.2404.07","TCGA-PAAD: TCGA.XD.AAUG.01A.61R.A41B.07","TCGA-PAAD: TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7652.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA-PAAD: TCGA.HV.A5A4.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.7890.01A.12R.2204.07","TCGA-PAAD: TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA-PAAD: TCGA.IB.7644.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.A5SO.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AABI.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABO.01A.21R.A41B.07","TCGA-PAAD: TCGA.US.A779.01A.11R.A32O.07","TCGA-PAAD: TCGA.3A.A9IH.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.7919.01A.11R.2156.07","TCGA-PAAD: TCGA.HV.A5A6.01A.11R.A26U.07","TCGA-PAAD: TCGA.YH.A8SY.01A.11R.A37L.07","TCGA-PAAD: TCGA.F2.6879.01A.11R.2156.07","TCGA-PAAD: TCGA.3A.A9IU.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8X.01A.11R.A39D.07","TCGA-PAAD: TCGA.IB.8127.01A.11R.2404.07","TCGA-PAAD: TCGA.FB.AAPS.01A.12R.A39D.07","TCGA-PAAD: TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA-PAAD: TCGA.US.A77E.01A.11R.A32O.07","TCGA-PAAD: TCGA.F2.A44H.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9I5.01A.11R.A38C.07","TCGA-PAAD: TCGA.RB.AA9M.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.A7OP.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.A545.01A.11R.A26U.07","TCGA-PAAD: TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA-PAAD: TCGA.IB.8126.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.A5SP.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A9TJ.06A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.8001.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABE.01A.12R.A41B.07","TCGA-PAAD: TCGA.3A.A9IL.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUN.01A.12R.A38C.07","TCGA-PAAD: TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA-PAAD: TCGA.2J.AABV.01A.12R.A41B.07","TCGA-PAAD: TCGA.XN.A8T3.01A.11R.A36G.07","TCGA-PAAD: TCGA.OE.A75W.01A.12R.A32O.07","TCGA-PAAD: TCGA.LB.A8F3.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.8636.01A.21R.2404.07","TCGA-PAAD: TCGA.XD.AAUL.01A.21R.A39D.07","TCGA-PAAD: TCGA.2L.AAQM.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9I7.01A.21R.A38C.07","TCGA-PAAD: TCGA.US.A776.01A.13R.A33R.07","TCGA-PAAD: TCGA.IB.A7M4.01A.11R.A36G.07","TCGA-PAAD: TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA-PAAD: TCGA.2L.AAQA.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7889.01A.11R.2156.07","TCGA-PAAD: TCGA.F2.A8YN.01A.11R.A37L.07","TCGA-PAAD: TCGA.YB.A89D.01A.12R.A36G.07","TCGA-PAAD: TCGA.3A.A9IS.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.A6UG.01A.32R.A33R.07","TCGA-PAAD: TCGA.FB.AAPY.01A.11R.A41B.07","TCGA-PAAD: TCGA.S4.A8RO.01A.12R.A37L.07","TCGA-PAAD: TCGA.HZ.8637.01A.11R.2404.07","TCGA-PAAD: TCGA.2J.AAB6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7886.01A.11R.2156.07","TCGA-PAAD: TCGA.H6.8124.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7891.01A.11R.2204.07","TCGA-PAAD: TCGA.H6.A45N.11A.12R.A26U.07","TCGA-PAAD: TCGA.HZ.7926.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7646.01A.11R.2156.07","TCGA-PAAD: TCGA.2J.AABR.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9J0.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7651.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.AAUU.01A.11R.A37L.07","TCGA-PAAD: TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA-PAAD: TCGA.IB.AAUS.01A.12R.A38C.07","TCGA-PAAD: TCGA.F2.A44G.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9IX.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA-PAAD: TCGA.US.A77G.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8005.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AAB8.01A.12R.A41B.07","TCGA-PAAD: TCGA.HV.A5A3.11A.11R.A26U.07","TCGA-PAAD: TCGA.YY.A8LH.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.A49G.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.A5VM.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7649.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.7925.01A.11R.2156.07","TCGA-PAAD: TCGA.FB.A78T.01A.12R.A32O.07","TCGA-PAAD: TCGA.HZ.7922.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77O.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.A5ST.01A.11R.A32O.07","TCGA-PAAD: TCGA.XD.AAUH.01A.42R.A41B.07","TCGA-PAAD: TCGA.HZ.8003.01A.21R.2204.07","TCGA-PAAD: TCGA.HV.A5A5.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.A5SS.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A49I.01A.12R.A26U.07","TCGA-PAAD: TCGA.H6.8124.11A.01R.2404.07","TCGA-PAAD: TCGA.HZ.8002.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA-PAAD: TCGA.FB.A4P5.01A.11R.A26U.07","TCGA-PAAD: TCGA.2J.AAB1.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAY.01A.11R.A38C.07","TCGA-PAAD: TCGA.L1.A7W4.01A.12R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.AAQ0.01A.31R.A41B.07","Avner: CCR170093_RNA_WPT_013","Avner: CCR170012_MH17T001P013"],"mode":"markers","marker":{"size":8,"opacity":0.7,"symbol":["circle","circle","circle","circle","circle","circle","circle","square","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","square"]},"color":{},"colors":["red","blue","green","darkgoldenrod","darkred","deepskyblue"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"width":600,"height":600,"margin":{"b":50,"l":50,"t":10,"r":50,"pad":4},"title":"","xaxis":{"title":"PC1 (14.76%)"},"yaxis":{"title":"PC2 (12.64%)"},"zaxis":{"title":"PC3 (7.61%)"},"autosize":false,"showlegend":true,"legend":{"orientation":"v","y":0.9},"scene":{"xaxis":{"title":"PC1"},"yaxis":{"title":"PC2"},"zaxis":{"title":"PC3"}},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[25.0409903306279,40.6256668841229],"y":[-210.6638900255,-146.020148943408],"z":[8.79742089194846,33.9085738513744],"text":["TCGA-PAAD: TCGA.FB.AAPP.01A.12R.A41B.07","TCGA-PAAD: TCGA.HV.A7OP.01A.11R.A33R.07"],"mode":"markers","marker":{"color":"rgba(255,0,0,1)","size":8,"opacity":0.7,"symbol":["circle","circle"],"line":{"color":"rgba(255,0,0,1)"}},"type":"scatter3d","name":"IPMN","textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"frame":null},{"x":[12.5427537830307],"y":[-57.5673900379553],"z":[-14.1878488007826],"text":"TCGA-PAAD: TCGA.HZ.A9TJ.06A.11R.A41B.07","mode":"markers","marker":{"color":"rgba(0,0,255,1)","size":8,"opacity":0.7,"symbol":"circle","line":{"color":"rgba(0,0,255,1)"}},"type":"scatter3d","name":"Metastatic","textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"frame":null},{"x":[-18.5291516603558,89.4220691900872,39.1939807238073,44.5426805875147],"y":[48.7984125678722,32.1695564435801,46.39511808786,79.5899759522146],"z":[-17.0217230182258,-134.353633977014,29.0377604141077,9.13084986437795],"text":["TCGA-PAAD: TCGA.YB.A89D.11A.11R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.11A.12R.A26U.07","TCGA-PAAD: TCGA.HV.A5A3.11A.11R.A26U.07","TCGA-PAAD: TCGA.H6.8124.11A.01R.2404.07"],"mode":"markers","marker":{"color":"rgba(0,255,0,1)","size":8,"opacity":0.7,"symbol":["circle","circle","circle","circle"],"line":{"color":"rgba(0,255,0,1)"}},"type":"scatter3d","name":"Normal","textfont":{"color":"rgba(0,255,0,1)"},"error_y":{"color":"rgba(0,255,0,1)"},"error_x":{"color":"rgba(0,255,0,1)"},"line":{"color":"rgba(0,255,0,1)"},"frame":null},{"x":[28.3761904119425],"y":[-271.839201781264],"z":[10.1288467931282],"text":"Avner: CCR170093_RNA_WPT_013","mode":"markers","marker":{"color":"rgba(184,134,11,1)","size":8,"opacity":0.7,"symbol":"square","line":{"color":"rgba(184,134,11,1)"}},"type":"scatter3d","name":"Organoid","textfont":{"color":"rgba(184,134,11,1)"},"error_y":{"color":"rgba(184,134,11,1)"},"error_x":{"color":"rgba(184,134,11,1)"},"line":{"color":"rgba(184,134,11,1)"},"frame":null},{"x":[254.460947231326,267.88992161989,224.453407921171,205.494928124774,224.979561127269,198.247287550819,223.80018994889,316.804873693753],"y":[-81.1441830815798,-56.7030467758504,-51.1228411552338,20.0644929603723,-6.45521730326628,-2.56315721580087,-66.520607816587,-102.234655613013],"z":[-28.4218023447517,3.31215691523526,-28.5393583639167,-24.1704954688484,43.9667191049479,17.5694258850915,-9.02508367243031,-18.9613086988743],"text":["TCGA-PAAD: TCGA.3A.A9IR.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IJ.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9IV.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9IN.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9IO.01A.11R.A38C.07","TCGA-PAAD: TCGA.3A.A9IL.01A.11R.A38C.07","TCGA-PAAD: TCGA.2L.AAQM.01A.11R.A39D.07","TCGA-PAAD: TCGA.3A.A9IS.01A.21R.A39D.07"],"mode":"markers","marker":{"color":"rgba(139,0,0,1)","size":8,"opacity":0.7,"symbol":["circle","circle","circle","circle","circle","circle","circle","circle"],"line":{"color":"rgba(139,0,0,1)"}},"type":"scatter3d","name":"PanNET","textfont":{"color":"rgba(139,0,0,1)"},"error_y":{"color":"rgba(139,0,0,1)"},"error_x":{"color":"rgba(139,0,0,1)"},"line":{"color":"rgba(139,0,0,1)"},"frame":null},{"x":[-39.5096329738213,-0.9505355203886,80.2127705047868,-46.6230272166826,-27.1441323826728,-33.405260943958,-34.0023167958671,-55.3480676372859,-5.60915111816782,-23.6603991658158,-1.73724967460498,-44.1529304681383,-31.4517058117416,-27.3741670418291,8.95319781501381,-48.7635072481656,-18.6611006738754,-10.8112677324935,-21.7235872145004,-25.7935281045507,22.5336300615491,-51.2106961117494,-4.75603870600442,-21.3782025618893,-51.0637610497309,-8.40918772983574,-9.62561098082745,-55.1413865942984,17.2780844973726,29.7644621792625,-0.599146807661378,-26.0403425923249,-22.2591111664937,-15.6396539159804,-5.47469531112594,-11.2446478790358,-22.8484060882454,17.2106872488172,-2.52297915054892,18.8700354963358,25.2036386603,16.6812598620333,-37.9148215642545,-33.0443803562137,-16.8226751641533,-8.30164988472832,-11.9588165083182,67.4957652118502,-27.0466788657155,-32.2849438435798,15.2220232259752,-39.3760650643882,-11.0314730731224,6.64538342370945,2.31070894211073,-34.2422879349515,39.5548849803914,37.0912017070588,-5.17510042752755,-38.595908396523,-20.8868625337465,-1.06787109830572,-9.70080534427894,-40.4470566422701,-17.433622191752,-9.30737146604097,-11.9030176002842,-6.50445511943287,-13.5967922314083,-36.7969011077622,-33.3578684842641,-55.158622958603,-46.7913639046901,-40.053807011482,-28.5007568946637,-44.5965513819438,2.88966076089788,-43.9403545793389,-27.895206833818,14.0534016337911,48.8322490551398,18.666778519432,-22.7207085825641,-50.0016980143501,35.1917082529504,-19.5596616917483,19.9847552302763,-36.0590582414961,-28.426362759485,-59.3563817822117,18.5140763076994,12.548483996723,-44.886876885917,23.7435159342809,-23.3523525453009,-33.6454088392129,-27.8943798117145,26.6914988763467,-41.8186105096457,-45.2332689447674,-63.6129891062409,-23.9949036163229,-56.4386454233988,-18.409584919232,-3.61490628635037,-28.4664778938386,-15.2809885879065,28.0712787550042,-5.72502772557059,-47.8378725517243,-13.8703310029183,0.0836406521641423,-34.1986729312702,-29.0339058245327,3.08077895985972,-56.1190496657094,-10.6610156191389,-33.1059208412153,-24.9183301808939,-17.8165375537453,-54.9078329721756,4.78773455576834,-16.4672550332323,-2.80010447463,-24.7980389455741,-20.8239609548476,-50.3351268187208,-34.1326482882487,-3.66868407496047,-1.48495068372064,-2.0057179917184,-20.1802101973969,-18.4501134088173,-31.3268296852103,-31.2466950492202,12.6143352842551,-17.2489615674335,64.7407938131919,22.3855394502879,11.5118758656272,-29.6793672635051,-23.0190198633823,22.8590441054633,-17.8902878778119,2.6842240602341,-32.1569787115552,-6.39955696632374,6.17368294369863,5.64165749724985,-48.0795303820063,3.70657659121272],"y":[-34.399269297641,23.2053421393136,58.8662840107597,27.5560235691365,56.2020593453304,-59.2321436665237,-8.75882545773145,-55.373018967477,9.04771077484417,-66.2387779270581,69.5120956588285,-38.0471354434322,-44.065536176215,16.0489669837953,60.9218515939107,-29.7398154560986,14.340222180226,36.0645822796106,22.5272376108219,18.0140903654966,81.4420522012264,-31.7502152942052,54.6965414822371,-26.5580751011711,-76.701521149603,14.5638653808841,34.726874436223,-37.8658598190469,80.1206935775191,52.1020823347876,-12.0106311201158,-35.461679374984,-1.18392140635895,34.6929673302986,1.56239226147181,60.4572973418011,9.15822305935094,73.8838276282681,15.342749763907,9.31613946784426,53.8214209466886,44.601968302529,-17.2799534289966,-86.5527312034837,7.59482346797364,27.2242059327944,35.5392214927861,101.961830622603,-84.0338710447212,-41.6734377551029,37.7134321048641,-53.0005107116629,6.06592702479911,5.3746657533973,53.2769460110038,38.0335713461849,83.2400960801393,53.867850847346,52.3972236258561,32.0309063278044,-6.28128059700764,23.8137275934406,44.0114600492213,-34.6680652507444,52.0932320779514,-44.9894188560586,17.2751288807307,-54.3840258252979,-12.4465964127922,19.0787450981375,-66.0691782916553,-35.2066389950616,-81.0699372074134,-5.02806569061731,-54.8024505705096,15.9763424903294,62.6611544430876,-38.6469120267407,-33.9960994351649,46.7416433229874,1.20847405160905,25.5660347004922,-43.6197230546796,-66.4966711314414,95.2208292015278,-43.5930056753265,77.4700932435424,-11.3892794250771,19.6717675707837,-26.3438773809578,5.8838685215405,34.4589743793149,-55.3790962964125,-19.2926501695037,23.3981860558057,4.61464494056441,21.225066817134,-121.287921869455,-22.2314913966622,-52.8509484580436,-77.6108269508814,45.482710368137,-40.9444702445933,30.6031860766845,20.2122681701092,25.5432989141772,-25.8828550842807,59.4840091122676,-17.4115264842447,-2.40434474086709,-31.1383048407228,91.1695350499447,19.6297019982158,-11.0581570221627,69.1685628708782,-40.1681676374665,32.611924247639,-10.8533495870535,2.7489293718562,60.0217866782442,-29.6609083770713,81.8402141841094,-1.719690277714,20.4655551898078,-61.9897229090999,-39.9309189158507,-37.6910386009108,-83.0968141117788,57.4628331009818,7.81618925686741,86.2330855815594,6.41306788451144,-13.9786072997683,41.9887442078321,1.38619416201718,-35.2866240165053,44.0794998113294,74.5068147205299,97.9356664692912,43.2927233207322,-29.2511422806137,-1.04061452782688,87.0597418345398,-45.7091182819685,76.4139972846996,-5.06767491271939,43.270407728351,-58.7935056986307,57.1003244277275,-124.284983123327,-20.6361946440352],"z":[14.4433746194537,73.6419075468557,-4.12252884625644,-36.7947656638453,22.5727893369401,28.7169616918795,-39.4078582941947,-58.9996912372938,61.4324270329008,15.2521692846821,-53.959114213929,-65.7353834676327,39.6210957405027,31.7618640297212,-71.5792472612978,-37.6514273971197,-95.1231244009534,32.5707614739835,-2.574684546356,13.0922985049363,-44.4893671801986,-13.9587533709559,38.5884160835129,36.941494391536,-8.3852512622659,44.1424760162707,13.5068740069953,-11.5832324202859,30.8628694026069,-49.8798239960916,44.3342736019198,-5.97102487390717,-21.0580644022308,15.1297616269398,60.6493690305427,-56.2334306349418,-4.6068594251015,41.0015671218337,-109.054207823621,80.9268686777502,75.5133413176364,55.4830560245933,-32.1293381169056,24.5929361456099,60.9990195385238,-32.7920837014595,49.5886917447029,-41.3231824063551,46.6687316045696,-36.9248263153452,22.1189297573828,-14.2461822315398,53.8633653758892,-45.1236374803291,59.8153519722351,0.0135359214998918,-6.76611766547812,-38.1747311310124,19.6016745816593,-90.6912775665534,16.189435473157,-72.0117269852754,-102.248604168908,-8.07576579188661,-10.5980105320371,-95.4005387397385,25.4812990585129,75.4785471232121,19.5372797228912,9.75130660414105,-20.0905953527906,-68.6371540818144,-26.1423509665497,10.3865879641954,29.4705200001886,0.839621816476604,-37.0694556283622,52.5820731398342,8.93703687063038,36.7947788858545,32.7422791245015,14.0083360114318,-4.31893007339812,-12.6896410349944,44.4877288723771,70.2718213445726,-22.7700142250266,3.7295314892925,31.7747172509015,-19.4460144143153,111.738072057527,25.968763861394,18.165082632402,76.4826284442393,-16.8851538144735,9.87926412703678,-8.33266671333825,2.59585121700165,-8.25338860921372,12.8437099174172,3.10817159469454,21.4563783410558,-9.20992999893639,-1.56785615841894,50.3973610319599,36.642141081662,7.67072835350195,-37.9477057339374,-35.9906553647311,-21.0139405243512,-19.707933526554,18.0597172531909,19.0242133864905,-84.771024981342,30.3969781898882,-50.7332736986664,-14.5479895233108,40.6186909069621,25.5073464526351,-44.8650287388969,1.00655755244037,22.5116314870241,6.73443373517409,-0.315216694059143,80.9949060018774,-100.950056308057,-57.0796881199647,35.5597222949769,45.1438885003671,-54.8113255224926,27.008730667217,-61.963057364094,75.5154122559307,-20.126026617202,45.1529966164939,-35.834828186381,-85.97003204647,-31.9784738544035,23.9461482235661,43.4084692212702,-86.6197348959631,-1.62067694843777,5.78710548786037,13.4674818908744,-1.08255177661878,38.0988458004362,39.7781655235771,-76.0053095323458,27.1919885499744,15.7077253517216,-31.6294167622333],"text":["TCGA-PAAD: TCGA.IB.AAUO.01A.12R.A38C.07","TCGA-PAAD: TCGA.3A.A9I9.01A.11R.A38C.07","TCGA-PAAD: TCGA.HZ.8519.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7885.01A.11R.2156.07","TCGA-PAAD: TCGA.US.A774.01A.21R.A32O.07","TCGA-PAAD: TCGA.S4.A8RM.01A.11R.A37L.07","TCGA-PAAD: TCGA.2J.AABA.01A.21R.A41B.07","TCGA-PAAD: TCGA.M8.A5N4.01A.11R.A26U.07","TCGA-PAAD: TCGA.2L.AAQL.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAQ6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7645.01A.22R.2204.07","TCGA-PAAD: TCGA.2J.AABU.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPQ.01A.11R.A41B.07","TCGA-PAAD: TCGA.HZ.A4BK.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.AAUR.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7887.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7893.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABF.01A.31R.A41B.07","TCGA-PAAD: TCGA.HV.AA8V.01A.11R.A41B.07","TCGA-PAAD: TCGA.FB.AAPZ.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7888.01A.11R.2156.07","TCGA-PAAD: TCGA.PZ.A5RE.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AAB9.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.A6UF.01A.23R.A33R.07","TCGA-PAAD: TCGA.HV.A5A3.01A.11R.A26U.07","TCGA-PAAD: TCGA.S4.A8RP.01A.11R.A36G.07","TCGA-PAAD: TCGA.F2.A7TX.01A.33R.A38C.07","TCGA-PAAD: TCGA.HV.A7OL.01A.11R.A33R.07","TCGA-PAAD: TCGA.HZ.A49H.01A.11R.A26U.07","TCGA-PAAD: TCGA.XN.A8T5.01A.12R.A36G.07","TCGA-PAAD: TCGA.FB.AAQ1.01A.12R.A41B.07","TCGA-PAAD: TCGA.LB.A7SX.01A.11R.A33R.07","TCGA-PAAD: TCGA.RB.A7B8.01A.12R.A33R.07","TCGA-PAAD: TCGA.XD.AAUI.01A.42R.A41B.07","TCGA-PAAD: TCGA.2J.AABH.01A.21R.A41B.07","TCGA-PAAD: TCGA.IB.AAUP.01A.11R.A37L.07","TCGA-PAAD: TCGA.3A.A9IB.01A.21R.A39D.07","TCGA-PAAD: TCGA.IB.AAUT.01A.11R.A37L.07","TCGA-PAAD: TCGA.Z5.AAPL.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABK.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.AAUM.01A.11R.A37L.07","TCGA-PAAD: TCGA.FB.A4P6.01A.12R.A26U.07","TCGA-PAAD: TCGA.3A.A9IC.01A.11R.A38C.07","TCGA-PAAD: TCGA.FB.AAPU.01A.31R.A41B.07","TCGA-PAAD: TCGA.2L.AAQI.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.A4BH.01A.11R.A26U.07","TCGA-PAAD: TCGA.HZ.8317.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7897.01A.21R.2204.07","TCGA-PAAD: TCGA.HZ.A8P1.01A.11R.A37L.07","TCGA-PAAD: TCGA.2L.AAQE.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.A77P.01A.11R.A33R.07","TCGA-PAAD: TCGA.IB.A7LX.01A.12R.A36G.07","TCGA-PAAD: TCGA.2J.AAB4.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABT.01A.11R.A41B.07","TCGA-PAAD: TCGA.LB.A9Q5.01A.11R.A39D.07","TCGA-PAAD: TCGA.HZ.8315.01A.11R.2404.07","TCGA-PAAD: TCGA.XD.AAUG.01A.61R.A41B.07","TCGA-PAAD: TCGA.IB.A5SQ.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7652.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77Q.01A.11R.A36G.07","TCGA-PAAD: TCGA.HV.A5A4.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.7890.01A.12R.2204.07","TCGA-PAAD: TCGA.Q3.A5QY.01A.12R.A32O.07","TCGA-PAAD: TCGA.IB.7644.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.A5SO.01A.11R.A32O.07","TCGA-PAAD: TCGA.2J.AABI.01A.12R.A41B.07","TCGA-PAAD: TCGA.2J.AABO.01A.21R.A41B.07","TCGA-PAAD: TCGA.US.A779.01A.11R.A32O.07","TCGA-PAAD: TCGA.3A.A9IH.01A.12R.A39D.07","TCGA-PAAD: TCGA.HZ.7919.01A.11R.2156.07","TCGA-PAAD: TCGA.HV.A5A6.01A.11R.A26U.07","TCGA-PAAD: TCGA.YH.A8SY.01A.11R.A37L.07","TCGA-PAAD: TCGA.F2.6879.01A.11R.2156.07","TCGA-PAAD: TCGA.3A.A9IU.01A.11R.A39D.07","TCGA-PAAD: TCGA.HV.AA8X.01A.11R.A39D.07","TCGA-PAAD: TCGA.IB.8127.01A.11R.2404.07","TCGA-PAAD: TCGA.FB.AAPS.01A.12R.A39D.07","TCGA-PAAD: TCGA.FB.AAQ3.01A.11R.A41B.07","TCGA-PAAD: TCGA.US.A77E.01A.11R.A32O.07","TCGA-PAAD: TCGA.F2.A44H.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9I5.01A.11R.A38C.07","TCGA-PAAD: TCGA.RB.AA9M.01A.11R.A39D.07","TCGA-PAAD: TCGA.FB.A545.01A.11R.A26U.07","TCGA-PAAD: TCGA.Q3.AA2A.01A.11R.A37L.07","TCGA-PAAD: TCGA.IB.8126.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.A5SP.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8001.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AABE.01A.12R.A41B.07","TCGA-PAAD: TCGA.IB.AAUN.01A.12R.A38C.07","TCGA-PAAD: TCGA.2L.AAQJ.01A.12R.A39D.07","TCGA-PAAD: TCGA.2J.AABV.01A.12R.A41B.07","TCGA-PAAD: TCGA.XN.A8T3.01A.11R.A36G.07","TCGA-PAAD: TCGA.OE.A75W.01A.12R.A32O.07","TCGA-PAAD: TCGA.LB.A8F3.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.8636.01A.21R.2404.07","TCGA-PAAD: TCGA.XD.AAUL.01A.21R.A39D.07","TCGA-PAAD: TCGA.3A.A9I7.01A.21R.A38C.07","TCGA-PAAD: TCGA.US.A776.01A.13R.A33R.07","TCGA-PAAD: TCGA.IB.A7M4.01A.11R.A36G.07","TCGA-PAAD: TCGA.3A.A9IZ.01A.12R.A41B.07","TCGA-PAAD: TCGA.2L.AAQA.01A.21R.A38C.07","TCGA-PAAD: TCGA.IB.7889.01A.11R.2156.07","TCGA-PAAD: TCGA.F2.A8YN.01A.11R.A37L.07","TCGA-PAAD: TCGA.YB.A89D.01A.12R.A36G.07","TCGA-PAAD: TCGA.IB.A6UG.01A.32R.A33R.07","TCGA-PAAD: TCGA.FB.AAPY.01A.11R.A41B.07","TCGA-PAAD: TCGA.S4.A8RO.01A.12R.A37L.07","TCGA-PAAD: TCGA.HZ.8637.01A.11R.2404.07","TCGA-PAAD: TCGA.2J.AAB6.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7886.01A.11R.2156.07","TCGA-PAAD: TCGA.H6.8124.01A.11R.2404.07","TCGA-PAAD: TCGA.IB.7891.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.7926.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.7646.01A.11R.2156.07","TCGA-PAAD: TCGA.2J.AABR.01A.11R.A41B.07","TCGA-PAAD: TCGA.3A.A9J0.01A.11R.A41B.07","TCGA-PAAD: TCGA.IB.7651.01A.11R.2156.07","TCGA-PAAD: TCGA.IB.AAUU.01A.11R.A37L.07","TCGA-PAAD: TCGA.HZ.A8P0.01A.11R.A36G.07","TCGA-PAAD: TCGA.IB.AAUS.01A.12R.A38C.07","TCGA-PAAD: TCGA.F2.A44G.01A.11R.A26U.07","TCGA-PAAD: TCGA.3A.A9IX.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAZ.01A.11R.A38C.07","TCGA-PAAD: TCGA.IB.AAUQ.01A.22R.A41I.07","TCGA-PAAD: TCGA.US.A77G.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.8005.01A.11R.2204.07","TCGA-PAAD: TCGA.2J.AAB8.01A.12R.A41B.07","TCGA-PAAD: TCGA.YY.A8LH.01A.11R.A36G.07","TCGA-PAAD: TCGA.HZ.A49G.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.A5VM.01A.11R.A32O.07","TCGA-PAAD: TCGA.IB.7649.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.7925.01A.11R.2156.07","TCGA-PAAD: TCGA.FB.A78T.01A.12R.A32O.07","TCGA-PAAD: TCGA.HZ.7922.01A.11R.2156.07","TCGA-PAAD: TCGA.HZ.A77O.01A.11R.A33R.07","TCGA-PAAD: TCGA.FB.AAQ2.01A.31R.A41B.07","TCGA-PAAD: TCGA.IB.A5ST.01A.11R.A32O.07","TCGA-PAAD: TCGA.XD.AAUH.01A.42R.A41B.07","TCGA-PAAD: TCGA.HZ.8003.01A.21R.2204.07","TCGA-PAAD: TCGA.HV.A5A5.01A.11R.A26U.07","TCGA-PAAD: TCGA.IB.A5SS.01A.11R.A32O.07","TCGA-PAAD: TCGA.HZ.A49I.01A.12R.A26U.07","TCGA-PAAD: TCGA.HZ.8002.01A.11R.2204.07","TCGA-PAAD: TCGA.HZ.A9TJ.01A.11R.A41I.07","TCGA-PAAD: TCGA.FB.A4P5.01A.11R.A26U.07","TCGA-PAAD: TCGA.2J.AAB1.01A.11R.A41B.07","TCGA-PAAD: TCGA.3E.AAAY.01A.11R.A38C.07","TCGA-PAAD: TCGA.L1.A7W4.01A.12R.A36G.07","TCGA-PAAD: TCGA.H6.A45N.01A.11R.A26U.07","TCGA-PAAD: TCGA.FB.AAQ0.01A.31R.A41B.07","Avner: CCR170012_MH17T001P013"],"mode":"markers","marker":{"color":"rgba(0,191,255,1)","size":8,"opacity":0.7,"symbol":["circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","square"],"line":{"color":"rgba(0,191,255,1)"}},"type":"scatter3d","name":"PDAC","textfont":{"color":"rgba(0,191,255,1)"},"error_y":{"color":"rgba(0,191,255,1)"},"error_x":{"color":"rgba(0,191,255,1)"},"line":{"color":"rgba(0,191,255,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save PCA plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_PCA_3d_targets.html"), selfcontained = TRUE)
```



Below we plot all combinations between the first 5 principal components (PCs), which may help in identifying which PCs explain the biological and/or batch effects.


```r
##### Plot all combinations between the first 5 PCs
p <- as.data.frame(y.norm.cpm.subset_pca$x[,1:5]) %>%
  plot_ly(width = 800, height = 800) %>%
  add_trace( type = 'splom', dimensions = list(
      list(label='PC1', values=~PC1), list(label='PC2', values=~PC2), list(label='PC3', values=~PC3), list(label='PC4', values=~PC4), list(label='PC5', values=~PC5)
    ),
  text=paste(targetFile$Target, rownames(y.norm.cpm.subset_pca$x), sep=": "),
    marker = list( color = targets.colour[[2]], size = 7, opacity = 0.7
    )
  ) %>%
  layout(
    title= "",
    hovermode="closest",
    plot_bgcolor="rgba(240,240,240, 0.95)",
    xaxis=list(domain=NULL, showline=F, zeroline=F, gridcolor='#ffff', ticklen=4),
    yaxis=list(domain=NULL, showline=F, zeroline=F, gridcolor='#ffff', ticklen=4),
    xaxis2=axis, xaxis3=axis, xaxis4=axis, xaxis5=axis, yaxis2=axis, yaxis3=axis, yaxis4=axis, yaxis5=axis, legend = list(orientation = "v", y = 0.9)
)

p
```

<!--html_preserve--><div id="htmlwidget-c4721c172970054c7d18" style="width:800px;height:800px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c4721c172970054c7d18">{"x":{"visdat":{"1c2528d91f02":["function () ","plotlyVisDat"]},"cur_data":"1c2528d91f02","attrs":{"1c2528d91f02":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"splom","dimensions":[{"label":"PC1","values":{}},{"label":"PC2","values":{}},{"label":"PC3","values":{}},{"label":"PC4","values":{}},{"label":"PC5","values":{}}],"text":["PDAC: TCGA.IB.AAUO.01A.12R.A38C.07","PDAC: TCGA.3A.A9I9.01A.11R.A38C.07","PDAC: TCGA.HZ.8519.01A.11R.2404.07","PDAC: TCGA.IB.7885.01A.11R.2156.07","PDAC: TCGA.US.A774.01A.21R.A32O.07","PDAC: TCGA.S4.A8RM.01A.11R.A37L.07","PanNET: TCGA.3A.A9IR.01A.11R.A38C.07","PanNET: TCGA.3A.A9IJ.01A.11R.A39D.07","PDAC: TCGA.2J.AABA.01A.21R.A41B.07","PDAC: TCGA.M8.A5N4.01A.11R.A26U.07","PDAC: TCGA.2L.AAQL.01A.11R.A38C.07","PDAC: TCGA.FB.AAQ6.01A.11R.A41B.07","PDAC: TCGA.IB.7645.01A.22R.2204.07","PDAC: TCGA.2J.AABU.01A.11R.A41B.07","PanNET: TCGA.3A.A9IV.01A.11R.A41B.07","PDAC: TCGA.FB.AAPQ.01A.11R.A41B.07","PDAC: TCGA.HZ.A4BK.01A.11R.A26U.07","PDAC: TCGA.IB.AAUR.01A.21R.A38C.07","PDAC: TCGA.IB.7887.01A.11R.2156.07","PDAC: TCGA.IB.7893.01A.11R.2204.07","PDAC: TCGA.2J.AABF.01A.31R.A41B.07","PanNET: TCGA.3A.A9IN.01A.11R.A39D.07","PDAC: TCGA.HV.AA8V.01A.11R.A41B.07","PDAC: TCGA.FB.AAPZ.01A.11R.A41B.07","PDAC: TCGA.IB.7888.01A.11R.2156.07","PDAC: TCGA.PZ.A5RE.01A.11R.A32O.07","PDAC: TCGA.2J.AAB9.01A.11R.A41B.07","PDAC: TCGA.IB.A6UF.01A.23R.A33R.07","PDAC: TCGA.HV.A5A3.01A.11R.A26U.07","PDAC: TCGA.S4.A8RP.01A.11R.A36G.07","PDAC: TCGA.F2.A7TX.01A.33R.A38C.07","PDAC: TCGA.HV.A7OL.01A.11R.A33R.07","PDAC: TCGA.HZ.A49H.01A.11R.A26U.07","PDAC: TCGA.XN.A8T5.01A.12R.A36G.07","PDAC: TCGA.FB.AAQ1.01A.12R.A41B.07","PDAC: TCGA.LB.A7SX.01A.11R.A33R.07","Normal: TCGA.YB.A89D.11A.11R.A36G.07","PDAC: TCGA.RB.A7B8.01A.12R.A33R.07","PDAC: TCGA.XD.AAUI.01A.42R.A41B.07","PDAC: TCGA.2J.AABH.01A.21R.A41B.07","PanNET: TCGA.3A.A9IO.01A.11R.A38C.07","PDAC: TCGA.IB.AAUP.01A.11R.A37L.07","PDAC: TCGA.3A.A9IB.01A.21R.A39D.07","PDAC: TCGA.IB.AAUT.01A.11R.A37L.07","PDAC: TCGA.Z5.AAPL.01A.12R.A41B.07","PDAC: TCGA.2J.AABK.01A.31R.A41B.07","PDAC: TCGA.IB.AAUM.01A.11R.A37L.07","PDAC: TCGA.FB.A4P6.01A.12R.A26U.07","PDAC: TCGA.3A.A9IC.01A.11R.A38C.07","PDAC: TCGA.FB.AAPU.01A.31R.A41B.07","PDAC: TCGA.2L.AAQI.01A.12R.A39D.07","PDAC: TCGA.HZ.A4BH.01A.11R.A26U.07","PDAC: TCGA.HZ.8317.01A.11R.2404.07","PDAC: TCGA.IB.7897.01A.21R.2204.07","PDAC: TCGA.HZ.A8P1.01A.11R.A37L.07","PDAC: TCGA.2L.AAQE.01A.11R.A39D.07","PDAC: TCGA.HZ.A77P.01A.11R.A33R.07","PDAC: TCGA.IB.A7LX.01A.12R.A36G.07","PDAC: TCGA.2J.AAB4.01A.12R.A41B.07","IPMN: TCGA.FB.AAPP.01A.12R.A41B.07","PDAC: TCGA.2J.AABT.01A.11R.A41B.07","PDAC: TCGA.LB.A9Q5.01A.11R.A39D.07","PDAC: TCGA.HZ.8315.01A.11R.2404.07","PDAC: TCGA.XD.AAUG.01A.61R.A41B.07","PDAC: TCGA.IB.A5SQ.01A.11R.A32O.07","PDAC: TCGA.IB.7652.01A.11R.2156.07","PDAC: TCGA.HZ.A77Q.01A.11R.A36G.07","PDAC: TCGA.HV.A5A4.01A.11R.A26U.07","PDAC: TCGA.IB.7890.01A.12R.2204.07","PDAC: TCGA.Q3.A5QY.01A.12R.A32O.07","PDAC: TCGA.IB.7644.01A.11R.2156.07","PDAC: TCGA.IB.A5SO.01A.11R.A32O.07","PDAC: TCGA.2J.AABI.01A.12R.A41B.07","PDAC: TCGA.2J.AABO.01A.21R.A41B.07","PDAC: TCGA.US.A779.01A.11R.A32O.07","PDAC: TCGA.3A.A9IH.01A.12R.A39D.07","PDAC: TCGA.HZ.7919.01A.11R.2156.07","PDAC: TCGA.HV.A5A6.01A.11R.A26U.07","PDAC: TCGA.YH.A8SY.01A.11R.A37L.07","PDAC: TCGA.F2.6879.01A.11R.2156.07","PDAC: TCGA.3A.A9IU.01A.11R.A39D.07","PDAC: TCGA.HV.AA8X.01A.11R.A39D.07","PDAC: TCGA.IB.8127.01A.11R.2404.07","PDAC: TCGA.FB.AAPS.01A.12R.A39D.07","PDAC: TCGA.FB.AAQ3.01A.11R.A41B.07","PDAC: TCGA.US.A77E.01A.11R.A32O.07","PDAC: TCGA.F2.A44H.01A.11R.A26U.07","PDAC: TCGA.3A.A9I5.01A.11R.A38C.07","PDAC: TCGA.RB.AA9M.01A.11R.A39D.07","IPMN: TCGA.HV.A7OP.01A.11R.A33R.07","PDAC: TCGA.FB.A545.01A.11R.A26U.07","PDAC: TCGA.Q3.AA2A.01A.11R.A37L.07","PDAC: TCGA.IB.8126.01A.11R.2404.07","PDAC: TCGA.IB.A5SP.01A.11R.A32O.07","Metastatic: TCGA.HZ.A9TJ.06A.11R.A41B.07","PDAC: TCGA.HZ.8001.01A.11R.2204.07","PDAC: TCGA.2J.AABE.01A.12R.A41B.07","PanNET: TCGA.3A.A9IL.01A.11R.A38C.07","PDAC: TCGA.IB.AAUN.01A.12R.A38C.07","PDAC: TCGA.2L.AAQJ.01A.12R.A39D.07","PDAC: TCGA.2J.AABV.01A.12R.A41B.07","PDAC: TCGA.XN.A8T3.01A.11R.A36G.07","PDAC: TCGA.OE.A75W.01A.12R.A32O.07","PDAC: TCGA.LB.A8F3.01A.11R.A36G.07","PDAC: TCGA.HZ.8636.01A.21R.2404.07","PDAC: TCGA.XD.AAUL.01A.21R.A39D.07","PanNET: TCGA.2L.AAQM.01A.11R.A39D.07","PDAC: TCGA.3A.A9I7.01A.21R.A38C.07","PDAC: TCGA.US.A776.01A.13R.A33R.07","PDAC: TCGA.IB.A7M4.01A.11R.A36G.07","PDAC: TCGA.3A.A9IZ.01A.12R.A41B.07","PDAC: TCGA.2L.AAQA.01A.21R.A38C.07","PDAC: TCGA.IB.7889.01A.11R.2156.07","PDAC: TCGA.F2.A8YN.01A.11R.A37L.07","PDAC: TCGA.YB.A89D.01A.12R.A36G.07","PanNET: TCGA.3A.A9IS.01A.21R.A39D.07","PDAC: TCGA.IB.A6UG.01A.32R.A33R.07","PDAC: TCGA.FB.AAPY.01A.11R.A41B.07","PDAC: TCGA.S4.A8RO.01A.12R.A37L.07","PDAC: TCGA.HZ.8637.01A.11R.2404.07","PDAC: TCGA.2J.AAB6.01A.11R.A41B.07","PDAC: TCGA.IB.7886.01A.11R.2156.07","PDAC: TCGA.H6.8124.01A.11R.2404.07","PDAC: TCGA.IB.7891.01A.11R.2204.07","Normal: TCGA.H6.A45N.11A.12R.A26U.07","PDAC: TCGA.HZ.7926.01A.11R.2156.07","PDAC: TCGA.IB.7646.01A.11R.2156.07","PDAC: TCGA.2J.AABR.01A.11R.A41B.07","PDAC: TCGA.3A.A9J0.01A.11R.A41B.07","PDAC: TCGA.IB.7651.01A.11R.2156.07","PDAC: TCGA.IB.AAUU.01A.11R.A37L.07","PDAC: TCGA.HZ.A8P0.01A.11R.A36G.07","PDAC: TCGA.IB.AAUS.01A.12R.A38C.07","PDAC: TCGA.F2.A44G.01A.11R.A26U.07","PDAC: TCGA.3A.A9IX.01A.11R.A41B.07","PDAC: TCGA.3E.AAAZ.01A.11R.A38C.07","PDAC: TCGA.IB.AAUQ.01A.22R.A41I.07","PDAC: TCGA.US.A77G.01A.11R.A32O.07","PDAC: TCGA.HZ.8005.01A.11R.2204.07","PDAC: TCGA.2J.AAB8.01A.12R.A41B.07","Normal: TCGA.HV.A5A3.11A.11R.A26U.07","PDAC: TCGA.YY.A8LH.01A.11R.A36G.07","PDAC: TCGA.HZ.A49G.01A.11R.A26U.07","PDAC: TCGA.FB.A5VM.01A.11R.A32O.07","PDAC: TCGA.IB.7649.01A.11R.2156.07","PDAC: TCGA.HZ.7925.01A.11R.2156.07","PDAC: TCGA.FB.A78T.01A.12R.A32O.07","PDAC: TCGA.HZ.7922.01A.11R.2156.07","PDAC: TCGA.HZ.A77O.01A.11R.A33R.07","PDAC: TCGA.FB.AAQ2.01A.31R.A41B.07","PDAC: TCGA.IB.A5ST.01A.11R.A32O.07","PDAC: TCGA.XD.AAUH.01A.42R.A41B.07","PDAC: TCGA.HZ.8003.01A.21R.2204.07","PDAC: TCGA.HV.A5A5.01A.11R.A26U.07","PDAC: TCGA.IB.A5SS.01A.11R.A32O.07","PDAC: TCGA.HZ.A49I.01A.12R.A26U.07","Normal: TCGA.H6.8124.11A.01R.2404.07","PDAC: TCGA.HZ.8002.01A.11R.2204.07","PDAC: TCGA.HZ.A9TJ.01A.11R.A41I.07","PDAC: TCGA.FB.A4P5.01A.11R.A26U.07","PDAC: TCGA.2J.AAB1.01A.11R.A41B.07","PDAC: TCGA.3E.AAAY.01A.11R.A38C.07","PDAC: TCGA.L1.A7W4.01A.12R.A36G.07","PDAC: TCGA.H6.A45N.01A.11R.A26U.07","PDAC: TCGA.FB.AAQ0.01A.31R.A41B.07","Organoid: CCR170093_RNA_WPT_013","PDAC: CCR170012_MH17T001P013"],"marker":{"color":["deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkred","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","green","deepskyblue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","red","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","red","deepskyblue","deepskyblue","deepskyblue","deepskyblue","blue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","green","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","green","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","green","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkgoldenrod","deepskyblue"],"size":7,"opacity":0.7},"inherit":true}},"layout":{"width":800,"height":800,"margin":{"b":40,"l":60,"t":25,"r":10},"title":"","hovermode":"closest","plot_bgcolor":"rgba(240,240,240, 0.95)","xaxis":{"domain":[],"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":4},"yaxis":{"domain":[],"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":4},"xaxis2":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"xaxis3":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"xaxis4":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"xaxis5":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"yaxis2":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"yaxis3":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"yaxis4":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"yaxis5":{"showline":false,"zeroline":false,"gridcolor":"#ffff","ticklen":5},"legend":{"orientation":"v","y":0.9},"showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"type":"splom","dimensions":[{"label":"PC1","values":[-39.5096329738213,-0.9505355203886,80.2127705047868,-46.6230272166826,-27.1441323826728,-33.405260943958,254.460947231326,267.88992161989,-34.0023167958671,-55.3480676372859,-5.60915111816782,-23.6603991658158,-1.73724967460498,-44.1529304681383,224.453407921171,-31.4517058117416,-27.3741670418291,8.95319781501381,-48.7635072481656,-18.6611006738754,-10.8112677324935,205.494928124774,-21.7235872145004,-25.7935281045507,22.5336300615491,-51.2106961117494,-4.75603870600442,-21.3782025618893,-51.0637610497309,-8.40918772983574,-9.62561098082745,-55.1413865942984,17.2780844973726,29.7644621792625,-0.599146807661378,-26.0403425923249,-18.5291516603558,-22.2591111664937,-15.6396539159804,-5.47469531112594,224.979561127269,-11.2446478790358,-22.8484060882454,17.2106872488172,-2.52297915054892,18.8700354963358,25.2036386603,16.6812598620333,-37.9148215642545,-33.0443803562137,-16.8226751641533,-8.30164988472832,-11.9588165083182,67.4957652118502,-27.0466788657155,-32.2849438435798,15.2220232259752,-39.3760650643882,-11.0314730731224,25.0409903306279,6.64538342370945,2.31070894211073,-34.2422879349515,39.5548849803914,37.0912017070588,-5.17510042752755,-38.595908396523,-20.8868625337465,-1.06787109830572,-9.70080534427894,-40.4470566422701,-17.433622191752,-9.30737146604097,-11.9030176002842,-6.50445511943287,-13.5967922314083,-36.7969011077622,-33.3578684842641,-55.158622958603,-46.7913639046901,-40.053807011482,-28.5007568946637,-44.5965513819438,2.88966076089788,-43.9403545793389,-27.895206833818,14.0534016337911,48.8322490551398,18.666778519432,40.6256668841229,-22.7207085825641,-50.0016980143501,35.1917082529504,-19.5596616917483,12.5427537830307,19.9847552302763,-36.0590582414961,198.247287550819,-28.426362759485,-59.3563817822117,18.5140763076994,12.548483996723,-44.886876885917,23.7435159342809,-23.3523525453009,-33.6454088392129,223.80018994889,-27.8943798117145,26.6914988763467,-41.8186105096457,-45.2332689447674,-63.6129891062409,-23.9949036163229,-56.4386454233988,-18.409584919232,316.804873693753,-3.61490628635037,-28.4664778938386,-15.2809885879065,28.0712787550042,-5.72502772557059,-47.8378725517243,-13.8703310029183,0.0836406521641423,89.4220691900872,-34.1986729312702,-29.0339058245327,3.08077895985972,-56.1190496657094,-10.6610156191389,-33.1059208412153,-24.9183301808939,-17.8165375537453,-54.9078329721756,4.78773455576834,-16.4672550332323,-2.80010447463,-24.7980389455741,-20.8239609548476,-50.3351268187208,39.1939807238073,-34.1326482882487,-3.66868407496047,-1.48495068372064,-2.0057179917184,-20.1802101973969,-18.4501134088173,-31.3268296852103,-31.2466950492202,12.6143352842551,-17.2489615674335,64.7407938131919,22.3855394502879,11.5118758656272,-29.6793672635051,-23.0190198633823,44.5426805875147,22.8590441054633,-17.8902878778119,2.6842240602341,-32.1569787115552,-6.39955696632374,6.17368294369863,5.64165749724985,-48.0795303820063,28.3761904119425,3.70657659121272]},{"label":"PC2","values":[-34.399269297641,23.2053421393136,58.8662840107597,27.5560235691365,56.2020593453304,-59.2321436665237,-81.1441830815798,-56.7030467758504,-8.75882545773145,-55.373018967477,9.04771077484417,-66.2387779270581,69.5120956588285,-38.0471354434322,-51.1228411552338,-44.065536176215,16.0489669837953,60.9218515939107,-29.7398154560986,14.340222180226,36.0645822796106,20.0644929603723,22.5272376108219,18.0140903654966,81.4420522012264,-31.7502152942052,54.6965414822371,-26.5580751011711,-76.701521149603,14.5638653808841,34.726874436223,-37.8658598190469,80.1206935775191,52.1020823347876,-12.0106311201158,-35.461679374984,48.7984125678722,-1.18392140635895,34.6929673302986,1.56239226147181,-6.45521730326628,60.4572973418011,9.15822305935094,73.8838276282681,15.342749763907,9.31613946784426,53.8214209466886,44.601968302529,-17.2799534289966,-86.5527312034837,7.59482346797364,27.2242059327944,35.5392214927861,101.961830622603,-84.0338710447212,-41.6734377551029,37.7134321048641,-53.0005107116629,6.06592702479911,-210.6638900255,5.3746657533973,53.2769460110038,38.0335713461849,83.2400960801393,53.867850847346,52.3972236258561,32.0309063278044,-6.28128059700764,23.8137275934406,44.0114600492213,-34.6680652507444,52.0932320779514,-44.9894188560586,17.2751288807307,-54.3840258252979,-12.4465964127922,19.0787450981375,-66.0691782916553,-35.2066389950616,-81.0699372074134,-5.02806569061731,-54.8024505705096,15.9763424903294,62.6611544430876,-38.6469120267407,-33.9960994351649,46.7416433229874,1.20847405160905,25.5660347004922,-146.020148943408,-43.6197230546796,-66.4966711314414,95.2208292015278,-43.5930056753265,-57.5673900379553,77.4700932435424,-11.3892794250771,-2.56315721580087,19.6717675707837,-26.3438773809578,5.8838685215405,34.4589743793149,-55.3790962964125,-19.2926501695037,23.3981860558057,4.61464494056441,-66.520607816587,21.225066817134,-121.287921869455,-22.2314913966622,-52.8509484580436,-77.6108269508814,45.482710368137,-40.9444702445933,30.6031860766845,-102.234655613013,20.2122681701092,25.5432989141772,-25.8828550842807,59.4840091122676,-17.4115264842447,-2.40434474086709,-31.1383048407228,91.1695350499447,32.1695564435801,19.6297019982158,-11.0581570221627,69.1685628708782,-40.1681676374665,32.611924247639,-10.8533495870535,2.7489293718562,60.0217866782442,-29.6609083770713,81.8402141841094,-1.719690277714,20.4655551898078,-61.9897229090999,-39.9309189158507,-37.6910386009108,46.39511808786,-83.0968141117788,57.4628331009818,7.81618925686741,86.2330855815594,6.41306788451144,-13.9786072997683,41.9887442078321,1.38619416201718,-35.2866240165053,44.0794998113294,74.5068147205299,97.9356664692912,43.2927233207322,-29.2511422806137,-1.04061452782688,79.5899759522146,87.0597418345398,-45.7091182819685,76.4139972846996,-5.06767491271939,43.270407728351,-58.7935056986307,57.1003244277275,-124.284983123327,-271.839201781264,-20.6361946440352]},{"label":"PC3","values":[14.4433746194537,73.6419075468557,-4.12252884625644,-36.7947656638453,22.5727893369401,28.7169616918795,-28.4218023447517,3.31215691523526,-39.4078582941947,-58.9996912372938,61.4324270329008,15.2521692846821,-53.959114213929,-65.7353834676327,-28.5393583639167,39.6210957405027,31.7618640297212,-71.5792472612978,-37.6514273971197,-95.1231244009534,32.5707614739835,-24.1704954688484,-2.574684546356,13.0922985049363,-44.4893671801986,-13.9587533709559,38.5884160835129,36.941494391536,-8.3852512622659,44.1424760162707,13.5068740069953,-11.5832324202859,30.8628694026069,-49.8798239960916,44.3342736019198,-5.97102487390717,-17.0217230182258,-21.0580644022308,15.1297616269398,60.6493690305427,43.9667191049479,-56.2334306349418,-4.6068594251015,41.0015671218337,-109.054207823621,80.9268686777502,75.5133413176364,55.4830560245933,-32.1293381169056,24.5929361456099,60.9990195385238,-32.7920837014595,49.5886917447029,-41.3231824063551,46.6687316045696,-36.9248263153452,22.1189297573828,-14.2461822315398,53.8633653758892,8.79742089194846,-45.1236374803291,59.8153519722351,0.0135359214998918,-6.76611766547812,-38.1747311310124,19.6016745816593,-90.6912775665534,16.189435473157,-72.0117269852754,-102.248604168908,-8.07576579188661,-10.5980105320371,-95.4005387397385,25.4812990585129,75.4785471232121,19.5372797228912,9.75130660414105,-20.0905953527906,-68.6371540818144,-26.1423509665497,10.3865879641954,29.4705200001886,0.839621816476604,-37.0694556283622,52.5820731398342,8.93703687063038,36.7947788858545,32.7422791245015,14.0083360114318,33.9085738513744,-4.31893007339812,-12.6896410349944,44.4877288723771,70.2718213445726,-14.1878488007826,-22.7700142250266,3.7295314892925,17.5694258850915,31.7747172509015,-19.4460144143153,111.738072057527,25.968763861394,18.165082632402,76.4826284442393,-16.8851538144735,9.87926412703678,-9.02508367243031,-8.33266671333825,2.59585121700165,-8.25338860921372,12.8437099174172,3.10817159469454,21.4563783410558,-9.20992999893639,-1.56785615841894,-18.9613086988743,50.3973610319599,36.642141081662,7.67072835350195,-37.9477057339374,-35.9906553647311,-21.0139405243512,-19.707933526554,18.0597172531909,-134.353633977014,19.0242133864905,-84.771024981342,30.3969781898882,-50.7332736986664,-14.5479895233108,40.6186909069621,25.5073464526351,-44.8650287388969,1.00655755244037,22.5116314870241,6.73443373517409,-0.315216694059143,80.9949060018774,-100.950056308057,-57.0796881199647,29.0377604141077,35.5597222949769,45.1438885003671,-54.8113255224926,27.008730667217,-61.963057364094,75.5154122559307,-20.126026617202,45.1529966164939,-35.834828186381,-85.97003204647,-31.9784738544035,23.9461482235661,43.4084692212702,-86.6197348959631,-1.62067694843777,9.13084986437795,5.78710548786037,13.4674818908744,-1.08255177661878,38.0988458004362,39.7781655235771,-76.0053095323458,27.1919885499744,15.7077253517216,10.1288467931282,-31.6294167622333]},{"label":"PC4","values":[-30.5215179528616,-18.1148134083211,9.98000473162354,10.7868406079264,3.22406818584532,4.76421866250625,-20.5237060417052,-28.603203398937,-14.2412865136295,-7.91472363706741,-44.2433085188953,-14.094828774041,27.5152100534478,0.836379455420395,58.011188992471,14.3647549662214,-11.9265711865363,-63.0451924930352,23.2407003252296,95.9033811884572,-3.33690439189445,-27.3292536210579,-4.00809751044514,7.99387042664518,26.0530595049254,-17.3033552626164,9.69103665709617,9.14770163953408,0.587373218480175,-4.45201693456038,26.9420589675493,-88.0722191990734,-22.3638129986194,-29.463850118304,0.871833690572151,-33.7619910645081,-14.3781621948211,-27.1749806363972,-20.3890355393125,8.82158005547739,22.2569217720667,-37.6893609578941,22.5967514098125,-10.1254183564262,-71.9185987789307,-13.4104741810934,-12.4374461235002,6.79889822704671,-12.3700253815585,-2.77997428556688,24.8036286007148,-10.3345972243542,32.6298074205701,40.7624381819586,1.857387378923,-15.9288871201071,-2.19904793160285,10.1176848801939,8.12180325979207,6.47974101253709,-9.18671367801601,17.5459268100355,22.5748174911913,3.77865975073175,5.48951638835358,56.168131321937,-18.9391321428908,-11.6380596117443,66.0379163726169,-88.9990524131379,42.9816504873411,-16.4132053360349,-37.3107575906327,7.55104633593584,-30.064939400796,7.41306593965474,54.0413520614315,-0.83815112106209,-9.79931891917338,52.0486322655208,10.7410748565438,13.3307873006739,24.1032912369756,-29.4047443813027,-8.56693718797626,-0.964175814834657,12.4702171397645,-50.9000470804405,12.4843660865634,-116.87375401615,19.6231835363298,-37.4961021031799,16.5608891192151,4.29762675722137,-3.78110722223915,-19.7781957328296,-6.63503651933671,-7.45589686832821,15.8645185617458,-15.5845463682043,-59.3226556037017,8.92681390181989,-70.2703060159993,-22.371861917992,35.0740641688898,5.49828561929506,-17.5366513595037,-17.6502253446894,-41.4818913144677,-16.8437921885901,29.7225997026709,1.0012648090561,2.65666833776791,7.70905410876491,1.97394481876149,56.0854381914231,-13.7789263175618,-47.2649185,2.67435146456274,-11.6302748341639,20.3986976219694,45.3173931487574,46.6112599567345,53.2914401271107,-88.5870484258858,35.2332699456002,84.6474010432368,9.51641484180396,-26.8494726494928,42.0092584645978,4.05082127712511,-23.5950065750152,-20.2518969190238,12.4874342754209,6.81661661348944,-2.27245996431234,-7.89058698538117,-0.718373467556169,44.820000637312,-15.2592490874489,-4.04038606394445,-27.8778939355003,2.06632115664285,-62.2561125927123,54.5460453371818,42.7132065380241,-10.4608385101549,62.2883230456609,12.1102468744215,3.80260734301835,-43.4063686063914,-26.6590348406037,37.2430676070774,0.828622530620896,41.1723915463002,-33.194213087384,28.5943858779843,44.6738589008831,-4.43517899067233,-32.5828503341628,-6.91633378029485,-27.6508852661345,22.4025371546269,-8.71458074288857,-7.30397179125085,123.707249114168,41.2224318632558]},{"label":"PC5","values":[18.4170734310273,11.5051612842814,-4.7925279647287,-3.89649078116424,-17.74948358358,-55.4784862960605,-25.6623518535527,66.131193758933,-17.2683836262269,2.06157775802756,39.2617987304432,7.17557618877806,-37.1152363170002,25.904164677542,27.3689898075814,2.66728882985467,-19.2092879873178,-34.248932207647,-2.5431336301628,45.2700031805006,-14.9248405228694,25.1778830678485,27.4134296673518,0.941336211243048,-33.645215021755,26.8723538421424,10.8208606305253,26.2695573336696,34.6193764748997,-11.1100350733611,0.23732760290092,29.117030679578,-19.6351867971589,-6.30256205212752,30.6869597271236,-13.1374895980657,21.1917515813206,2.22949457603004,7.21439442635967,11.9817928678678,9.91620052371146,-41.468042986841,31.7474691255467,-20.7171822370073,-92.1352454058494,-2.19591544374197,-32.4523388787636,-26.4213628088597,35.3020374957098,-37.0237243685272,6.93916808572545,4.2586318413741,-32.6400698379847,-28.8068831107158,-30.2056279297134,11.65275429131,-10.1518608078583,23.0994956468963,14.0827173337597,-92.8826768873348,-30.0712707074461,0.136015093299594,-16.2715635261852,14.6130649697854,38.8510618238409,-10.5264290067589,-9.70725185275789,4.54728827441891,49.9827004705704,-41.2784625264701,-32.4043375255294,3.90712604515392,18.5623704273976,31.647027672196,4.2619817420399,31.9345751975395,-9.45026022355376,17.7222433513217,49.6862240022134,-7.34978061623089,23.0310822453481,0.697841254044266,-5.01983397816441,12.9539356902652,23.6750801222238,6.98683419330688,21.4342706892128,33.9380833779324,19.2529526823178,13.0194149226599,40.5288497673427,-13.4710196090663,-50.1734900086342,-1.80088597220591,2.6909405674762,36.5290591711711,20.0715058710469,16.074332669236,2.79234960492672,-24.1723829483961,10.2092698571679,31.0626232465906,44.7302297543057,24.7146757270733,2.52850492935326,23.5679124063578,19.4656074101333,-16.7149074560156,-71.8282795021967,7.92179810854001,18.4172724676139,2.42292173453235,-9.53438110291865,21.1832940100514,27.7804252608426,14.9654205198751,-7.83764483284608,-6.28086301725921,19.2909051794232,-49.7431215413048,87.9561932175601,-22.7233811704872,44.5753998177566,-25.5815819973517,-123.368533920767,-38.4742113544572,26.1102881339544,-10.0797539329718,-3.73083450609542,-17.6451016146003,2.76296417655553,-0.188976107841715,2.87166958763987,7.37764133022596,-18.1836337845352,-10.2363688348357,46.0410315548913,-33.8953932990309,48.9644981822648,-7.94741639076982,3.00043423424566,-8.98342382651689,-14.2313860128921,70.6631111760367,-21.2604341214747,20.7180150692023,-21.0055998696374,-12.0395985943602,21.637558227619,44.9092906556806,-46.7331331146091,-6.51818728789057,-36.7563210636765,-0.415665318505501,56.3373180984851,-2.33123241560257,-9.44892246409976,-23.5148744804373,-4.17165792411087,-8.72446843911549,-10.978023509373,-7.45715362379176,45.6214238766654,1.35248537234653,2.37432056834147,-132.99330248502,-121.522255034709]}],"text":["PDAC: TCGA.IB.AAUO.01A.12R.A38C.07","PDAC: TCGA.3A.A9I9.01A.11R.A38C.07","PDAC: TCGA.HZ.8519.01A.11R.2404.07","PDAC: TCGA.IB.7885.01A.11R.2156.07","PDAC: TCGA.US.A774.01A.21R.A32O.07","PDAC: TCGA.S4.A8RM.01A.11R.A37L.07","PanNET: TCGA.3A.A9IR.01A.11R.A38C.07","PanNET: TCGA.3A.A9IJ.01A.11R.A39D.07","PDAC: TCGA.2J.AABA.01A.21R.A41B.07","PDAC: TCGA.M8.A5N4.01A.11R.A26U.07","PDAC: TCGA.2L.AAQL.01A.11R.A38C.07","PDAC: TCGA.FB.AAQ6.01A.11R.A41B.07","PDAC: TCGA.IB.7645.01A.22R.2204.07","PDAC: TCGA.2J.AABU.01A.11R.A41B.07","PanNET: TCGA.3A.A9IV.01A.11R.A41B.07","PDAC: TCGA.FB.AAPQ.01A.11R.A41B.07","PDAC: TCGA.HZ.A4BK.01A.11R.A26U.07","PDAC: TCGA.IB.AAUR.01A.21R.A38C.07","PDAC: TCGA.IB.7887.01A.11R.2156.07","PDAC: TCGA.IB.7893.01A.11R.2204.07","PDAC: TCGA.2J.AABF.01A.31R.A41B.07","PanNET: TCGA.3A.A9IN.01A.11R.A39D.07","PDAC: TCGA.HV.AA8V.01A.11R.A41B.07","PDAC: TCGA.FB.AAPZ.01A.11R.A41B.07","PDAC: TCGA.IB.7888.01A.11R.2156.07","PDAC: TCGA.PZ.A5RE.01A.11R.A32O.07","PDAC: TCGA.2J.AAB9.01A.11R.A41B.07","PDAC: TCGA.IB.A6UF.01A.23R.A33R.07","PDAC: TCGA.HV.A5A3.01A.11R.A26U.07","PDAC: TCGA.S4.A8RP.01A.11R.A36G.07","PDAC: TCGA.F2.A7TX.01A.33R.A38C.07","PDAC: TCGA.HV.A7OL.01A.11R.A33R.07","PDAC: TCGA.HZ.A49H.01A.11R.A26U.07","PDAC: TCGA.XN.A8T5.01A.12R.A36G.07","PDAC: TCGA.FB.AAQ1.01A.12R.A41B.07","PDAC: TCGA.LB.A7SX.01A.11R.A33R.07","Normal: TCGA.YB.A89D.11A.11R.A36G.07","PDAC: TCGA.RB.A7B8.01A.12R.A33R.07","PDAC: TCGA.XD.AAUI.01A.42R.A41B.07","PDAC: TCGA.2J.AABH.01A.21R.A41B.07","PanNET: TCGA.3A.A9IO.01A.11R.A38C.07","PDAC: TCGA.IB.AAUP.01A.11R.A37L.07","PDAC: TCGA.3A.A9IB.01A.21R.A39D.07","PDAC: TCGA.IB.AAUT.01A.11R.A37L.07","PDAC: TCGA.Z5.AAPL.01A.12R.A41B.07","PDAC: TCGA.2J.AABK.01A.31R.A41B.07","PDAC: TCGA.IB.AAUM.01A.11R.A37L.07","PDAC: TCGA.FB.A4P6.01A.12R.A26U.07","PDAC: TCGA.3A.A9IC.01A.11R.A38C.07","PDAC: TCGA.FB.AAPU.01A.31R.A41B.07","PDAC: TCGA.2L.AAQI.01A.12R.A39D.07","PDAC: TCGA.HZ.A4BH.01A.11R.A26U.07","PDAC: TCGA.HZ.8317.01A.11R.2404.07","PDAC: TCGA.IB.7897.01A.21R.2204.07","PDAC: TCGA.HZ.A8P1.01A.11R.A37L.07","PDAC: TCGA.2L.AAQE.01A.11R.A39D.07","PDAC: TCGA.HZ.A77P.01A.11R.A33R.07","PDAC: TCGA.IB.A7LX.01A.12R.A36G.07","PDAC: TCGA.2J.AAB4.01A.12R.A41B.07","IPMN: TCGA.FB.AAPP.01A.12R.A41B.07","PDAC: TCGA.2J.AABT.01A.11R.A41B.07","PDAC: TCGA.LB.A9Q5.01A.11R.A39D.07","PDAC: TCGA.HZ.8315.01A.11R.2404.07","PDAC: TCGA.XD.AAUG.01A.61R.A41B.07","PDAC: TCGA.IB.A5SQ.01A.11R.A32O.07","PDAC: TCGA.IB.7652.01A.11R.2156.07","PDAC: TCGA.HZ.A77Q.01A.11R.A36G.07","PDAC: TCGA.HV.A5A4.01A.11R.A26U.07","PDAC: TCGA.IB.7890.01A.12R.2204.07","PDAC: TCGA.Q3.A5QY.01A.12R.A32O.07","PDAC: TCGA.IB.7644.01A.11R.2156.07","PDAC: TCGA.IB.A5SO.01A.11R.A32O.07","PDAC: TCGA.2J.AABI.01A.12R.A41B.07","PDAC: TCGA.2J.AABO.01A.21R.A41B.07","PDAC: TCGA.US.A779.01A.11R.A32O.07","PDAC: TCGA.3A.A9IH.01A.12R.A39D.07","PDAC: TCGA.HZ.7919.01A.11R.2156.07","PDAC: TCGA.HV.A5A6.01A.11R.A26U.07","PDAC: TCGA.YH.A8SY.01A.11R.A37L.07","PDAC: TCGA.F2.6879.01A.11R.2156.07","PDAC: TCGA.3A.A9IU.01A.11R.A39D.07","PDAC: TCGA.HV.AA8X.01A.11R.A39D.07","PDAC: TCGA.IB.8127.01A.11R.2404.07","PDAC: TCGA.FB.AAPS.01A.12R.A39D.07","PDAC: TCGA.FB.AAQ3.01A.11R.A41B.07","PDAC: TCGA.US.A77E.01A.11R.A32O.07","PDAC: TCGA.F2.A44H.01A.11R.A26U.07","PDAC: TCGA.3A.A9I5.01A.11R.A38C.07","PDAC: TCGA.RB.AA9M.01A.11R.A39D.07","IPMN: TCGA.HV.A7OP.01A.11R.A33R.07","PDAC: TCGA.FB.A545.01A.11R.A26U.07","PDAC: TCGA.Q3.AA2A.01A.11R.A37L.07","PDAC: TCGA.IB.8126.01A.11R.2404.07","PDAC: TCGA.IB.A5SP.01A.11R.A32O.07","Metastatic: TCGA.HZ.A9TJ.06A.11R.A41B.07","PDAC: TCGA.HZ.8001.01A.11R.2204.07","PDAC: TCGA.2J.AABE.01A.12R.A41B.07","PanNET: TCGA.3A.A9IL.01A.11R.A38C.07","PDAC: TCGA.IB.AAUN.01A.12R.A38C.07","PDAC: TCGA.2L.AAQJ.01A.12R.A39D.07","PDAC: TCGA.2J.AABV.01A.12R.A41B.07","PDAC: TCGA.XN.A8T3.01A.11R.A36G.07","PDAC: TCGA.OE.A75W.01A.12R.A32O.07","PDAC: TCGA.LB.A8F3.01A.11R.A36G.07","PDAC: TCGA.HZ.8636.01A.21R.2404.07","PDAC: TCGA.XD.AAUL.01A.21R.A39D.07","PanNET: TCGA.2L.AAQM.01A.11R.A39D.07","PDAC: TCGA.3A.A9I7.01A.21R.A38C.07","PDAC: TCGA.US.A776.01A.13R.A33R.07","PDAC: TCGA.IB.A7M4.01A.11R.A36G.07","PDAC: TCGA.3A.A9IZ.01A.12R.A41B.07","PDAC: TCGA.2L.AAQA.01A.21R.A38C.07","PDAC: TCGA.IB.7889.01A.11R.2156.07","PDAC: TCGA.F2.A8YN.01A.11R.A37L.07","PDAC: TCGA.YB.A89D.01A.12R.A36G.07","PanNET: TCGA.3A.A9IS.01A.21R.A39D.07","PDAC: TCGA.IB.A6UG.01A.32R.A33R.07","PDAC: TCGA.FB.AAPY.01A.11R.A41B.07","PDAC: TCGA.S4.A8RO.01A.12R.A37L.07","PDAC: TCGA.HZ.8637.01A.11R.2404.07","PDAC: TCGA.2J.AAB6.01A.11R.A41B.07","PDAC: TCGA.IB.7886.01A.11R.2156.07","PDAC: TCGA.H6.8124.01A.11R.2404.07","PDAC: TCGA.IB.7891.01A.11R.2204.07","Normal: TCGA.H6.A45N.11A.12R.A26U.07","PDAC: TCGA.HZ.7926.01A.11R.2156.07","PDAC: TCGA.IB.7646.01A.11R.2156.07","PDAC: TCGA.2J.AABR.01A.11R.A41B.07","PDAC: TCGA.3A.A9J0.01A.11R.A41B.07","PDAC: TCGA.IB.7651.01A.11R.2156.07","PDAC: TCGA.IB.AAUU.01A.11R.A37L.07","PDAC: TCGA.HZ.A8P0.01A.11R.A36G.07","PDAC: TCGA.IB.AAUS.01A.12R.A38C.07","PDAC: TCGA.F2.A44G.01A.11R.A26U.07","PDAC: TCGA.3A.A9IX.01A.11R.A41B.07","PDAC: TCGA.3E.AAAZ.01A.11R.A38C.07","PDAC: TCGA.IB.AAUQ.01A.22R.A41I.07","PDAC: TCGA.US.A77G.01A.11R.A32O.07","PDAC: TCGA.HZ.8005.01A.11R.2204.07","PDAC: TCGA.2J.AAB8.01A.12R.A41B.07","Normal: TCGA.HV.A5A3.11A.11R.A26U.07","PDAC: TCGA.YY.A8LH.01A.11R.A36G.07","PDAC: TCGA.HZ.A49G.01A.11R.A26U.07","PDAC: TCGA.FB.A5VM.01A.11R.A32O.07","PDAC: TCGA.IB.7649.01A.11R.2156.07","PDAC: TCGA.HZ.7925.01A.11R.2156.07","PDAC: TCGA.FB.A78T.01A.12R.A32O.07","PDAC: TCGA.HZ.7922.01A.11R.2156.07","PDAC: TCGA.HZ.A77O.01A.11R.A33R.07","PDAC: TCGA.FB.AAQ2.01A.31R.A41B.07","PDAC: TCGA.IB.A5ST.01A.11R.A32O.07","PDAC: TCGA.XD.AAUH.01A.42R.A41B.07","PDAC: TCGA.HZ.8003.01A.21R.2204.07","PDAC: TCGA.HV.A5A5.01A.11R.A26U.07","PDAC: TCGA.IB.A5SS.01A.11R.A32O.07","PDAC: TCGA.HZ.A49I.01A.12R.A26U.07","Normal: TCGA.H6.8124.11A.01R.2404.07","PDAC: TCGA.HZ.8002.01A.11R.2204.07","PDAC: TCGA.HZ.A9TJ.01A.11R.A41I.07","PDAC: TCGA.FB.A4P5.01A.11R.A26U.07","PDAC: TCGA.2J.AAB1.01A.11R.A41B.07","PDAC: TCGA.3E.AAAY.01A.11R.A38C.07","PDAC: TCGA.L1.A7W4.01A.12R.A36G.07","PDAC: TCGA.H6.A45N.01A.11R.A26U.07","PDAC: TCGA.FB.AAQ0.01A.31R.A41B.07","Organoid: CCR170093_RNA_WPT_013","PDAC: CCR170012_MH17T001P013"],"marker":{"color":["deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkred","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","green","deepskyblue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","red","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","red","deepskyblue","deepskyblue","deepskyblue","deepskyblue","blue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkred","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","green","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","green","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","green","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","deepskyblue","darkgoldenrod","deepskyblue"],"size":7,"opacity":0.7,"line":{"color":"rgba(31,119,180,1)"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save pairwise PCA plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_PCA_pairwise_targets.html"), selfcontained = TRUE)

##### Plot all combinations between the first 5 PCs
#pairs(y.norm.cpm.subset_pca$x[,1:5], pch=16, col=targets.colour[[2]])

##### Save the plot as pdf file
#pdf(paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_PCA_pairwise_targets.pdf"), width=10, height=10)
#pairs(y.norm.cpm.subset_pca$x[,1:5], pch=16, col=targets.colour[[2]])
#invisible(dev.off())
```



The global variability of the data can also be assessed from the scree plot. Here, you can identify the fraction of total variance (y-axis) attributed to each PC (x-axis). The PCs are ordered by decreasing order of contribution to total variance. 


```r
##### Generate scree plot
p <- plot_ly(y.norm.cpm.subset_scree.df, x = ~PC, y = ~Variances, type = 'bar', width = 600, height = 400) %>%
  layout(title = "The variances captured by principal components", xaxis = list(title = ""), margin = list(l=50, r=50, b=100, t=100, pad=4), autosize = F)

p
```

<!--html_preserve--><div id="htmlwidget-e2b22dfc45c1be353275" style="width:600px;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e2b22dfc45c1be353275">{"x":{"visdat":{"1c252e08ce73":["function () ","plotlyVisDat"]},"cur_data":"1c252e08ce73","attrs":{"1c252e08ce73":{"x":{},"y":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"width":600,"height":400,"margin":{"b":100,"l":50,"t":100,"r":50,"pad":4},"title":"The variances captured by principal components","xaxis":{"domain":[0,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["PC 1","PC 2","PC 3","PC 4","PC 5","PC 6","PC 7","PC 8","PC 9","PC 10","PC 11","PC 12","PC 13","PC 14","PC 15","PC 16","PC 17","PC 18","PC 19","PC 20","PC 21","PC 22","PC 23","PC 24","PC 25","PC 26","PC 27","PC 28","PC 29","PC 30","PC 31","PC 32","PC 33","PC 34","PC 35","PC 36","PC 37","PC 38","PC 39","PC 40","PC 41","PC 42","PC 43","PC 44","PC 45","PC 46","PC 47","PC 48","PC 49","PC 50","PC 51","PC 52","PC 53","PC 54","PC 55","PC 56","PC 57","PC 58","PC 59","PC 60","PC 61","PC 62","PC 63","PC 64","PC 65","PC 66","PC 67","PC 68","PC 69","PC 70","PC 71","PC 72","PC 73","PC 74","PC 75","PC 76","PC 77","PC 78","PC 79","PC 80","PC 81","PC 82","PC 83","PC 84","PC 85","PC 86","PC 87","PC 88","PC 89","PC 90","PC 91","PC 92","PC 93","PC 94","PC 95","PC 96","PC 97","PC 98","PC 99","PC 100","PC 101","PC 102","PC 103","PC 104","PC 105","PC 106","PC 107","PC 108","PC 109","PC 110","PC 111","PC 112","PC 113","PC 114","PC 115","PC 116","PC 117","PC 118","PC 119","PC 120","PC 121","PC 122","PC 123","PC 124","PC 125","PC 126","PC 127","PC 128","PC 129","PC 130","PC 131","PC 132","PC 133","PC 134","PC 135","PC 136","PC 137","PC 138","PC 139","PC 140","PC 141","PC 142","PC 143","PC 144","PC 145","PC 146","PC 147","PC 148","PC 149","PC 150","PC 151","PC 152","PC 153","PC 154","PC 155","PC 156","PC 157","PC 158","PC 159","PC 160","PC 161","PC 162","PC 163","PC 164","PC 165","PC 166","PC 167"]},"autosize":false,"yaxis":{"domain":[0,1],"automargin":true,"title":"Variances"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":["PC 1","PC 2","PC 3","PC 4","PC 5","PC 6","PC 7","PC 8","PC 9","PC 10","PC 11","PC 12","PC 13","PC 14","PC 15","PC 16","PC 17","PC 18","PC 19","PC 20","PC 21","PC 22","PC 23","PC 24","PC 25","PC 26","PC 27","PC 28","PC 29","PC 30","PC 31","PC 32","PC 33","PC 34","PC 35","PC 36","PC 37","PC 38","PC 39","PC 40","PC 41","PC 42","PC 43","PC 44","PC 45","PC 46","PC 47","PC 48","PC 49","PC 50","PC 51","PC 52","PC 53","PC 54","PC 55","PC 56","PC 57","PC 58","PC 59","PC 60","PC 61","PC 62","PC 63","PC 64","PC 65","PC 66","PC 67","PC 68","PC 69","PC 70","PC 71","PC 72","PC 73","PC 74","PC 75","PC 76","PC 77","PC 78","PC 79","PC 80","PC 81","PC 82","PC 83","PC 84","PC 85","PC 86","PC 87","PC 88","PC 89","PC 90","PC 91","PC 92","PC 93","PC 94","PC 95","PC 96","PC 97","PC 98","PC 99","PC 100","PC 101","PC 102","PC 103","PC 104","PC 105","PC 106","PC 107","PC 108","PC 109","PC 110","PC 111","PC 112","PC 113","PC 114","PC 115","PC 116","PC 117","PC 118","PC 119","PC 120","PC 121","PC 122","PC 123","PC 124","PC 125","PC 126","PC 127","PC 128","PC 129","PC 130","PC 131","PC 132","PC 133","PC 134","PC 135","PC 136","PC 137","PC 138","PC 139","PC 140","PC 141","PC 142","PC 143","PC 144","PC 145","PC 146","PC 147","PC 148","PC 149","PC 150","PC 151","PC 152","PC 153","PC 154","PC 155","PC 156","PC 157","PC 158","PC 159","PC 160","PC 161","PC 162","PC 163","PC 164","PC 165","PC 166","PC 167"],"y":[61.2816680394548,56.7092992831563,43.9953824409781,33.8927926494172,32.9209964316122,30.1246454087163,26.3768077674494,24.7063865909092,21.4932221268643,20.1005220269225,19.517951564629,18.5199755402274,17.7364090963343,17.5701506371052,16.4663250849815,15.9812283129245,15.7060398341311,15.2738406275444,14.9468474876645,14.3873262500604,14.2769256825544,14.0497043045493,13.7867496128954,13.6087507823631,13.2468993764275,12.6874169295549,12.411801387413,12.10341602808,11.9232670094065,11.7308327513205,11.6171544492056,11.3531830234903,11.2445378898984,11.0549782243022,10.9504451740682,10.6964323491217,10.6610818006426,10.541443301489,10.5098964916766,10.2266477788314,10.1189268447398,10.0221156822438,9.91536244929708,9.78325546109227,9.70874949570648,9.58770513104842,9.45557733442683,9.40724431063706,9.33283003375397,9.18187606125267,9.08373224141748,9.01473113833227,8.93783771855063,8.85421490771337,8.76857579780888,8.65979983854746,8.632694641883,8.51451796922002,8.50044180262617,8.41008428678342,8.35715833628163,8.17517770220906,8.11935870864234,8.09523648537855,8.04812009660331,7.96572832241281,7.89507435022154,7.82342083768159,7.7797177084484,7.70012697635664,7.66852176874713,7.55977950955928,7.54509138073506,7.4839006579861,7.46259726725042,7.38258910014943,7.32474312339802,7.3146971604951,7.24283786864915,7.21647516761596,7.14090544315851,7.10110450997083,7.08042827904734,7.03984047971476,6.99765039389496,6.95524772913785,6.92875535843345,6.84306443728638,6.80101852592058,6.76651758286343,6.72461667511063,6.66438750185698,6.60335704957791,6.58452986591119,6.53235497498698,6.45014713834418,6.4322929642741,6.41950908407676,6.37246210079757,6.31889083063925,6.2880293362306,6.23099366497453,6.21767894405525,6.16418814884787,6.13192205752089,6.10043867278597,6.07138329136665,6.02056521472388,5.98591129113375,5.97375602867603,5.94433294531571,5.85600948105293,5.84509961632739,5.81862059180668,5.80405333427694,5.74438205604818,5.71444999710185,5.69390297471362,5.65763266035144,5.59753621051471,5.58679669227347,5.55852034889234,5.52167581911321,5.49370381887118,5.47134459922944,5.43326870256281,5.36895157671941,5.34124777008158,5.28669870130327,5.25198587775069,5.21142045312874,5.18596103751472,5.17965568074935,5.13976002230075,5.08475481109271,5.05637037326034,5.02514016067895,5.00056770325685,4.97389313744474,4.95333530706183,4.87009954563955,4.84895575518473,4.81243356583681,4.78057772350369,4.73253334907365,4.71573596398501,4.70145398190553,4.6651135554821,4.62836000503815,4.54511286655963,4.53606388174122,4.49588991145879,4.46540128004381,4.43088476688364,4.40139465131246,4.3656073697338,4.33656138519701,4.30684013233557,4.19512169700645,4.14445990393004,4.1324077020797,4.07865509281236,4.03918332143783,3.9417701383069,3.81651545067546,3.60355166808696,4.78155714536153e-14],"type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script><!--/html_preserve-->

```r
##### Save scree plot as html
htmlwidgets::saveWidget(as_widget(p), paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_scree_plot.html"), selfcontained = TRUE)

##### Detach plotly package. Otherwise it clashes with other graphics devices
detach("package:plotly", unload=FALSE)
```

## Adjust data for batch effects

Neet to benchmark batch effects correction/modelling methods, including *[removeBatchEffect](http://web.mit.edu/~r/current/arch/i386_linux26/lib/R/library/limma/html/removeBatchEffect.html)*, *[RUVSeq](https://bioconductor.org/packages/release/bioc/html/RUVSeq.html)*, *[MBatch/EB++](http://bioinformatics.mdanderson.org/main/TCGABatchEffectsV2:MBatch)*, *[DESeq2](https://support.bioconductor.org/p/76099/)*, *[sva](https://bioconductor.org/packages/release/bioc/html/sva.html)* after realising that *[Combat](https://bioconductor.org/packages/release/bioc/html/sva.html)* sucks (check [this](https://academic.oup.com/biostatistics/article/17/1/29/1744261) and [that](https://www.biostars.org/p/266507/))

## Save combined data into a file


```r
cat("Writing TMM-normalised expression data to", paste0(paste(datasetIDs, collapse="_"),"_TMM.exp"), "\n\n")
```

```
Writing TMM-normalised expression data to TCGA-PAAD_Avner_TMM.exp 
```

```r
write.table(geneMatrix2write(y.norm.cpm), file=paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),"_TMM.txt"),sep="\t", quote=FALSE, row.names=FALSE, append = FALSE)
```

## Parameters


```r
for ( i in 1:length(params) ) {

  cat(paste("Parameter: ", names(params)[i], "\nValue: ", paste(unlist(params[i]), collapse = ","), "\n\n", sep=""))
}
```

```
Parameter: projectDir
Value: ./Combined_data

Parameter: datasetsFile
Value: Datasets_list.txt
```

```r
##### Write used parameters into a file
write.table(params, file = paste0(normalizePath(params$projectDir), "/", paste(datasetIDs, collapse="_"),".combineExprData.parameters.txt"), sep="\t", quote=FALSE, row.names=FALSE, append = FALSE)
```

## Session info


```r
sessionInfo()
```

```
R version 3.5.0 (2018-04-23)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS High Sierra 10.13.6

Matrix products: default
BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib

locale:
[1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8

attached base packages:
[1] stats4    parallel  stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] bindrcpp_0.2.2              RSkittleBrewer_1.1         
 [3] corrplot_0.84               ggplot2_3.0.0              
 [5] FactoMineR_1.41             sneer_0.0.0.9028           
 [7] RUVSeq_1.14.0               edgeR_3.22.3               
 [9] limma_3.36.2                EDASeq_2.14.1              
[11] ShortRead_1.38.0            GenomicAlignments_1.16.0   
[13] SummarizedExperiment_1.10.1 DelayedArray_0.6.4         
[15] matrixStats_0.54.0          Rsamtools_1.32.2           
[17] GenomicRanges_1.32.6        GenomeInfoDb_1.16.0        
[19] Biostrings_2.48.0           XVector_0.20.0             
[21] IRanges_2.14.10             S4Vectors_0.18.3           
[23] Biobase_2.40.0              BiocGenerics_0.26.0        
[25] sva_3.28.0                  BiocParallel_1.14.2        
[27] genefilter_1.62.0           mgcv_1.8-24                
[29] nlme_3.1-137                rapportools_1.0            
[31] reshape_0.8.7               preprocessCore_1.42.0      
[33] optparse_1.6.0             

loaded via a namespace (and not attached):
 [1] colorspace_1.3-2       hwriter_1.3.2          rprojroot_1.3-2       
 [4] getopt_1.20.2          bit64_0.9-7            AnnotationDbi_1.42.1  
 [7] splines_3.5.0          R.methodsS3_1.7.1      leaps_3.0             
[10] DESeq_1.32.0           geneplotter_1.58.0     knitr_1.20            
[13] jsonlite_1.5           annotate_1.58.0        cluster_2.0.7-1       
[16] R.oo_1.22.0            shiny_1.1.0            compiler_3.5.0        
[19] httr_1.3.1             backports_1.1.2        assertthat_0.2.0      
[22] Matrix_1.2-14          lazyeval_0.2.1         later_0.7.3           
[25] htmltools_0.3.6        prettyunits_1.0.2      tools_3.5.0           
[28] gtable_0.2.0           glue_1.3.0             GenomeInfoDbData_1.1.0
[31] dplyr_0.7.6            Rcpp_0.12.18           rtracklayer_1.40.4    
[34] crosstalk_1.0.0        stringr_1.3.1          mime_0.5              
[37] XML_3.98-1.15          zlibbioc_1.26.0        MASS_7.3-50           
[40] scales_1.0.0           aroma.light_3.10.0     promises_1.0.1        
[43] hms_0.4.2              RColorBrewer_1.1-2     yaml_2.2.0            
[46] memoise_1.1.0          pander_0.6.2           biomaRt_2.36.1        
[49] latticeExtra_0.6-28    stringi_1.2.4          RSQLite_2.1.1         
[52] GenomicFeatures_1.32.1 rlang_0.2.1            pkgconfig_2.0.1       
[55] bitops_1.0-6           evaluate_0.11          lattice_0.20-35       
[58] purrr_0.2.5            bindr_0.1.1            htmlwidgets_1.2       
[61] bit_1.1-14             tidyselect_0.2.4       plyr_1.8.4            
[64] magrittr_1.5           R6_2.2.2               DBI_1.0.0             
[67] pillar_1.3.0           withr_2.1.2            survival_2.42-6       
[70] scatterplot3d_0.3-41   RCurl_1.95-4.11        tibble_1.4.2          
[73] crayon_1.3.4           plotly_4.8.0           rmarkdown_1.10        
[76] progress_1.2.0         locfit_1.5-9.1         grid_3.5.0            
[79] data.table_1.11.4      blob_1.1.1             digest_0.6.15         
[82] flashClust_1.01-2      xtable_1.8-2           httpuv_1.4.5          
[85] tidyr_0.8.1            R.utils_2.6.0          munsell_0.5.0         
[88] viridisLite_0.3.0     
```

